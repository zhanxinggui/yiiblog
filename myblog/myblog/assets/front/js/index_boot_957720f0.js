(function(d,c){function e(j,h){if(j instanceof Array){for(var g=0,f=j.length;g<f;g++){if(h.call(j[g],j[g],g)===false){return}}}else{for(var g in j){if(j.hasOwnProperty(g)){if(h.call(j[g],j[g],g)===false){return}}}}}function b(g,f){this.name=f;this.path=g;this.fn=null;this.exports={};this._loaded=false;this._requiredStack=[];this._readyStack=[];b.cache[this.name]=this}b.loadedPaths={};b.loadingPaths={};b.cache={};b.paths={};b.moduleFileMap={};b.requiredPaths={};b.lazyLoadPaths={};b.isPathsLoaded=function(g){var f=true;e(g,function(h){if(!(h in b.loadedPaths)){return f=false}});return f};b.require=function(f){var g=b.get(f);g.init();return g.exports};if(c&&c.charAt(c.length-1)=="/"){c=c.substr(0,c.length-1)}b.getJsPath=function(f){return c||""+f};b.get=function(f){var h=f.indexOf(":")>-1?f:b.getJsPath(f);if(f.indexOf("?")>-1){var g=f.split("?");f=g[0];h=f.replace(/\.js$/,"_"+g[1]+".js")}if(b.cache[f]){return b.cache[f]}return new b(h,f)};b.prototype={init:function(){if(!this._inited){this._inited=true;if(!this.fn){return}var f;if(f=this.fn.call(null,b.require,this.exports)){this.exports=f}}},load:function(){b.loadingPaths[this.path]=true;var f=b.moduleFileMap[this.name]||this.path;a.create({src:f})},lazyLoad:function(){var f=this.name,g=this.path;if(b.lazyLoadPaths[f]){this.define();delete b.lazyLoadPaths[f]}else{if(g in b.loadedPaths){this.triggerStack()}else{if(g in b.loadingPaths){return}else{b.requiredPaths[this.name]=true;this.load()}}}},ready:function(g,h){var f=h?this._requiredStack:this._readyStack;if(g){if(this._loaded){g()}else{f.push(g)}}else{this._loaded=true;b.loadedPaths[this.path]=true;delete b.loadingPaths[this.path];this.triggerStack()}},triggerStack:function(){if(this._readyStack.length>0){this.init();e(this._readyStack,function(f){f()});this._readyStack=[]}if(this._requiredStack.length>0){e(this._requiredStack,function(f){f()});this._requiredStack=[]}},define:function(){var h=this,f=this.deps,g=[];if(!f){f=this.getDependents()}if(f.length){e(f,function(k){var j=b.get(k);g.push(j.path)});e(f,function(k){var j=b.get(k);j.ready(function(){if(b.isPathsLoaded(g)){h.ready()}},true);j.lazyLoad()})}else{this.ready()}},getDependents:function(){var h=this;var g=this.fn.toString();var f=g.match(/require\(\s*('|")([a-zA-Z0-9_\/.]+)('|")\s*\)/g);if(f){e(f,function(k,j){f[j]=k.replace(/\s+/g,"").substr(9).slice(0,-2)});return f}return[]}};var a={create:function(h){var j=h.src;if(j in this._paths){return}this._paths[j]=true;e(this._rules,function(k){j=k.call(null,j)});var g=document.getElementsByTagName("head")[0];var f=document.createElement("script");f.type=h.type||"text/javascript";f.src=j;f.onload=f.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){h.loaded&&h.loaded();f.onload=f.onreadystatechange=null}};g.insertBefore(f,g.firstChild)},_paths:{},_rules:[],addPathRule:function(f){this._rules.push(f)}};d.version="1.0";d.use=function(j,h){if(typeof j==="string"){j=[j]}var g=[];var f=[];e(j,function(k,l){f[l]=false});e(j,function(k,m){var l=b.get(k);l.ready(function(){g[m]=l.exports;f[m]=true;var n=true;e(f,function(o){if(o===false){return n=false}});if(h&&n){h.apply(null,g)}});l.lazyLoad()})};d.module=function(f,h,j){var g=b.get(f);g.fn=h;g.deps=j;if(b.requiredPaths[f]){g.define()}else{b.lazyLoadPaths[f]=true}};d.pathRule=function(f){a.addPathRule(f)};d._fileMap=function(g,f){if(typeof g==="object"){e(g,function(h,j){d._fileMap(j,h)})}else{if(typeof f==="string"){f=[f]}e(f,function(h){b.moduleFileMap[h]=g})}}})((function(){return window.F={}})());F.module("util/binding",function(d,e){var f={},c=1000000;function a(n,h){var l,g,k,j,m,o;if(h.nodeType===1){if(h.attributes.getNamedItem("data-bind")){o=h.getAttribute("data-bind");o=o.split(":");j=baidu.string.trim(o[0]);m=baidu.string.trim(o[1]);b.call(n,j,m,h)}for(l=0,k=h.childNodes,g=k.length;l<g;l++){a(n,k[l])}}}function b(g,h,j){this.bindingId=c++;if(!f[this.bindingId]){f[this.bindingId]={}}if(h in j&&!(typeof j[h]==="function")){f[this.bindingId][g]=j[h];this[g]=function(k){if(!k){return f[this.bindingId][g]||null}else{f[this.bindingId][g]=(j[h]=k);if(this.dispatchEvent&&typeof this.dispatchEvent=="function"){this.dispatchEvent("update"+g)}return this}}}}return{setBinding:a}});F.module("util/pagebar",function(b,c){var a=function(m,d,k,g){var o=m||0;var j=[],e='<a href="#" data-pn="#{0}">#{1}</a>';var f=g,l=Math.ceil(d/k);if(o>1){j.push(P.format(e,[1,"首页"]));j.push(P.format(e,[o-1,"上一页"]));if(o>f+1){j.push("<a>...</a>")}for(var h=f;h>0;h--){if(o-h>0){j.push(P.format(e,[o-h,o-h]))}}}j.push("<b>"+o+"</b>");if(o<l){for(var h=0;h<f&&(h+o+1<=l);h++){j.push(P.format(e,[o+h+1,o+h+1]))}}if(o+f<l){j.push("<span>...</span>")}if(o<l){j.push(P.format(e,[o+1,"下一页"]))}if(o<l){j.push(P.format(e,[l,"尾页"]))}return j.join("")};return a});var T,baidu=T=baidu||{version:"1.3.9"};baidu.guid="$BAIDU$";window[baidu.guid]=window[baidu.guid]||{};baidu.json=baidu.json||{};baidu.json.parse=function(b){return(new Function("return ("+b+")"))()};baidu.object=baidu.object||{};baidu.extend=baidu.object.extend=function(f,e){for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f};baidu.object.each=function(h,k){var f,g,j;if("function"==typeof k){for(g in h){if(h.hasOwnProperty(g)){j=h[g];f=k.call(h,j,g);if(f===false){break}}}}return h};baidu.fn=baidu.fn||{};baidu.sio=baidu.sio||{};baidu.sio._createScriptTag=function(d,e,f){d.setAttribute("type","text/javascript");f&&d.setAttribute("charset",f);d.setAttribute("src",e);document.getElementsByTagName("head")[0].appendChild(d)};baidu.sio._removeScriptTag=function(c){if(c.clearAttributes){c.clearAttributes()}else{for(var d in c){if(c.hasOwnProperty(d)){delete c[d]}}}if(c&&c.parentNode){c.parentNode.removeChild(c)}c=null};baidu.sio.callByBrowser=function(t,n,l){var q=document.createElement("SCRIPT"),p=0,k=l||{},r=k.charset,m=n||function(){},o=k.timeOut||0,s;q.onload=q.onreadystatechange=function(){if(p){return}var a=q.readyState;if("undefined"==typeof a||a=="loaded"||a=="complete"){p=1;try{m();clearTimeout(s)}finally{q.onload=q.onreadystatechange=null;baidu.sio._removeScriptTag(q)}}};if(o){s=setTimeout(function(){q.onload=q.onreadystatechange=null;baidu.sio._removeScriptTag(q);k.onfailure&&k.onfailure()},o)}baidu.sio._createScriptTag(q,t,r)};baidu.lang=baidu.lang||{};baidu.lang.isFunction=function(b){return"[object Function]"==Object.prototype.toString.call(b)};baidu.lang.isString=function(b){return"[object String]"==Object.prototype.toString.call(b)};baidu.isString=baidu.lang.isString;baidu.sio.callByServer=function(D,r,q){var v=document.createElement("SCRIPT"),w="bd__cbs__",t,z,p=q||{},A=p.charset,y=p.queryField||"callback",s=p.timeOut||0,C,B=new RegExp("(\\?|&)"+y+"=([^&]*)"),x;if(baidu.lang.isFunction(r)){t=w+Math.floor(Math.random()*2147483648).toString(36);window[t]=u(0)}else{if(baidu.lang.isString(r)){t=r}else{if(x=B.exec(D)){t=x[2]}}}if(s){C=setTimeout(u(1),s)}D=D.replace(B,"\x241"+y+"="+t);if(D.search(B)<0){D+=(D.indexOf("?")<0?"?":"&")+y+"="+t}baidu.sio._createScriptTag(v,D,A);function u(a){return function(){try{if(a){p.onfailure&&p.onfailure()}else{r.apply(window,arguments);clearTimeout(C)}window[t]=null;delete window[t]}catch(b){}finally{baidu.sio._removeScriptTag(v)}}}};baidu.string=baidu.string||{};baidu.string.escapeReg=function(b){return String(b).replace(new RegExp("([.*+?^=!:\x24{}()|[\\]/\\\\])","g"),"\\\x241")};baidu.string.format=function(h,f){h=String(h);var e=Array.prototype.slice.call(arguments,1),g=Object.prototype.toString;if(e.length){e=e.length==1?(f!==null&&(/\[object Array\]|\[object Object\]/.test(g.call(f)))?f:e):e;return h.replace(/#\{(.+?)\}/g,function(c,a){var b=e[a];if("[object Function]"==g.call(b)){b=b(a)}return("undefined"==typeof b?"":b)})}return h};baidu.format=baidu.string.format;baidu.string.toCamelCase=function(b){if(b.indexOf("-")<0&&b.indexOf("_")<0){return b}return b.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})};(function(){var b=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g");baidu.string.trim=function(a){return String(a).replace(b,"")}})();baidu.trim=baidu.string.trim;baidu.cookie=baidu.cookie||{};baidu.url=baidu.url||{};(function(){var b=window[baidu.guid];baidu.lang.guid=function(){return"TANGRAM__"+(b._counter++).toString(36)};b._counter=b._counter||1})();window[baidu.guid]._instances=window[baidu.guid]._instances||{};baidu.lang.Class=function(b){this.guid=b||baidu.lang.guid();window[baidu.guid]._instances[this.guid]=this};window[baidu.guid]._instances=window[baidu.guid]._instances||{};baidu.lang.Class.prototype.dispose=function(){delete window[baidu.guid]._instances[this.guid];for(var b in this){if(!baidu.lang.isFunction(this[b])){delete this[b]}}this.disposed=true};baidu.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};baidu.lang.Event=function(d,c){this.type=d;this.returnValue=true;this.target=c||null;this.currentTarget=null};baidu.lang.Class.prototype.addEventListener=function(j,k,f){if(!baidu.lang.isFunction(k)){return}!this.__listeners&&(this.__listeners={});var g=this.__listeners,h;if(typeof f=="string"&&f){if(/[^\w\-]/.test(f)){throw ("nonstandard key:"+f)}else{k.hashCode=f;h=f}}j.indexOf("on")!=0&&(j="on"+j);typeof g[j]!="object"&&(g[j]={});h=h||baidu.lang.guid();k.hashCode=h;g[j][h]=k};baidu.lang.Class.prototype.removeEventListener=function(g,h){if(typeof h!="undefined"){if((baidu.lang.isFunction(h)&&!(h=h.hashCode))||(!baidu.lang.isString(h))){return}}!this.__listeners&&(this.__listeners={});g.indexOf("on")!=0&&(g="on"+g);var e=this.__listeners;if(!e[g]){return}if(typeof h!="undefined"){e[g][h]&&delete e[g][h]}else{for(var f in e[g]){delete e[g][f]}}};baidu.lang.Class.prototype.dispatchEvent=function(j,g){if(baidu.lang.isString(j)){j=new baidu.lang.Event(j)}!this.__listeners&&(this.__listeners={});g=g||{};for(var k in g){j[k]=g[k]}var k,f=this.__listeners,h=j.type;j.target=j.target||this;j.currentTarget=this;h.indexOf("on")!=0&&(h="on"+h);baidu.lang.isFunction(this[h])&&this[h].apply(this,arguments);if(typeof f[h]=="object"){for(k in f[h]){f[h][k].apply(this,arguments)}}return j.returnValue};baidu.lang.createClass=function(n,j){j=j||{};var o=j.superClass||baidu.lang.Class;var p=function(){if(o!=baidu.lang.Class){o.apply(this,arguments)}else{o.call(this)}n.apply(this,arguments)};p.options=j.options||{};var l=function(){},m=n.prototype;l.prototype=o.prototype;var k=p.prototype=new l();for(var q in m){k[q]=m[q]}typeof j.className=="string"&&(k._className=j.className);k.constructor=m.constructor;p.extend=function(a){for(var b in a){p.prototype[b]=a[b]}return p};return p};baidu.lang.isObject=function(b){return"function"==typeof b||!!(b&&"object"==typeof b)};baidu.isObject=baidu.lang.isObject;baidu.lang.isArray=function(b){return"[object Array]"==Object.prototype.toString.call(b)};baidu.lang.module=function(name,module,owner){var packages=name.split("."),len=packages.length-1,packageName,i=0;if(!owner){try{if(!(new RegExp("^[a-zA-Z_\x24][a-zA-Z0-9_\x24]*\x24")).test(packages[0])){throw""}owner=eval(packages[0]);i=1}catch(e){owner=window}}for(;i<len;i++){packageName=packages[i];if(!owner[packageName]){owner[packageName]={}}owner=owner[packageName]}if(!owner[packages[len]]){owner[packages[len]]=module}};baidu.url.getQueryValue=function(e,h){var g=new RegExp("(^|&|\\?|#)"+baidu.string.escapeReg(h)+"=([^&#]*)(&|\x24|#)","");var f=e.match(g);if(f){return f[2]}return null};baidu.url.escapeSymbol=function(b){return String(b).replace(/\%/g,"%25").replace(/&/g,"%26").replace(/\+/g,"%2B").replace(/\ /g,"%20").replace(/\//g,"%2F").replace(/\#/g,"%23").replace(/\=/g,"%3D")};baidu.url.jsonToQuery=function(k,h){var g=[],j,f=h||function(a){return baidu.url.escapeSymbol(a)};baidu.object.each(k,function(a,b){if(baidu.lang.isArray(a)){j=a.length;while(j--){g.push(b+"="+f(a[j],b))}}else{g.push(b+"="+f(a,b))}});return g.join("&")};baidu.browser=baidu.browser||{};baidu.ajax=baidu.ajax||{};baidu.page=baidu.page||{};baidu.dom=baidu.dom||{};baidu.dom.g=function(b){if("string"==typeof b||b instanceof String){return document.getElementById(b)}else{if(b&&b.nodeName&&(b.nodeType==1||b.nodeType==9)){return b}}return null};baidu.g=baidu.G=baidu.dom.g;baidu.dom.removeClass=function(n,m){n=baidu.dom.g(n);var p=n.className.split(/\s+/),l=m.split(/\s+/),j,k=l.length,q,o=0;for(;o<k;++o){for(q=0,j=p.length;q<j;++q){if(p[q]==l[o]){p.splice(q,1);break}}}n.className=p.join(" ");return n};baidu.removeClass=baidu.dom.removeClass;baidu.dom._styleFilter=baidu.dom._styleFilter||[];baidu.dom._g=function(b){if(baidu.lang.isString(b)){return document.getElementById(b)}return b};baidu._g=baidu.dom._g;baidu.dom.contains=function(e,d){var f=baidu.dom._g;e=f(e);d=f(d);return e.contains?e!=d&&e.contains(d):!!(e.compareDocumentPosition(d)&16)};baidu.dom.hasAttr=function(f,d){f=baidu.g(f);var e=f.attributes.getNamedItem(d);return !!(e&&e.specified)};baidu.dom.addClass=function(l,k){l=baidu.dom.g(l);var h=k.split(/\s+/),j=l.className,m=" "+j+" ",n=0,o=h.length;for(;n<o;n++){if(m.indexOf(" "+h[n]+" ")<0){j+=(j?" ":"")+h[n]}}l.className=j;return l};baidu.addClass=baidu.dom.addClass;baidu.dom.getAncestorByClass=function(d,c){d=baidu.dom.g(d);c=new RegExp("(^|\\s)"+baidu.string.trim(c)+"(\\s|\x24)");while((d=d.parentNode)&&d.nodeType==1){if(c.test(d.className)){return d}}return null};baidu.dom._matchNode=function(f,h,g){f=baidu.dom.g(f);for(var e=f[g];e;e=e[h]){if(e.nodeType==1){return e}}return null};baidu.dom.hasClass=function(h,g){h=baidu.dom.g(h);var e=baidu.string.trim(g).split(/\s+/),f=e.length;g=h.className.split(/\s+/).join(" ");while(f--){if(!(new RegExp("(^| )"+e[f]+"( |\x24)")).test(g)){return false}}return true};if(/msie (\d+\.\d)/i.test(navigator.userAgent)){baidu.browser.ie=baidu.ie=document.documentMode||+RegExp["\x241"]}baidu.dom._NAME_ATTRS=(function(){var b={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};if(baidu.browser.ie<8){b["for"]="htmlFor";b["class"]="className"}else{b.htmlFor="for";b.className="class"}return b})();baidu.dom.setAttr=function(d,e,f){d=baidu.dom.g(d);if("style"==e){d.style.cssText=f}else{e=baidu.dom._NAME_ATTRS[e]||e;d.setAttribute(e,f)}return d};baidu.setAttr=baidu.dom.setAttr;baidu.dom.setAttrs=function(f,e){f=baidu.dom.g(f);for(var d in e){baidu.dom.setAttr(f,d,e[d])}return f};baidu.setAttrs=baidu.dom.setAttrs;baidu.dom.create=function(h,f){var g=document.createElement(h),e=f||{};return baidu.dom.setAttrs(g,e)};baidu.dom._styleFixer=baidu.dom._styleFixer||{};baidu.dom._styleFilter.filter=function(g,k,j){for(var h=0,l=baidu.dom._styleFilter,m;m=l[h];h++){if(m=m[j]){k=m(g,k)}}return k};baidu.dom.setStyle=function(k,f,j){var h=baidu.dom,g;k=h.g(k);f=baidu.string.toCamelCase(f);if(g=h._styleFilter){j=g.filter(f,j,"set")}g=h._styleFixer[f];(g&&g.set)?g.set(k,j):(k.style[g||f]=j);return k};baidu.setStyle=baidu.dom.setStyle;baidu.dom.getAttr=function(c,d){c=baidu.dom.g(c);if("style"==d){return c.style.cssText}d=baidu.dom._NAME_ATTRS[d]||d;return c.getAttribute(d)};baidu.getAttr=baidu.dom.getAttr;baidu.dom.getAncestorByTag=function(c,d){c=baidu.dom.g(c);d=d.toUpperCase();while((c=c.parentNode)&&c.nodeType==1){if(c.tagName==d){return c}}return null};baidu.dom.getDocument=function(b){b=baidu.dom.g(b);return b.nodeType==9?b:b.ownerDocument||b.document};baidu.dom.getComputedStyle=function(e,f){e=baidu.dom._g(e);var g=baidu.dom.getDocument(e),h;if(g.defaultView&&g.defaultView.getComputedStyle){h=g.defaultView.getComputedStyle(e,null);if(h){return h[f]||h.getPropertyValue(f)}}return""};baidu.dom.getStyle=function(k,f){var h=baidu.dom;k=h.g(k);f=baidu.string.toCamelCase(f);var j=k.style[f]||(k.currentStyle?k.currentStyle[f]:"")||h.getComputedStyle(k,f);if(!j){var g=h._styleFixer[f];if(g){j=g.get?g.get(k):baidu.dom.getStyle(k,g)}}if(g=h._styleFilter){j=g.filter(f,j,"get")}return j};baidu.getStyle=baidu.dom.getStyle;baidu.dom.setStyles=function(d,f){d=baidu.dom.g(d);for(var e in f){baidu.dom.setStyle(d,e,f[e])}return d};baidu.setStyles=baidu.dom.setStyles;if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){baidu.browser.opera=+RegExp["\x241"]}baidu.browser.isWebkit=/webkit/i.test(navigator.userAgent);baidu.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);baidu.browser.isStrict=document.compatMode=="CSS1Compat";baidu.dom.getPosition=function(x){x=baidu.dom.g(x);var o=baidu.dom.getDocument(x),u=baidu.browser,r=baidu.dom.getStyle,v=u.isGecko>0&&o.getBoxObjectFor&&r(x,"position")=="absolute"&&(x.style.top===""||x.style.left===""),q={left:0,top:0},s=(u.ie&&!u.isStrict)?o.body:o.documentElement,n,w;if(x==s){return q}if(x.getBoundingClientRect){w=x.getBoundingClientRect();q.left=Math.floor(w.left)+Math.max(o.documentElement.scrollLeft,o.body.scrollLeft);q.top=Math.floor(w.top)+Math.max(o.documentElement.scrollTop,o.body.scrollTop);q.left-=o.documentElement.clientLeft;q.top-=o.documentElement.clientTop;var p=o.body,m=parseInt(r(p,"borderLeftWidth")),t=parseInt(r(p,"borderTopWidth"));if(u.ie&&!u.isStrict){q.left-=isNaN(m)?2:m;q.top-=isNaN(t)?2:t}}else{n=x;do{q.left+=n.offsetLeft;q.top+=n.offsetTop;if(u.isWebkit>0&&r(n,"position")=="fixed"){q.left+=o.body.scrollLeft;q.top+=o.body.scrollTop;break}n=n.offsetParent}while(n&&n!=x);if(u.opera>0||(u.isWebkit>0&&r(x,"position")=="absolute")){q.top-=o.body.offsetTop}n=x.offsetParent;while(n&&n!=o.body){q.left-=n.scrollLeft;if(!u.opera||n.tagName!="TR"){q.top-=n.scrollTop}n=n.offsetParent}}return q};baidu.dom.remove=function(d){d=baidu.dom._g(d);var c=d.parentNode;c&&c.removeChild(d)};baidu.dom.insertHTML=function(j,g,k){j=baidu.dom.g(j);var f,h;if(j.insertAdjacentHTML){j.insertAdjacentHTML(g,k)}else{f=j.ownerDocument.createRange();g=g.toUpperCase();if(g=="AFTERBEGIN"||g=="BEFOREEND"){f.selectNodeContents(j);f.collapse(g=="AFTERBEGIN")}else{h=g=="BEFOREBEGIN";f[h?"setStartBefore":"setEndAfter"](j);f.collapse(h)}f.insertNode(f.createContextualFragment(k))}return j};baidu.insertHTML=baidu.dom.insertHTML;baidu.dom.prev=function(b){return baidu.dom._matchNode(b,"previousSibling","previousSibling")};baidu.dom.q=function(l,o,r){var k=[],p=baidu.string.trim,m,n,s,q;if(!(l=p(l))){return k}if("undefined"==typeof o){o=document}else{o=baidu.dom.g(o);if(!o){return k}}r&&(r=p(r).toUpperCase());if(o.getElementsByClassName){s=o.getElementsByClassName(l);m=s.length;for(n=0;n<m;n++){q=s[n];if(r&&q.tagName!=r){continue}k[k.length]=q}}else{l=new RegExp("(^|\\s)"+baidu.string.escapeReg(l)+"(\\s|\x24)");s=r?o.getElementsByTagName(r):(o.all||o.getElementsByTagName("*"));m=s.length;for(n=0;n<m;n++){q=s[n];l.test(q.className)&&(k[k.length]=q)}}return k};baidu.q=baidu.Q=baidu.dom.q;baidu.dom.next=function(b){return baidu.dom._matchNode(b,"nextSibling","nextSibling")};(function(){var b=navigator.userAgent;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(b)&&!/chrome/i.test(b)){baidu.browser.safari=+(RegExp["\x241"]||RegExp["\x242"])}})();(function(){var b=baidu.dom.ready=function(){var h=false,j=[],m;if(document.addEventListener){m=function(){document.removeEventListener("DOMContentLoaded",m,false);l()}}else{if(document.attachEvent){m=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",m);l()}}}}function l(){if(!l.isReady){l.isReady=true;for(var c=0,d=j.length;c<d;c++){j[c]()}}}function a(){try{document.documentElement.doScroll("left")}catch(c){setTimeout(a,1);return}l()}function k(){if(h){return}h=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",m,false);window.addEventListener("load",l,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",m);window.attachEvent("onload",l);var d=false;try{d=window.frameElement==null}catch(c){}if(document.documentElement.doScroll&&d){a()}}}}k();return function(c){l.isReady?c():(j[j.length]=c)}}();b.isReady=false})();baidu.event=baidu.event||{};baidu.event.stopPropagation=function(b){if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}};baidu.event._listeners=baidu.event._listeners||[];baidu.event.getKeyCode=function(b){return b.which||b.keyCode};baidu.event.getTarget=function(b){return b.target||b.srcElement};baidu.event._eventFilter=baidu.event._eventFilter||{};baidu.event.on=function(j,o,m){o=o.replace(/^on/i,"");j=baidu.dom._g(j);var n=function(a){m.call(j,a)},k=baidu.event._listeners,p=baidu.event._eventFilter,l,q=o;o=o.toLowerCase();if(p&&p[o]){l=p[o](j,o,n);q=l.type;n=l.listener}if(j.addEventListener){j.addEventListener(q,n,false)}else{if(j.attachEvent){j.attachEvent("on"+q,n)}}k[k.length]=[j,o,m,n,q];return j};baidu.on=baidu.event.on;baidu.event.un=function(p,m,q){p=baidu.dom._g(p);m=m.replace(/^on/i,"").toLowerCase();var j=baidu.event._listeners,o=j.length,n=!q,k,l,r;while(o--){k=j[o];if(k[1]===m&&k[0]===p&&(n||k[2]===q)){l=k[4];r=k[3];if(p.removeEventListener){p.removeEventListener(l,r,false)}else{if(p.detachEvent){p.detachEvent("on"+l,r)}}j.splice(o,1)}}return p};baidu.un=baidu.event.un;baidu.event.once=function(f,e,h){f=baidu.dom._g(f);function g(a){h.call(f,a);baidu.event.un(f,e,g)}baidu.event.on(f,e,g);return f};baidu.event.preventDefault=function(b){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}};baidu.event.stop=function(d){var c=baidu.event;c.stopPropagation(d);c.preventDefault(d)};baidu.array=baidu.array||{};baidu.each=baidu.array.forEach=baidu.array.each=function(k,m,h){var n,l,o,j=k.length;if("function"==typeof m){for(o=0;o<j;o++){l=k[o];n=m.call(h||k,l,o);if(n===false){break}}}return k};baidu.array.remove=function(f,d){var e=f.length;while(e--){if(e in f&&f[e]===d){f.splice(e,1)}}return f};baidu.cookie._isValidKey=function(b){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(b)};baidu.cookie.setRaw=function(h,g,e){if(!baidu.cookie._isValidKey(h)){return}e=e||{};var f=e.expires;if("number"==typeof e.expires){f=new Date();f.setTime(f.getTime()+e.expires)}document.cookie=h+"="+g+(e.path?"; path="+e.path:"")+(f?"; expires="+f.toGMTString():"")+(e.domain?"; domain="+e.domain:"")+(e.secure?"; secure":"")};baidu.cookie.set=function(d,f,e){baidu.cookie.setRaw(d,encodeURIComponent(f),e)};baidu.cookie.getRaw=function(d){if(baidu.cookie._isValidKey(d)){var f=new RegExp("(^| )"+d+"=([^;]*)(;|\x24)"),e=f.exec(document.cookie);if(e){return e[2]||null}}return null};baidu.cookie.get=function(d){var c=baidu.cookie.getRaw(d);if("string"==typeof c){c=decodeURIComponent(c);return c}return null};baidu.page.getWidth=function(){var g=document,f=g.body,h=g.documentElement,e=g.compatMode=="BackCompat"?f:g.documentElement;return Math.max(h.scrollWidth,f.scrollWidth,e.clientWidth)};baidu.page.getViewWidth=function(){var c=document,d=c.compatMode=="BackCompat"?c.body:c.documentElement;return d.clientWidth};baidu.page.getScrollLeft=function(){var b=document;return window.pageXOffset||b.documentElement.scrollLeft||b.body.scrollLeft};baidu.page.getHeight=function(){var g=document,f=g.body,h=g.documentElement,e=g.compatMode=="BackCompat"?f:g.documentElement;return Math.max(h.scrollHeight,f.scrollHeight,e.clientHeight)};baidu.page.getViewHeight=function(){var c=document,d=c.compatMode=="BackCompat"?c.body:c.documentElement;return d.clientHeight};baidu.page.getScrollTop=function(){var b=document;return window.pageYOffset||b.documentElement.scrollTop||b.body.scrollTop};baidu.fn.blank=function(){};baidu.ajax.request=function(E,r){r=r||{};var z=r.data||"",B=!(r.async===false),A=r.username||"",t=r.password||"",I=(r.method||"GET").toUpperCase(),C=r.headers||{},v=r.timeout||0,G={},x,u,s;function y(){if(s.readyState==4){try{var a=s.status}catch(b){D("failure");return}D(a);if((a>=200&&a<300)||a==304||a==1223){D("success")}else{D("failure")}window.setTimeout(function(){s.onreadystatechange=baidu.fn.blank;if(B){s=null}},0)}}function H(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}if(window.XMLHttpRequest){return new XMLHttpRequest()}}function D(b){b="on"+b;var c=G[b],a=baidu.ajax[b];if(c){if(x){clearTimeout(x)}if(b!="onsuccess"){c(s)}else{try{s.responseText}catch(d){return c(s)}c(s,s.responseText)}}else{if(a){if(b=="onsuccess"){return}a(s)}}}for(u in r){G[u]=r[u]}C["X-Requested-With"]="XMLHttpRequest";try{s=H();if(I=="GET"){if(z){E+=(E.indexOf("?")>=0?"&":"?")+z;z=null}if(r.noCache){E+=(E.indexOf("?")>=0?"&":"?")+"b"+(+new Date)+"=1"}}if(A){s.open(I,E,B,A,t)}else{s.open(I,E,B)}if(B){s.onreadystatechange=y}if(I=="POST"){s.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}for(u in C){if(C.hasOwnProperty(u)){s.setRequestHeader(u,C[u])}}D("beforerequest");if(v){x=setTimeout(function(){s.onreadystatechange=baidu.fn.blank;s.abort();D("timeout")},v)}s.send(z);if(!B){y()}}catch(w){D("failure")}return s};baidu.ajax.get=function(c,d){return baidu.ajax.request(c,{onsuccess:d})};baidu.page.load=function(r,k,p){k=k||{};var m=baidu.page.load,t=m._cache=m._cache||{},n=m._loadingCache=m._loadingCache||{},o=k.parallel;function q(){for(var a=0,b=r.length;a<b;++a){if(!t[r[a].url]){setTimeout(arguments.callee,10);return}}k.onload()}function s(a,d){var e,b,c;switch(a.type.toLowerCase()){case"css":e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");break;case"js":e=document.createElement("script");e.setAttribute("type","text/javascript");e.setAttribute("charset",a.charset||m.charset);break;case"html":e=document.createElement("iframe");e.frameBorder="none";break;default:return}c=function(){if(!b&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){b=true;baidu.un(e,"load",c);baidu.un(e,"readystatechange",c);d.call(window,e)}};baidu.on(e,"load",c);baidu.on(e,"readystatechange",c);if(a.type=="css"){(function(){if(b){return}try{e.sheet.cssRule}catch(f){setTimeout(arguments.callee,20);return}b=true;d.call(window,e)})()}e.href=e.src=a.url;document.getElementsByTagName("head")[0].appendChild(e)}baidu.lang.isString(r)&&(r=[{url:r}]);if(!(r&&r.length)){return}function l(a){var b=a.url,e=!!o,c,d=function(f){t[a.url]=f;delete n[a.url];if(baidu.lang.isFunction(a.onload)){if(false===a.onload.call(window,f)){return}}!o&&m(r.slice(1),k,true);if((!p)&&baidu.lang.isFunction(k.onload)){q()}};a.type=a.type||b.substr(b.lastIndexOf(".")+1);a.requestType=a.requestType||(a.type=="html"?"ajax":"dom");if(c=t[a.url]){d(c);return e}if(!k.refresh&&n[a.url]){setTimeout(function(){l(a)},10);return e}n[a.url]=true;if(a.requestType.toLowerCase()=="dom"){s(a,d)}else{baidu.ajax.get(a.url,function(f,g){d(g)})}return e}baidu.each(r,l)};baidu.page.load.charset="UTF8";baidu.ajax.post=function(d,f,e){return baidu.ajax.request(d,{onsuccess:e,method:"POST",data:f})};function unit(){}F.module("base/genericview",function(c,d){var b=c("base/view");function a(e,f){this.model=e;this.el=f;this.init()}a.prototype=P.extend(b);return a});F.module("base/base",function(a,b){(function(f,c,d){f.g=f.G=c.g;f.q=f.Q=c.q;f.getPosition=c.dom.getPosition;f.hasAttr=c.dom.hasAttr;f.getAttr=c.dom.getAttr;f.setAttr=c.dom.setAttr;f.removeNode=c.dom.remove;f.removeClass=c.dom.removeClass;f.addClass=c.dom.addClass;f.hasClass=c.dom.hasClass;f.insertHTML=c.dom.insertHTML;f.domReady=c.dom.ready;f.createNode=c.dom.create;f.getAncestorByClass=c.dom.getAncestorByClass;f.getAncestorByTag=c.dom.getAncestorByTag;f.nextNode=c.dom.next;f.getScrollTop=c.page.getScrollTop;f.getScrollLeft=c.page.getScrollLeft;f.getWidth=c.page.getWidth;f.getHeight=c.page.getHeight;f.getViewHeight=c.page.getViewHeight;f.getViewWidth=c.page.getViewWidth;f.trim=c.trim;f.setStyles=c.dom.setStyles;f.getCookie=c.cookie.get;f.setCookie=c.cookie.set;f.createClass=c.lang.createClass;f.format=c.string.format;f.extend=function(k,h,j){var e;if(!h){h=k;k={}}c.extend(k,h);if(j){for(e in j){if(!k[e]&&j.hasOwnProperty(e)){k[e]=j[e]}}}return k};f.isArray=c.lang.isArray;f.isString=c.lang.isString;f.isObject=c.lang.isObject;f.isFunction=c.lang.isFunction;f.arrayPrepend=function(e,j){var h=[j];return h.concat(e)};f.preventDefault=c.event.preventDefault;f.stopPropagation=c.event.stopPropagation;f.jsonToQuery=c.url.jsonToQuery;f.getQueryValue=c.url.getQueryValue;f.each=c.each;f.objeach=c.object.each;f.on=c.on;f.un=c.event.un;f.getTarget=c.event.getTarget;f.stopEvent=c.event.stop;f.getKeyCode=c.event.getKeyCode;f.eacapeUrl=c.url.escapeSymbol;f.callByBws=c.sio.callByBrowser;f.callBySrv=c.sio.callByServer;f.empty=c.fn.blank;f.ie=c.browser.ie;f.ie6=f.ie===6;f.getType=function(e){return Object.prototype.toString.call(e).toLowerCase()};f.resizeImg=function(o,j){var h,l,k,e;var m=function(){h=o.offsetWidth;l=o.offsetHeight};var n="pic-small";if(!j||!j.notResizeDimension){f.addClass(o,n)}if(!f.ie6){return false}if(j.maxwidth){m();if(h>j.maxwidth){o.style.width=j.maxwidth+"px"}}if(j.maxheight){m();if(l>j.maxheight){o.style.height=j.maxheight+"px"}}if(j.minwidth){m();if(h<j.minwidth){o.style.width=j.minwidth+"px"}}if(j.minheight){m();if(l<j.minheight){o.style.height=j.minheight+"px"}}if(j.callback&&typeof j.callback=="function"){j.callback()}};f.resizeDimension=function(s,j){var p,m,r,n,o,e,l,q,k,h=3;p={width:s.scrollWidth,height:s.scrollHeight};m=j;n=p.width>p.height?"height":"width";o=n=="height"?"width":"height";if(m){r={};r[n]=j[n]+"px"}l=Math.floor(m[n]/(p[n]/p[o]));k=l>>h;if(m[o]&&m[o]+k*2<l){q=o=="height"?"margin-top":"margin-left";r[q]=(0-k)+"px"}f.setStyles(s,r)};if(f.ie6){try{document.execCommand("BackgroundImageCache",false,true)}catch(g){}}f.ajax=(function(){var h=function(o,q,k){var p=function(r){if(k&&k.onError){k.onError(r)}};var l;if(o){if(k&&k.noParse){q&&q(o)}else{o=o.replace(/\r/g,"");var m={};try{m=c.json.parse(o)}catch(n){m.errNo=-999}if(m.errNo==0){q&&q(m.data)}else{q&&q(m)}}}else{l={errNo:-998};p(l)}};var j=function(l,m,k){if(l.indexOf(/asyn=1/)<0){l+=l.indexOf("?")>=0?"&":"?";l+="asyn=1&t="+ +new Date()}c.ajax.get(l,function(o,n){h(n,m,k)})};var e=function(l,m,n,k){if(typeof m!="string"){m=c.url.jsonToQuery(m)}m+="&t="+ +new Date();c.ajax.post(l,m,function(p,o){h(o,n,k)})};return{get:j,post:e}})();f.url={getUrl:function(e,h){var j=f.jsonToQuery(h);if(e.indexOf("?")>-1){return e+"&"+j}else{return e+"?"+j}}};f.remote=(function(){function h(j,l){var k=j.method.toUpperCase();url=j.url;j.data=f.jsonToQuery(j.data);j.onsuccess=j.onfailure=function(p,n){var m='{"errNo":-998}',o;if(n){o=n.replace(/\r/g,"");l(o)}else{if(p.status==200&&p.readState==4){l('{"errNo": 999, "msg":"no return value"}')}else{e();l(m)}}};c.ajax.request(url,j)}function e(){var l="imglog__"+f.getGuid(),j=window[l]=new Image(),k;j.onload=(j.onerror=function(){window[l]=null});k="http://nsclick.baidu.com/v.gif?pid=320&type=2011&evt=ajaxerr";if(App.router.global&&App.router.global.page_userInfo){k+="&page_portrait="+App.router.global.page_userInfo.portrait}j.src=k;j=null}return{request:h,log:e}})();f.isInView=function(k){if(typeof k=="string"){k=f.g(k)}if(!k){return false}if(k.offsetWidth==0||k.offsetHeight==0){return false}var h=f.getScrollTop()+f.getViewHeight(),j=f.getScrollLeft()+f.getViewWidth();var e=f.getPosition(k);return e.top<h&&e.left<j};f.addRefer=function(h){if(!h||h==="#"||/[\?\&]from=./.test(h)){return h}var e=h.indexOf("?"),j=h.indexOf("#"),l="from=prin";l=(e<0?"?":"&")+l;if(j>-1){var k=h.substr(j);h=h.replace(k,l)+k;return h}else{return h+l}};f.preloadImg=(function(){var k=[];var h=function(){if(k.length>0){try{e(k.shift(),h)}catch(l){h()}}};var j=function(m){var l=k.length;k=k.concat(m);if(l===0){h()}};var e=function(n,o){var l=new Image(),m="image_preload_"+(+new Date());window[m]=l;l.onload=l.onerror=l.onabort=function(){l.onload=l.onerror=l.onabort=null;window[m]=null;l=null;o&&o()};l.src=n};return{add:j}})();f.getGuid=(function(){var e=1000000;return function(){return e++}})();f.parse=c.json.parse;f.array={indexOf:function(e,j){var h=Array.prototype.indexOf||function(m){var k,l=false;if(!f.isArray(this)){return -1}k=this.length;while(k--){if(this[k]===m){l=true;break}}return l?k:-1};return h.call(e,j)}};f.event=function(e){return f.extend(e,c.lang.Class.prototype)};if(!Function.prototype.bind){Function.prototype.bind=function(j){var k=this,l=Array.prototype.slice;if(typeof k!="function"){throw new TypeError("Function.prototype.bind called on incompatible "+k)}var e=l.call(arguments,1);var h=function(){if(this instanceof h){var o=function(){};o.prototype=k.prototype;var n=new o;var m=k.apply(n,e.concat(l.call(arguments)));if(Object(m)===m){return m}return n}else{return k.apply(j,e.concat(l.call(arguments)))}};return h}}if(!window.JSON){window.JSON={parse:c.json.parse}}if(this.T===this.baidu){this.T=d}(function(){var k=c.browser,r={keydown:1,keyup:1,keypress:1},e={click:1,dblclick:1,mousedown:1,mousemove:1,mouseup:1,mouseover:1,mouseout:1},o={abort:1,blur:1,change:1,error:1,focus:1,load:k.ie?0:1,reset:1,resize:1,scroll:1,select:1,submit:1,unload:k.ie?0:1},m={scroll:1,resize:1,reset:1,submit:1,change:1,select:1,error:1,abort:1},q={KeyEvents:["bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"],MouseEvents:["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"],HTMLEvents:["bubbles","cancelable"],UIEvents:["bubbles","cancelable","view","detail"],Events:["bubbles","cancelable"]};c.object.values=function(w){var t=[],v=0,u;for(u in w){if(w.hasOwnProperty(u)){t[v++]=w[u]}}return t};c.object.extend(m,r);c.object.extend(m,e);function j(x,v){var u=0,t=x.length,w={};for(;u<t;u++){w[x[u]]=v[x[u]];delete v[x[u]]}return w}function l(v,u,t){t=c.object.extend({},t);var w=c.object.values(j(q[u],t)),x=document.createEvent(u);w.unshift(v);if("KeyEvents"==u){x.initKeyEvent.apply(x,w)}else{if("MouseEvents"==u){x.initMouseEvent.apply(x,w)}else{if("UIEvents"==u){x.initUIEvent.apply(x,w)}else{x.initEvent.apply(x,w)}}}c.object.extend(x,t);return x}function h(t){var u;if(document.createEventObject){u=document.createEventObject();c.object.extend(u,t)}return u}function n(w,t){t=j(q.KeyEvents,t);var x;if(document.createEvent){try{x=l(w,"KeyEvents",t)}catch(v){try{x=l(w,"Events",t)}catch(u){x=l(w,"UIEvents",t)}}}else{t.keyCode=t.charCode>0?t.charCode:t.keyCode;x=h(t)}return x}function s(u,t){t=j(q.MouseEvents,t);var v;if(document.createEvent){v=l(u,"MouseEvents",t);if(t.relatedTarget&&!v.relatedTarget){if("mouseout"==u.toLowerCase()){v.toElement=t.relatedTarget}else{if("mouseover"==u.toLowerCase()){v.fromElement=t.relatedTarget}}}}else{t.button=t.button==0?1:t.button==1?4:c.lang.isNumber(t.button)?t.button:0;v=h(t)}return v}function p(v,t){t.bubbles=m.hasOwnProperty(v);t=j(q.HTMLEvents,t);var x;if(document.createEvent){try{x=l(v,"HTMLEvents",t)}catch(w){try{x=l(v,"UIEvents",t)}catch(u){x=l(v,"Events",t)}}}else{x=h(t)}return x}c.event.fire=function(u,v,t){var w;v=v.replace(/^on/i,"");u=c.dom._g(u);t=c.object.extend({bubbles:true,cancelable:true,view:window,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0,button:0,relatedTarget:null},t);if(r[v]){w=n(v,t)}else{if(e[v]){w=s(v,t)}else{if(o[v]){w=p(v,t)}else{throw (new Error(v+" is not support!"))}}}if(w){if(u.dispatchEvent){u.dispatchEvent(w)}else{if(u.fireEvent){u.fireEvent("on"+v,w)}}}}})();f.fire=c.event.fire})(b,window.baidu)});F.use("base/base",function(a){window.P=a});F.module("base/view",function(a,d){var e=function(f){var g=false;while(f){if(f.nodeName=="#document"&&f.childNodes.length>1){g=true;break}f=f.parentNode}return g};var b=function(g,h){var f=g.length;while(f--){if(f in g&&g[f]===h){g.splice(f,1)}}return g};var c={hide:function(){if(!this.visible){return}this.el.style.display="none";this.visible=false},show:function(){if(this.visible){return}if(!this.isInDom){this.__parent?(this.__parent.appendChildView(this)):(document.appendChild(this.el));this.setDomReady()}if(this.el){this.el.style.display="block";this.visible=true}},appendTo:function(f){f.getChild(this);this.__parent=f},remove:function(){var f;this.__parent.removeChild(this);this.__parent=null;if(this.el){f=this.el.parentNode;f.removeChild(this.el)}this.el=null},removeChild:function(f){var g;if(f){g=f.model.id;if(g){b(this.__childrenViews,f)}}},getChild:function(f){if(!this.__childrenViews){this.__childrenViews=[]}this.__childrenViews.push(f)},init:function(){this.isInDom=e(this.el);if(this.isInDom){this.show()}this.model.addEventListener("change:visible",(function(f){if(f.visible){this.show()}else{this.hide()}}).bind(this))},setData:function(){},appendChildView:function(f){},setDomReady:function(){var g,f;for(g in this.__childrenViews){if(this.__childrenViews.hasOwnProperty(g)){f=this.__childrenViews[g];if(!f.isInDom){f.setDomReady()}}}this.isInDom=true;this.visible=true;this.dispatchEvent("update:viewready",{ready:this.isInDom})}};P.event(c);return c});F.module("base/genericmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;if(g&&typeof g.init=="function"){g.init.call(this)}}var b=a.prototype=P.extend(c);return a});F.module("base/model",function(a,c){var b={getChild:function(d){if(!this.__children){this.__children={}}this.__children[d.id]=d},appendTo:function(d){if(this.__parent==d){return}d.getChild(this);this.__parent=d},remove:function(){this.__parent.removeChild(this);this.__parent=null;this.dispose()},removeChild:function(d){if(d){delete this.__children[d.id]}},setData:function(){},getData:function(){},dispose:function(){if(this.__parent){this.__parent.removeChild(this)}if(this.__listeners){this.__listeners=null}},visible:function(d){if(!arguments.length){return this.__visible}else{this.__visible=d;this.dispatchEvent("change:visible",{visible:d})}}};P.event(b);return b});F.module("bigpipe/bigpipe",function(b,d){function c(g){var e=P.g(g),f=e.firstChild;while(f.nodeType!=8){f=f.firstChild;if(!f){throw"cannot get the content from contentHolder"}}return f.nodeValue}function a(k,h){var j=document.createElement("div"),g,f,e;j.innerHTML=k;g=j.childNodes;for(f=0,e=g.length;g[f].nodeType!=1;f++){}if(f===e){throw"Create Template Error bigpipe.js"}P.setAttr(g[f],"id",h);return g[f]}onPageletArrive=function(m){if(!m){return}var o=m.targetId,f=m.viewValue,g=m.tplId,k=m.viewType,j=m.tplContent,e=m.viewReady,p=m.options,h=m.modelValue,n,l;if(!o){throw"targetId must be passed in"}else{if(g){l=c(g)}else{if(j){l=j;if(m.assignedId){g=m.assignedId}else{g=P.getGuid()}}else{throw"templateId or templateContent must be passed in"}}}n=[o,f,k,a(l,g),g,h,p,e];this.pageLetArrive.apply(this,n)};return onPageletArrive});F.module("tracking/track",function(req,exp){var defaults={baseUrl:"http://nsclick.baidu.com/v.gif"};function ctor(){this.baseUrl=defaults.baseUrl;this.isBubble=true}function _sendRequest(baseUrl,trackParams){var n="imglog__"+P.getGuid(),img=window[n]=new Image();img.onload=(img.onerror=function(){window[n]=null});img.src=_generatingUrl(baseUrl,trackParams);img=null}function _generatingUrl(baseUrl,params){params._t=new Date-0;if(params){baseUrl+=baseUrl.indexOf("?")>-1?"&":"?"}return baseUrl+P.jsonToQuery(params)}var F=P.createClass(ctor),fn=F.prototype,getValueMaps={text:function(ele){return ele.text||ele.innerText},id:function(ele){return P.getAttr(ele,"id")},parent:function(ele){var parent=P.getAncestorByTag(ele,"div");if(!parent){return}if(parent.id){return"id:"+parent.id}else{if(parent.className){return"class:"+parent.className}}}};fn._getValue=function(method,ele){var attr=method.indexOf("attr:")>-1?method.split(":"):null;var eValue=method.indexOf("eval:")>-1?method.split(":"):null;if(attr&&attr.length==2){return P.getAttr(ele,attr[1])}else{if(eValue&&eValue.length==2){return window.eval(eValue[1])}else{if(getValueMaps[method]){return getValueMaps[method](ele)}else{return ele[method]}}}};fn.sendRequest=function(ele){var validObj,trackParams={},trackObj={login_portrait:App.router.global.login_userInfo.portrait,page_portrait:App.router.global.page_userInfo.portrait,baidu_id:P.getCookie("BAIDUID")},trackType,trackValue,additionalParams,from;if(from=P.getQueryValue(location.href,"from")){trackObj.url_from=from}if(this.validateElement){validObj=this.validateElement(ele)}if(validObj.valid){additionalParams=validObj.params;for(trackType in additionalParams){if(additionalParams.hasOwnProperty(trackType)){trackValue=this._getValue(additionalParams[trackType],ele);if(trackValue){trackParams[trackType]=trackValue}}}P.extend(trackObj,this.params);P.extend(trackObj,trackParams);_sendRequest(this.baseUrl,trackObj)}};F.sendRequest=function(options){var trackParams,baseUrl;baseUrl=options.baseUrl||defaults.baseUrl;trackParams=options.trackParams||{};_sendRequest(baseUrl,trackParams)};return F});F.module("tracking/clicktrack",function(e,g){var f=e("tracking/track");function a(j){var h=j;return function(l){var k=P.getTarget(l);h.sendRequest(k);if(!this.isBubble){P.stopPropagation(l)}}}function d(j,m){var h={pid:"320",type:"2011",evt:"click"},l=m?P.extend(h,m):h;this.element=j;this.rules=[];this.params=l;var k={params:{id:"id",cn:"className",parent:"parent",data_click:"attr:data-click",data_pn:"attr:data-pn",data_tab:"attr:data-tab"},validate:function(n){return n.nodeName.toLowerCase()=="a"?1:0}};this.newRule(k);j&&P.on(j,"click",a(this))}var c=P.createClass(d,{superClass:f}),b=c.prototype;b.validateElement=function(l){var k,j,m,h;for(m=this.rules,k=0,j=m.length;k<j;k++){h=m[k].validate.call(this,l);if(h==1){return{valid:true,params:m[k].params}}else{if(h==2){break}}}return{valid:false}};b.newRule=function(h){if(P.isFunction(h.validate)){this.rules.push(h)}};return c});F.module("tracking/trackmanager",function(c,n){var J=c("tracking/clicktrack"),E=c("tracking/track"),x;var z={id:"id",cn:"className",parent:"parent",data_click:"attr:data-click",data_pn:"attr:data-pn",data_tab:"attr:data-tab"};var p={params:z,validate:function(K){return K.nodeName.toLowerCase()=="img"&&K.parentNode.nodeName.toLowerCase()=="a"?1:0}};var G={params:z,validate:function(K){return K.nodeName.toLowerCase()=="span"&&K.parentNode.nodeName.toLowerCase()=="a"?1:0}};var k={params:z,validate:function(K){return K.nodeName.toLowerCase()=="img"&&P.hasAttr(K,"data-index")?1:0}};var D={params:z,validate:function(K){return K.nodeName.toLowerCase()=="div"&&K.className.toLowerCase()=="video"?1:0}};var e={params:z,validate:function(K){return K.nodeName.toLowerCase()=="li"&&P.hasAttr(K,"data-tab")?1:0}};var r={params:z,validate:function(K){return !!P.getAncestorByTag(K,"a")}};var I={params:z,validate:function(K){return K.nodeName.toLowerCase()=="i"&&K.parentNode.nodeName.toLowerCase()=="a"?1:0}};var o=function(L){var K=new J(L,{module:"userpanel"});K.newRule(G)};var u=function(L){var K=new J(L,{module:"basicinfo"})};var y=function(L){var K=new J(L,{module:"tabswitch"})};var s=function(L){var K=new J(L,{module:"tiebahonor"});K.newRule(r)};var d=function(L){var K=new J(L,{module:"tiebafeed"});K.newRule(e)};var t=function(L){var K=new J(L,{module:"tiebarelation"});K.newRule(p)};var b=function(L){var K=new J(L,{module:"tiebauserlist"});K.newRule(p)};var H=function(L){var K=new J(L,{module:"zhidaoprofile"});K.newRule(p);K.newRule(G)};var w=function(L){var K=new J(L,{module:"zhidaoanswerlist"})};var f=function(L){var K=new J(L,{module:"spacealbum"});K.newRule(p);K.newRule(k)};var A=function(L){var K=new J(L,{module:"spacearticle"});K.newRule(G);K.newRule(D)};var h=function(L){var K=new J(L,{module:"spacerelation"});K.newRule(p)};var a=function(L){var K=new J(L,{module:"spacefriend"});K.newRule(p)};var B=function(L){var K=new J(L,{module:"tipbar"});K.newRule(p)};var C=function(L){var K=new J(L,{module:"rightnav"});K.newRule(G)};var g=function(L){var K=new J(L,{module:"skinchange"});K.newRule(I)};var j=function(L){var K=new J(L,{module:"timeline"});K.newRule(p)};var q=function(L){var K=new J(L,{module:"timelinenav"})};var l=function(L){var K=new J(L,{module:"summary"})};var v=function(L){var K=new J(L,{module:"rewardlist"})};var m=function(L){var K=new J(L,{module:"rewardholder"})};return{userPanel:o,basicInfo:u,tiebaHonor:s,contentHolder:y,tiebaFeed:d,tiebaRelation:t,tiebaFriend:b,zhidaoProfile:H,zhidaoAnswerlist:w,spaceAlbum:f,spaceArticle:A,spaceRelation:h,spaceFriend:a,tipBar:B,rightNav:C,skinChange:g,timeline:j,timelineNav:q,summary:l,rewardList:v,rewardHolder:m,sendLogRequest:function(K){var L={pid:"320",type:"2011"};K=K||{};K.trackParams=P.extend(L,K.trackParams);E.sendRequest(K)}}});F.module("tieba_relation/tiebarelationview",function(k,e){var h=k("base/view");var d={error:function(n,o){var l,m;if(n==-101){l=k("dialog/dialogmanager");l.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}else{if(n==-1){m=o.errMsg||"<b>服务器忙，请稍候再试</b>";l=k("dialog/dialogmanager");l.alert(m,{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});setTimeout(function(){l.hide()},1000);return}}}};var c=function(l){var m=this.el;P.on(this.el,"click",(function(o){var p=P.getTarget(o),q;if(P.hasClass(p,"js-friendlist")){q=P.getAttr(p,"data-part");P.preventDefault(o);a(this.el,false);this.model.getData({requestType:"tbfriendlist",data:{type:q}})}else{if(P.getAncestorByClass(p,"js-relationBox")){if(P.hasClass(p,"add-follow")){requestType="add";this.model.doAction(requestType,d)}else{if(P.hasClass(p,"cancel")){requestType="delete";dm=k("dialog/dialogmanager");dm.confirm(o,"确定不再关注"+this.model.router.global.page_userInfo.username+"？",(function(){this.model.doAction(requestType,d)}).bind(this))}}P.preventDefault(o)}}}).bind(this));var n=k("tracking/trackmanager");n.tiebaRelation(this.el)};var a=function(l,n){var m="hide-porlist";if(n){P.removeClass(l,m)}else{P.addClass(l,m)}};var f=function(m){var n=P.q("rl-count-follows",this.el)[0],o=P.q("rl-count-fans",this.el)[0];if(m.data.fans!==undefined&&o){if(o.innerHTML==="0"){o.parentNode.innerHTML='<a href="#" class="relation-link yahei rl-count-fans js-friendlist" data-part="fans">'+m.data.fans+"</a>"}else{if(m.data.fans===0&&o){o.parentNode.innerHTML='<span class="yahei rl-count-fans relation-span">0</span>'}else{var l=k("number_move/number_move");l.play(o,m.data.fans)}}}if(m.data.follows!==undefined&&n){if(n.innerHTML==="0"){n.parentNode.innerHTML='<a href="#" class="relation-link yahei rl-count-follows js-friendlist" data-part="follow">'+m.data.follows+"</a>"}else{if(m.data.follows===0&&n){n.parentNode.innerHTML='<span class="yahei rl-count-follows relation-span">0</span>'}else{var l=k("number_move/number_move");l.play(n,m.data.follows)}}}};var g=function(l){var n=P.q("relation-button",this.el)[0],m=P.q("show-follow",this.el)[0];if(n&&m){if(l.data.opt==="add"){n.style.display="none";m.style.display="block"}else{if(l.data.opt==="delete"){n.style.display="block";m.style.display="none"}}}};var b=function(l,m){this.model=l;this.el=m;this.init();this.addEventListener("update:viewready",c.bind(this));this.model.addEventListener("update:portraitlist",(function(n){var o=this.el;a(o,n.visible)}).bind(this));this.model.addEventListener("change:count",f.bind(this));this.model.addEventListener("update:relationbtn",g.bind(this))};var j=b.prototype=P.extend(h);return b});F.module("tieba_relation/tiebarelationmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;if(g&&typeof g.init=="function"){g.init.call(this)}}var b=a.prototype=P.extend(c);b.getData=function(g){var h=g.requestType,f;if(h=="tbfriendlist"){if(g.data){f=g.data}this.__parent.getData({tab:"tieba",part:"friend",options:{type:f.type}});this.router.brocast(h,{tab:f.type});this.__parent.addEventListener("change:tab",(function(j){if(j.part=="friend"){this.dispatchEvent("update:portraitlist",{visible:false})}else{if(j.part=="index"){this.dispatchEvent("update:portraitlist",{visible:true})}}}).bind(this))}};b.doAction=function(f,g){if(f==="add"){this.router.followCurrentUser("tieba",g)}else{if(f==="delete"){this.router.unfollowCurrentUser("tieba",g)}}};return a});baidu.fx=baidu.fx||{};baidu.fx.Timeline=baidu.lang.createClass(function(b){baidu.object.extend(this,baidu.fx.Timeline.options);baidu.object.extend(this,b)},{className:"baidu.fx.Timeline",options:{interval:16,duration:500,dynamic:true}}).extend({launch:function(){var b=this;b.dispatchEvent("onbeforestart");typeof b.initialize=="function"&&b.initialize();b["\x06btime"]=new Date().getTime();b["\x06etime"]=b["\x06btime"]+(b.dynamic?b.duration:0);b["\x06pulsed"]();return b},"\x06pulsed":function(){var c=this;var d=new Date().getTime();c.percent=(d-c["\x06btime"])/c.duration;c.dispatchEvent("onbeforeupdate");if(d>=c["\x06etime"]){typeof c.render=="function"&&c.render(c.transition(c.percent=1));typeof c.finish=="function"&&c.finish();c.dispatchEvent("onafterfinish");c.dispose();return}typeof c.render=="function"&&c.render(c.transition(c.percent));c.dispatchEvent("onafterupdate");c["\x06timer"]=setTimeout(function(){c["\x06pulsed"]()},c.interval)},transition:function(b){return b},cancel:function(){this["\x06timer"]&&clearTimeout(this["\x06timer"]);this["\x06etime"]=this["\x06btime"];typeof this.restore=="function"&&this.restore();this.dispatchEvent("oncancel");this.dispose()},end:function(){this["\x06timer"]&&clearTimeout(this["\x06timer"]);this["\x06etime"]=this["\x06btime"];this["\x06pulsed"]()}});baidu.fx.create=function(j,f,k){var h=new baidu.fx.Timeline(f);h.element=j;h._className=k||h._className;h["\x06original"]={};var g="baidu_current_effect";h.addEventListener("onbeforestart",function(){var a=this,b;a.attribName="att_"+a._className.replace(/\W/g,"_");b=a.element.getAttribute(g);a.element.setAttribute(g,(b||"")+"|"+a.guid+"|",0);if(!a.overlapping){(b=a.element.getAttribute(a.attribName))&&window[baidu.guid]._instances[b].cancel();a.element.setAttribute(a.attribName,a.guid,0)}});h["\x06clean"]=function(a){var b=this,c;if(a=b.element){a.removeAttribute(b.attribName);c=a.getAttribute(g);c=c.replace("|"+b.guid+"|","");if(!c){a.removeAttribute(g)}else{a.setAttribute(g,c,0)}}};h.addEventListener("oncancel",function(){this["\x06clean"]();this["\x06restore"]()});h.addEventListener("onafterfinish",function(){this["\x06clean"]();this.restoreAfterFinish&&this["\x06restore"]()});h.protect=function(a){this["\x06original"][a]=this.element.style[a]};h["\x06restore"]=function(){var a=this["\x06original"],b=this.element.style,d;for(var c in a){d=a[c];if(typeof d=="undefined"){continue}b[c]=d;if(!d&&b.removeAttribute){b.removeAttribute(c)}else{if(!d&&b.removeProperty){b.removeProperty(c)}}}};return h};baidu.fx.move=function(d,e){if(!(d=baidu.dom.g(d))||baidu.dom.getStyle(d,"position")=="static"){return null}e=baidu.object.extend({x:0,y:0},e||{});if(e.x==0&&e.y==0){return null}var f=baidu.fx.create(d,baidu.object.extend({initialize:function(){this.protect("top");this.protect("left");this.originX=parseInt(baidu.dom.getStyle(d,"left"))||0;this.originY=parseInt(baidu.dom.getStyle(d,"top"))||0},transition:function(a){return 1-Math.pow(1-a,2)},render:function(a){d.style.top=(this.y*a+this.originY)+"px";d.style.left=(this.x*a+this.originX)+"px"}},e),"baidu.fx.move");return f.launch()};F.module("tangram_move/tangram_move",function(){});F.module("userpanel/userpanel",function(b,g){var a=false;var h;var e=(function(){var j;return{show:function(){if(j){clearTimeout(j)}if(!a){j=setTimeout(h,250)}},hide:function(){if(j){clearTimeout(j)}if(a){j=setTimeout(h,250)}}}})();var f=function(k){var j=["inactive","active"];return function(){if(a){P.removeClass(k,j[1]);P.addClass(k,j[0]);a=false}else{P.removeClass(k,j[0]);P.addClass(k,j[1]);a=true}}};var d=function(j,k){P.on(j,"click",function(l){P.preventDefault(l)});P.on(j,"mouseover",e.show);P.on(j,"mouseout",e.hide);P.on(k,"mouseover",e.show);P.on(k,"mouseout",e.hide)};var c=function(){var j=P.g("pUserInfo"),k=P.g("pUserNamePopup");if(j){h=f(k);d(j,k)}};g.init=c});F.module("userpanel/userpanelview",function(c,e){var b=c("base/view");var f=function(){F.use("userpanel/userpanel",function(j){j.init()});if(this.model.router.global.isLoginUserNoName){var h=P.q("no-home",this.el)[0];h&&P.on(h,"click",function(){var j=c("no_username/no_username");j.hasUsername()})}var g=c("tracking/trackmanager");g.userPanel(this.el)};function d(g,h){this.model=g;this.el=h;this.init();this.addEventListener("update:viewready",f.bind(this))}var a=d.prototype=P.extend(b);return d});F.module("photo_slide/photo_slide",function(b,f){var e;var o;var p;var s=0;var r=false;var n;var w;var c=function(y,x){n=document.body.offsetWidth;p=y;s=x|0;if(e){e.style.display="block"}else{l();m()}u();j()};var h=function(){var x=s+1;if(p.length>x){var y=w.albumStatic+"/"+p[x]+"/pic/item/"+p[x]+".jpg";P.preloadImg.add(y)}};var d=function(){P.un(window,"resize",u);e.style.display="none";P.removeClass(e,"big-screen small-screen");document.body.style.width=n+"px";document.documentElement.style.overflowY="scroll"};var l=function(){var x=['<div class="slide-bg" data-click="close"></div>','<div class="slide-content" id="pPhotoSlideContent">','<div class="photo-show clearfix">','<a href="#" hidefocus onclick="return false;" class="go-left" id="pPhotoSlideGoLeft" data-click="left"><span class="go-left-bg" data-click="left"></span></a>','<div class="photo-box" style="color:#fff;">','<span id="pPhotoSlideImage"></span>&nbsp;','<a href="#" hidefocus onclick="return false;" class="under-photo-left" id="pPhotoSlideUnderLeft" data-click="left"></a>','<a href="#" hidefocus onclick="return false;" class="under-photo-right" id="pPhotoSlideUnderRight" data-click="right"></a>',"</div>",'<a href="#" hidefocus onclick="return false;" class="go-right" id="pPhotoSlideGoRight" data-click="right"><span class="go-right-bg" data-click="right"></span></a>',"</div>",'<div class="photo-title" id="pPhotoSlideTitle"></div>','<div class="photo-info">','<a href="#" class="info-comment" id="pPhotoSlideComment" target="_blank">评论图片</a>','<a href="#" class="info-origin" id="pPhotoSlideOrigin" target="_blank">查看原图</a>','<div class="info-from" id="pPhotoSlideFrom">来自 <a id="pPhotoSlideAlbum" target="_blank"></a> 相册 (共<span id="pPhotoSlideCount"></span>张)</div>','<div class="info-datetime" id="pPhotoSlideTime"></div>',"</div>",'<a href="#" hidefocus onclick="return false;" class="slide-close" data-click="close"></a>',"</div>"].join("");e=P.createNode("div",{className:"mod-photo-slide",id:"pPhotoSlidePopup"});e.innerHTML=x;document.body.appendChild(e)};var u=function(){document.body.style.width="auto";document.documentElement.style.overflowY="hidden";document.body.scrollTop=0;document.documentElement.scrollTop=0;e.style.width=P.getWidth()+"px";e.style.height=P.getHeight()+"px";if(P.getViewHeight()>800){P.addClass(e,"big-screen");r=false}else{P.addClass(e,"small-screen");r=true}o=P.g("pPhotoSlideContent");o.style.left=(P.getViewWidth()-980)/2+"px";var x=P.getViewHeight()-o.offsetHeight;o.style.top=(x>0?x:0)/2+"px"};var q=function(){var z=P.g("pPhotoSlideTitle"),y=P.g("pPhotoSlideComment"),D=P.g("pPhotoSlideOrigin"),B=P.g("pPhotoSlideAlbum"),x=P.g("pPhotoSlideCount"),A=P.g("pPhotoSlideTime"),C=P.g("pPhotoSlideFrom");C.style.display="none";y.style.display="none";D.style.display="none";if(App.router.global.page_userInfo.spaceurl){y.style.display="block";D.style.display="block";y.href=w.album+"/"+App.router.global.page_userInfo.spaceurl+"/album/item/"+p[s]+".html?from=prin#commentForm";D.href=w.album+"/"+App.router.global.page_userInfo.spaceurl+"/album/item/"+p[s]+".html?from=prin";P.callByBws(w.album+"/"+App.router.global.page_userInfo.spaceurl+"/album/item/"+p[s]+".html/info?t="+ +new Date(),function(){if(picErrorNum==0){o.style.display="none";z.innerHTML=newPhoto.imgName;if(newPhoto.albumName){B.innerHTML=newPhoto.albumName;B.href=w.album+"/"+App.router.global.page_userInfo.spaceurl+"/album/"+P.eacapeUrl(newPhoto.albumName)+"?from=prin";x.innerHTML=newPhoto.imgAllNum||"1";C.style.display="block"}A.innerHTML=newPhoto.imCrtTime?"上传于 <span>"+newPhoto.imCrtTime.replace(/\./g,"-")+"</span>":"";o.style.display="block"}else{A.innerHTML=""}},{charset:"gbk"})}else{k(q)}};var k=function(x){P.ajax.get("/p/sys/data/spaceurl?portrait="+App.router.global.page_userInfo.portrait,function(y){if(y.spaceUrl){App.router.global.page_userInfo.spaceurl=y.spaceUrl;x&&x()}})};var j=function(){var z=P.g("pPhotoSlideImage");var x=p[s];q();var y=P.createNode("img",{className:"photo-image"});if(P.ie6){y.onload=function(){var D=r?470:630,C=800,B=y.offsetHeight,A=y.offsetWidth;if(B/A<D/C){P.resizeImg(y,{maxwidth:C,notResizeDimension:true})}else{P.resizeImg(y,{maxheight:D,notResizeDimension:true})}if(B<D){y.style.marginTop=(D-B)/2+"px"}y.style.visibility="visible"}}z.innerHTML="";z.appendChild(y);y.src=w.albumStatic+"/"+x+"/pic/item/"+x+".jpg";v();h()};var m=function(){P.on(e,"click",function(C){var E=P.getTarget(C);var D=P.getAttr(E,"data-click");if(D=="close"){d()}else{if(D=="left"){t()}else{if(D=="right"){a()}}}});P.on(document.body,"keydown",function(C){if(P.getKeyCode(C)==27){d()}});P.on(window,"resize",u);var B=P.g("pPhotoSlideUnderRight"),y=P.g("pPhotoSlideUnderLeft"),x=P.g("pPhotoSlideGoRight"),A=P.g("pPhotoSlideGoLeft");P.on(B,"mouseover",function(){P.addClass(x,"hoverr")});P.on(y,"mouseover",function(){P.addClass(A,"hoverl")});P.on(B,"mouseout",function(){P.removeClass(x,"hoverr")});P.on(y,"mouseout",function(){P.removeClass(A,"hoverl")});var z=b("tracking/trackmanager");z.spaceAlbum(e)};var t=function(){if(s>0){s--;j()}};var a=function(){if(s<p.length-1){s++;j()}};var v=function(){P.removeClass(o,"no-left no-right");if(s==0){P.addClass(o,"no-left")}if(s==p.length-1){P.addClass(o,"no-right")}};var g=function(){w=b("router/router").global.domain};f.init=g;f.open=c});F.module("content_holder/holderview",function(d,e){var c=d("base/view");function b(g,h,f){this.el=h;this.model=g;this.init();if(f&&typeof f.init=="function"){f.init.call(this)}}var a=b.prototype=P.extend(c);a.appendChildView=function(g){var l=P.q("plzhld",this.el),h,f,j=g.holderTab,k;for(h=0,f=l.length;h<f;h++){k=l[h];if(j==P.getAttr(k,"data-fill")||j=="plzhld"){k.appendChild(g.el);break}}};a.setData=function(f,g){f.holderTab=g||"plzhld";f.appendTo(this)};return b});F.module("content_holder/holdermodel",function(d,e){var b=d("base/model");function c(j,f,g){var h={tab:"none",part:"none"};this.id=j;this.router=f;this.__children={};this.__viewparts={};this.setCurrentView=function(l,k){h.tab=l;h.part=k};this.tab=function(k){if(k){this.dispatchEvent("change:tab",{tab:k.tab,part:k.part});return this}return h};this.addEventListener("change:tab",function(s){var n=this.__children;if(!n){return}var m,q,o,l,r=s.tab,k=s.part,p;l=this.__viewparts[r];for(o in l){if(l.hasOwnProperty(o)){if(o=="all"||o==k){this.updateChildrenVisible(l[o],true)}else{if(k!="all"){this.updateChildrenVisible(l[o],false)}}}}l=this.__viewparts;for(p in l){if(l.hasOwnProperty(p)&&p!=r){for(o in l[p]){if(l[p].hasOwnProperty(o)){this.updateChildrenVisible(l[p][o],false)}}}}if(r!="all"&&k!="all"){this.setCurrentView(r,k)}});if(g&&typeof g.init=="function"){g.init.call(this)}}var a=c.prototype=P.extend(b);a.updateChildrenVisible=function(h,j){var g,f=h.length,k;for(g=0;g<f;g++){k=h[g];if(this.__children[k]){this.__children[k].visible(j)}}};a.setData=function(h,f){var j,g;if(!f){j="all";g="all"}else{j=f.tab||"all";g=f.part||"all"}if(h&&!this.__children[h.id]){h.appendTo(this);if(!this.__viewparts[j]){this.__viewparts[j]={}}if(!this.__viewparts[j][g]){this.__viewparts[j][g]=[]}this.__viewparts[j][g].push(h.id)}if((!this.requestTab||j==this.requestTab||j=="all")&&(!this.requestPart||g==this.requestPart||g=="all")){this.tab({tab:j,part:g})}};a.getData=function(g){var h=g.tab,f=g.part||"index";this.requestTab=h;this.requestPart=f;this.dispatchEvent("change:getdata");if(this.__viewparts[h]&&this.__viewparts[h][f]){this.setData(null,{tab:h,part:f})}else{if(g.options){this.router.getData(this,h+"-"+f,g.options)}else{this.router.getData(this,h+"-"+f)}}};return c});F.module("tieba_feed/tiebafeedcontentmodel",function(c,e){var b=c("base/model");function d(h,f,g){this.id=h;this.router=f;if(g&&typeof g.init=="function"){g.init.call(this)}}var a=d.prototype=P.extend(b);return d});F.module("tieba_feed/tiebafeedholder",function(c,d){var b=['<div class="mod-tieba-feed clearfix">','<ul class="feed-tab clearfix feed-tab-all">','<li class="tab-item tab-all" data-tab="all">全部贴</li>','<li class="split"></li>','<li class="tab-item tab-zhuti" data-tab="zhuti">主题贴</li>','<li class="split"></li>','<li class="tab-item tab-reply" data-tab="reply">回复贴</li>','<li class="slide"><div class="icon"></div></li>','<li class="hover"></li>',"</ul>",'<div class="feed-container plzhld clearfix">',"</div>",'<div class="loadingtpl">LOADING...</div>','<div class="plzhld"></div>',"</div>"].join("");function a(e,g){var f=e||"follow";App.onPageletArrive({targetId:"cnthld",viewValue:"feed_content",viewType:"TiebaFeedHolder",modelValue:{tab:"tieba",part:"index"},tplContent:b,assignedId:"tbfeedhld"})}return{createHolder:a}});F.module("tieba_feed/tiebafeedmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;this.__pn=1;if(g&&typeof g.init=="function"){g.init.call(this)}this.addEventListener("change:visible",(function(j){if(j.visible){this.dispatchEvent("update:getmore",{getmore:true})}else{this.dispatchEvent("update:getmore",{getmore:false})}}).bind(this))}var b=a.prototype=P.extend(c);b.getFeedContentId=function(){return P.getGuid()};b.setData=function(g,f){g.appendTo(this);g.visible(true);if(f==1){return}this.dispatchEvent("update:inserted",{hasMore:f.hasMore=="moreFeed"})};b.getData=function(){this.__pn++;this.requestNewContent()};b.requestNewContent=function(){this.router.getData(this,"tiebaFeed",{pn:this.__pn,type:this.feedType})};return a});F.module("tieba_feed/tiebafeedholderview",function(h,c){var g=h("base/view"),b=function(k,l){this.model=k;this.el=l;this.init();this.addEventListener("update:viewready",e.bind(this));this.model.addEventListener("change:tab",f.bind(this))},j=b.prototype=P.extend(g);var f=function(k){P.removeClass(this.el,"loading")};var e=function(){d.call(this);var k=h("tracking/trackmanager");k.tiebaFeed(this.el)};var d=function(){var k=P.q("feed-tab",this.el)[0],l=this;if(k){P.on(k,"click",function(m){a.call(l,m,this)})}};var a=function(k,m){var n=P.getTarget(k),l;if(n&&(l=P.getAttr(n,"data-tab"))){P.removeClass(m,"feed-tab-zhuti feed-tab-itie feed-tab-zhuantie feed-tab-reply feed-tab-all");P.addClass(m,"feed-tab-"+l);P.addClass(this.el,"loading");this.model.getData({tab:l,options:{type:l}})}};j.appendChildView=function(p){var o=P.q("plzhld",this.el),l,k,m=p.holderTab,n;for(l=0,k=o.length;l<k;l++){n=o[l];if(m==P.getAttr(n,"data-fill")||m=="plzhld"){n.appendChild(p.el);break}}};j.setData=function(k,l){k.holderTab=l||"plzhld";k.appendTo(this)};return b});F.module("tieba_feed/tiebafeedview",function(l,c){var j=l("base/view");var n={};var a={};var b="all";var h=function(w){var v=P.getTarget(w),s=v.className,u="pic-small",t="pic-large";function r(y){var D=P.getAncestorByClass(v,"feed-image-item"),A=P.getAncestorByClass(D,"feed-image"),G="imgbox-large",H="img-large",x,B,E,C,z;if(!D||!A){return}if(y=="larger"){P.addClass(D,G);P.addClass(A,H)}else{if(y=="smaller"){P.removeClass(D,G);P.removeClass(A,H)}}}if(s.indexOf(u)>-1){if(P.ie6){ie6Height=v.style.height||"auto";ie6Width=v.style.width||"auto";if(!(normalSize=P.getAttr(v,"data-normalsize"))){img=new Image();img.src=v.src;normalSize={width:img.width,height:img.height};normalSize.width=normalSize.width>660?660:normalSize.width;normalSize.height=normalSize.height>660?660:normalSize.height;img=null;P.setAttr(v,"data-normalsize",'{"width":'+normalSize.width+',"height":'+normalSize.height+"}")}if(typeof normalSize=="string"){normalSize=JSON.parse(normalSize)}v.style.height=normalSize.height+"px";v.style.width=normalSize.width+"px";if(!P.getAttr(v,"data-size")){P.setAttr(v,"data-size",'{"width":"'+ie6Width+'","height":"'+ie6Height+'"}')}}P.removeClass(v,u);P.addClass(v,t);r("larger")}else{if(s.indexOf(t)>-1){if(P.ie6){ie6Obj=JSON.parse(P.getAttr(v,"data-size"));v.style.height=ie6Obj.height;v.style.width=ie6Obj.width}P.removeClass(v,t);P.addClass(v,u);r("smaller")}}};var e=function(r){var s=P.q("more-link-feed",this.el)[0];var t=this;s&&P.on(s,"click",function(v){d.call(t);P.preventDefault(v)});m.call(this);P.on(this.el,"click",h);var u=l("tracking/trackmanager");u.tiebaFeed(this.el)};var m=function(){var r=P.q("feed-item",this.el);P.each(r,function(s){if(P.getAttr(s,"data-bind")==1||P.hasClass(s,"mod-blank-message")){return}else{P.on(s,"mouseover",function(){P.addClass(s,"item-over")});P.on(s,"mouseout",function(){P.removeClass(s,"item-over")});P.setAttr(s,"data-bind",1)}})};var g=function(){var r=this.model.id;if(this.autoLoadTime<2){if(P.isInView(P.q("more-link-feed",this.el)[0])){d.call(this);a[r]=setTimeout(n[r],500);this.autoLoadTime++}else{a[r]=setTimeout(n[r],500)}}};var p=function(r){var s=this.model.id;if(r.getmore){if(!a[s]){a[s]=setTimeout((n[s]=g.bind(this)),1000)}}else{clearTimeout(a[s]);a[s]=null}};var d=function(){this.model.getData();o.call(this)};var o=function(){var r=P.q("feed-more",this.el)[0];P.removeClass(r,"invisible");P.addClass(r,"loading")};var q=function(t){var r=P.q("feed-more",this.el)[0],s;r&&P.removeClass(r,"loading");if(!t.hasMore&&r){s="nomore";P.addClass(r,s)}m.call(this)};function f(r,s){this.model=r;this.el=s;this.init();this.autoLoadTime=0;this.addEventListener("update:viewready",e.bind(this));this.model.addEventListener("update:getmore",p.bind(this));this.model.addEventListener("update:inserted",q.bind(this))}var k=f.prototype=P.extend(j);k.appendChildView=function(v){var r,s,t="feed-box",u="feed-more";if(v.el&&P.getAncestorByClass(v.el,t)){return}else{r=P.q(t,this.el)[0];s=P.q(u,this.el)[0];if(r&&s){r.insertBefore(v.el,s);v.setDomReady()}}};k.setData=function(r,s){r.feedPage=s;r.appendTo(this);if(this.isInDom){this.appendChildView(r);r.setDomReady()}};return f});F.module("tieba_honor/honor",function(c,e){var a=c("base/view"),b;function d(f){this.context=f;this.init()}b=d.prototype=P.extend(a);return d});F.module("tieba_honor/tiebahonorview",function(j,b){var g=j("base/view");var a="link-down";function d(m){var q="honor-list",n="link-up",r="link-down",p="show-all",o,l=P.q(q,P.getAncestorByClass(this,"mod-tieba-honor"))[0];if(l){if(a==r){P.addClass(l,p)}else{P.removeClass(l,p)}o=this;if(o){P.removeClass(o,a);a=a==r?n:r;P.addClass(o,a)}}}var c=function(){var m=P.q("honor-morebtn",this.el)[0];m&&P.on(m,"click",d);var l=j("tracking/trackmanager");l.tiebaHonor(this.el);f.call(this)};var f=function(){var l=P.g("pTiebaHonorCertified");if(l){F.use("tangram_move/tangram_move",function(){var n=function(){var o=new baidu.fx.Timeline();o.render=function(q){l.style.width=(q*58+7)+"px"};o.transition=function(q){return q*(2-q)};o.launch()};var m=function(){P.setStyles(l,{position:"relative",top:"-20px",display:"block"});var o=new baidu.fx.Timeline();o.render=function(q){l.style.top=((q-1)*20)+"px"};o.transition=function(p){if((p)<(1/2.75)){return(7.5625*p*p)}else{if(p<(2/2.75)){return(7.5625*(p-=(1.5/2.75))*p+0.75)}else{if(p<(2.5/2.75)){return(7.5625*(p-=(2.25/2.75))*p+0.9375)}else{return(7.5625*(p-=(2.625/2.75))*p+0.984375)}}}};o.finish=function(){setTimeout(n,500)};o.launch()};setTimeout(function(){m()},1000)})}};function k(l,m){this.model=l;this.el=m;this.init();this.addEventListener("update:viewready",c.bind(this))}var h=k.prototype=P.extend(g);function e(){}return k});F.module("zhidao_profile/zhidaoprofileview",function(e,g){var d=e("base/view");var c=function(h){F.use("ask_question/ask_question",function(j){j.ask(h)})};var a=function(h){var k=P.q("zhidao-profile-ask",this.el)[0];if(k){P.on(k,"click",c.bind(this))}var j=e("tracking/trackmanager");j.zhidaoProfile(this.el)};function f(h,j){this.model=h;this.el=j;this.init();this.addEventListener("update:viewready",a.bind(this))}var b=f.prototype=P.extend(d);return f});F.module("zhidao_profile/zhidaohonorview",function(g,h){var e=g("base/view");var b="link-down";function f(k){var o="gift-list",l="link-up",p="link-down",n="show-all",m,j=P.q(o,P.getAncestorByClass(this,"zhidao-gift"))[0];if(j){if(b==p){P.addClass(j,n)}else{P.removeClass(j,n)}m=this;if(m){P.removeClass(m,b);b=b==p?l:p;P.addClass(m,b)}}}var a=function(j){var l=P.q("honor-morebtn",this.el)[0];if(l){P.on(l,"click",f)}var k=g("tracking/trackmanager");k.zhidaoProfile(this.el)};function d(j,k){this.model=j;this.el=k;this.init();this.addEventListener("update:viewready",a.bind(this))}var c=d.prototype=P.extend(e);return d});F.module("space_article/spacearticlemodel",function(c,e){var b=c("base/model");function d(h,f,g){this.id=h;this.router=f;this.__pn=1;this.__more=true;if(g&&typeof g.init=="function"){g.init.call(this)}this.addEventListener("change:visible",(function(j){if(j.visible&&this.__more){this.dispatchEvent("update:getmore",{getmore:true})}else{this.dispatchEvent("update:getmore",{getmore:false})}}).bind(this))}var a=d.prototype=P.extend(b);a.getFeedContentId=function(){return P.getGuid()};a.setData=function(g,f){g.appendTo(this);g.visible(true);if(f.hasMore&&f.hasMore=="noMoreArticle"){this.__more=false}this.dispatchEvent("update:inserted",{hasMore:this.__more})};a.getPn=function(){return this.__pn};a.getData=function(){if(!this.__more){return}else{this.__pn++;this.requestNewContent()}};a.requestNewContent=function(){this.router.getData(this,"spaceArticle",{pn:this.__pn})};return d});F.module("space_article/spacearticleview",function(m,e){var k=m("base/view");var c,o;var b=0;var g=function(){this.model.getData();q.call(this)};var q=function(){var s=P.q("article-more",this.el)[0];P.addClass(s,"loading")};var j=function(v){var w=P.getTarget(v),x=w.className,A="pic-small",z="pic-large",y,u,s;function t(C){var I=P.getAncestorByClass(w,"imgbox"),E=P.getAncestorByClass(I,"article-img"),K="imgbox-large",L="img-large",B,G,J,H,D;if(!I||!E){return}if(C=="larger"){P.addClass(I,K);P.addClass(E,L)}else{if(C=="smaller"){P.removeClass(I,K);P.removeClass(E,L)}}}if(x.indexOf(A)>-1){y=P.getAttr(w,"data-bigpic");if(y){if(!P.hasClass(w,"pic-small-fix")){u=new Image();u.onload=(u.onerror=function(){this.onload=this.onerror=null});u.src=y;if(P.ie6){if(u.height>u.width){if(u.height>660){u.style.height="660px"}}else{if(u.width>660){u.style.width="660px"}}}u.className="articleimg pic-large pic-large-fix";P.addClass(w,"pic-small-fix");w.parentNode.insertBefore(u,w);u=null}}else{P.removeClass(w,A);P.addClass(w,z);if(P.ie6){ie6Height=w.style.height||"auto";ie6Width=w.style.width||"auto";if(!(normalSize=P.getAttr(w,"data-normalsize"))){img=new Image();img.src=w.src;normalSize={width:img.width,height:img.height};normalSize.width=normalSize.width>660?660:normalSize.width;normalSize.height=normalSize.height>660?660:normalSize.height;img=null;P.setAttr(w,"data-normalsize",'{"width":'+normalSize.width+',"height":'+normalSize.height+"}")}if(typeof normalSize=="string"){normalSize=JSON.parse(normalSize)}w.style.height=normalSize.height+"px";w.style.width=normalSize.width+"px";if(!P.getAttr(w,"data-size")){P.setAttr(w,"data-size",'{"width":"'+ie6Width+'","height":"'+ie6Height+'"}')}}}t("larger")}else{if(x.indexOf(z)>-1){if(!P.hasClass(w,"pic-large-fix")){P.removeClass(w,z);P.addClass(w,A);if(P.ie6){ie6Obj=JSON.parse(P.getAttr(w,"data-size"));w.style.height=ie6Obj.height;w.style.width=ie6Obj.width}}t("smaller")}}};var f=function(s){var t=P.q("more-link-arcitle",this.el)[0];var u=this;t&&P.on(t,"click",function(w){g.call(u);P.preventDefault(w)});P.on(this.el,"click",j);var v=m("tracking/trackmanager");v.spaceArticle(this.el)};var h=function(){if(b<2){if(P.isInView(P.q("more-link-arcitle",this.el)[0])&&this.model.__more){g.call(this);c=setTimeout(o,2000);b++}else{c=setTimeout(o,1000)}}};var p=function(s){if(s.getmore){if(!c){c=setTimeout((o=h.bind(this)),1000)}}else{clearTimeout(c);c=null}};var r=function(t){var s=P.q("article-more",this.el)[0];s&&P.removeClass(s,"loading");if(!t.hasMore){if(this.model.getPn()>1){P.addClass(s,"nomore")}}n.call(this)};var d=function(){var s=P.q("article-more",this.el)[0];P.addClass(s,"none")};var n=function(){var s=P.q("article-item",this.el);P.each(s,function(t){if(P.getAttr(t,"data-bind")==1){return}else{P.on(t,"mouseover",function(){P.addClass(t,"item-over")});P.on(t,"mouseout",function(){P.removeClass(t,"item-over")});P.setAttr(t,"data-bind",1)}})};var a=function(s,t){this.model=s;this.el=t;this.init();this.addEventListener("update:viewready",f.bind(this));this.model.addEventListener("update:getmore",p.bind(this));this.model.addEventListener("update:inserted",r.bind(this))};var l=a.prototype=P.extend(k);l.appendChildView=function(w){var s,t,u="mod-space-article",v="article-more";if(w.el&&P.getAncestorByClass(w.el,u)){return}else{s=this.el;t=P.q(v,this.el)[0];if(s&&t){s.insertBefore(w.el,t);w.setDomReady()}}};l.setData=function(s,t){s.feedPage=t;s.appendTo(this);if(this.isInDom){this.appendChildView(s);s.setDomReady()}};return a});F.module("space_article/spacearticlecontentmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;if(g&&typeof g.init=="function"){g.init.call(this)}}var b=a.prototype=P.extend(c);return a});F.module("space_album/spacealbumview",function(c,e){var b=c("base/view");var d=function(g){if("photoIdList" in App.router.global&&App.router.global.photoIdList.length>0){F.use("space_album/space_album",function(j){var k=this.el;j.init(k)})}else{this.model.remove();this.remove()}var h=c("tracking/trackmanager");h.spaceAlbum(this.el)};var f=function(g,h){this.model=g;this.el=h;this.init();this.addEventListener("update:viewready",d.bind(this))};var a=f.prototype=P.extend(b);return f});F.module("space_album/space_album",function(a,g){var q,o,s,c,n,e;var p=1,v=6,d=111,k=v*d;var l=function(){if(q){if(p==1){P.addClass(q,"leftdisable");P.removeClass(q,"goleft")}else{P.addClass(q,"goleft");P.removeClass(q,"leftdisable")}}if(o){if(p==e){P.removeClass(o,"goright");P.addClass(o,"rightdisable")}else{P.addClass(o,"goright");P.removeClass(o,"rightdisable")}}};var w=function(y){P.preventDefault(y);if(p==1){return}m((p-2)*k);p--;l()};var b=function(y){P.preventDefault(y);if(p>=e){return}m(p*k);p++;l()};var m=function(y){F.use("tangram_move/tangram_move",function(A){var C=s.scrollLeft;var z=y;var B=new baidu.fx.Timeline();B.render=function(D){s.scrollLeft=D*(z-C)+C};B.transition=function(D){return D*(2-D)};B.launch()})};var x=function(A){var z=P.getTarget(A);var y;if(P.hasAttr(z,"data-index")){y=P.getAttr(z,"data-index")|0}else{return}F.use("photo_slide/photo_slide",function(B){B.init();B.open(App.router.global.photoIdList,y)})};var t=function(){q&&P.on(q,"click",w);o&&P.on(o,"click",b);P.each(n,function(y){P.on(y,"click",x);if(P.ie6){P.on(y,"mouseover",f);P.on(y,"mouseout",j)}})};var f=function(z){var y=u(z);P.addClass(y,"item-hover")};var j=function(z){var y=u(z);P.removeClass(y,"item-hover")};var u=function(z){var y=P.getTarget(z);return(y.nodeName.toLowerCase()=="li")?y:y.parentNode};var r=function(){var y=e*k;c.style.width=y+"px"};var h=function(y){q=P.q("goleft",y)[0];o=P.q("goright",y)[0];s=P.q("album-box",y)[0];c=P.q("album-list",y)[0];n=P.q("image-item",y);e=Math.ceil(n.length/v);t();r()};g.init=h});F.module("ask_question/ask_question",function(a,b){var c=function(){window.fixedAsk=function(h){h=h.data;var g="";if(h.ifLogin==0){dialog=a("dialog/dialogmanager");dialog.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}if(h.replyLimit==0){g="因权限设置，此用户暂时无法接收提问求助。<br>您可以换一位用户试试。"}if(g===""){src=App.router.global.domain.zhidao+"/new";var f=P.createNode("form",{target:"_self",action:src,method:"get"});var k={fix:App.router.global.page_userInfo.username,ct:"17",tn:"ikask",cm:"1",lm:"394496",em:App.router.global.page_userInfo.username},d,j,e;for(e in k){if(k.hasOwnProperty(e)){j=k[e];d=P.createNode("input",{name:e,value:j});f.appendChild(d)}}document.body.appendChild(f);f.submit()}else{F.use("dialog/dialogmanager",function(l){l.alert(g,{btnConfirm:'<a href="#" onclick="return false;" class="dialog-ok" data-click="ok">知道了</a>',cntClass:"cnt-normal",cnsClass:"cns-one",cntAlignClass:"cnt-left"})})}};P.callBySrv(App.router.global.domain.zhidao+"/iask/api/ikhelplimit?un="+App.router.global.page_userInfo.username_gbk_path+"&callback=fixedAsk")};b.ask=c});F.module("right_nav/right_nav",function(m,d){var k=m("base/view");var a;var g=function(){P.removeClass(a,"nav-narrow")};var c=function(){P.addClass(a,"nav-narrow")};var h=function(){a.style.display="block";var o=P.getViewWidth();if(o<1024){c()}else{g()}};var j=function(){P.on(a,"mouseover",function(){g()});P.on(a,"mouseout",function(){h()});P.on(window,"resize",function(){h()});if(P.ie6){var o=function(){var p=P.getScrollTop(),q=parseInt(a.style.top)|0;if(p+241==q){setTimeout(o,500);return}F.use("tangram_move/tangram_move",function(){var r=new baidu.fx.Timeline();r.render=function(t){var s=(p+241-q)*t+q;a.style.top=s+"px"};r.transition=function(s){return s*(2-s)};r.finish=function(){setTimeout(o,500)};r.launch()})};o()}};var f=function(){a=P.g("navhld");h();j();n();var o=m("tracking/trackmanager");o.rightNav(this.el)};var n=function(){var p=P.q("mod-go-top-btn")[0];var o=function(){b(function(){var s=P.getScrollTop();var q=P.getWidth();if(s>200&&q>980+75*2){var r=P.getHeight()-s-P.getViewHeight();if(r<77||P.ie6){p.style.display="none";P.setStyles(p,{position:"absolute",bottom:(r<77?77:r)+"px",right:((P.getWidth()-980)/2-75)+"px"});if(P.ie6){setTimeout(function(){p.style.display="block"},300)}else{p.style.display="block"}}else{P.setStyles(p,{position:"fixed",bottom:"5px",right:((P.getWidth()-980)/2-75)+"px",display:"block"})}}else{if(P.ie6){setTimeout(function(){p.style.display="none"},300)}else{p.style.display="none"}}})};if(p){P.on(p,"mouseover",function(){F.use("tangram_move/tangram_move")});P.on(p,"click",function(){F.use("tangram_move/tangram_move",function(){var r=P.getScrollTop(),q=P.getScrollLeft();var s=new baidu.fx.Timeline();s.render=function(t){window.scrollTo(q,r*(1-t))};s.transition=function(t){return t*(2-t)};s.launch()})});o()}};var b=function(p){var o=false;P.on(window,"scroll",function(){if(!o){o=true;p&&p();o=false}})};function e(o,p){this.model=o;this.el=p;this.init();this.addEventListener("update:viewready",f.bind(this))}var l=e.prototype=P.extend(k);return e});F.module("basecomponent/databindfn/value",function(a,c){var e=a("base/base");function j(k,n,l,m){if(!l.val){l.val=[]}if(typeof l.types["val"]==="undefined"){l.types["val"]=0}n[k]=m;l[m]=k;l.val.push(m);l.types["val"]++}function d(n,m,l,k){if(!k){n.value=l}}function g(l,k){var m=100,p,n;function o(){f(l,k,n);p=null;n=null}return function(q){if(!p){p=setTimeout(o,m);n=e.getTarget(q)}}}function f(l,k,m){l.updateAttr(k,m.value,true)}function b(n,o,l,m,k){e.on(n,"keydown",g(k,l));n.value=m}function h(m,l){var n=m.value,k=false;if(e.array.indexOf(l.val,n)>-1){l[n+"ele"]=m;k=true}return k}c.extension={typesProcessor:{val:j},updatePropertyFunction:{val:d},bindObjActions:{val:b},validators:{val:h}}});F.module("basecomponent/template",function(d,g){var h=d("base/base"),c={};function b(m){var l=m.childNodes;for(i=0,len=l.length;l[i].nodeType!=1;i++){}if(i===len){return m}return l[i]}function e(l){var m=self.document;return m.getElementById(l).innerHTML}function j(m){var l=document.createElement("div");l.innerHTML=m;return b(l)}function f(l,m){return j(a(l,m))}function a(m,n){var o,l;if(!c[m]){c[m]=e(m)}l=c[m];o=h.format(l,n||"");return o}function k(m,l){if(c[m]){throw"template already exists";return}c[m]=l;return this}g.generateHtmlStr=a;g.generateHtml=f;g.loadTmpl=k});F.module("basecomponent/model",function(c,b){var e=c("base/base"),d;function a(m,g,j,p){var h,k,n,l={create:"POST",read:"GET",update:"PUT","delete":"DELETE"}[m.toLowerCase()];if(!l){return}if(p){h=p.context||null;k=p.requestData||null}n={url:g,method:l};if(k){n.data=k}function o(q){j.call(h,q)}e.remote.request(n,o)}function f(){}d=e.event(f.prototype);d.__prop={_default:{set:function(h,g){this[g]=h;this.dispatchEvent("change:"+g,{data:this[g]});return this},get:function(g){return this[g]}}};d._sendRequest=function(h,g){var j=g||{};e.extend(j,this.getRequestUserInfo());a(h,this.url,this.requestHandler,{context:this,requestData:j})};d._alarmError=function(g){this.dispatchEvent("error",{errNo:g})};d.destory=function(){this.dispatchEvent("destory");this.dispose()};d.updateAttr=function(g,j){var h=g;if(!this.__prop[g]){h="_default"}else{if(!(typeof this.__prop[g].set=="function")){h="_default"}}return this.__prop[h].set.call(this,j,g)};d.getAttr=function(g){var h=g;if(!this.__prop[g]){h="_default"}else{if(!(typeof this.__prop[g].get=="function")){h="_default"}}return this.__prop[h].get.call(this,g)};d._defineProp=function(h,j){var g;if(!this.__hasProp){this.__hasProp=true;g=this.__prop._default;this.__prop={_default:g}}this.__prop[h]=j};d.getRequestUserInfo=e.empty;d.init=e.empty;d.requestHandler=e.empty;return f},["base/base"]);F.module("basecomponent/broadcast",function(b,a){var d=b("base/base"),c={};d.event(c);return{on:function(f,g,e){if(e){}else{c.addEventListener(f,g)}},emit:function(e,f){c.dispatchEvent(e,f)}}});F.module("basecomponent/controller",function(b,a){var d=b("base/base"),c;function e(){}c=d.event(e.prototype);c._render=function(g){var f=this.tmplId;this.el=this.tmplHelper.generateHtml(f,g);this._rendered=true};c.destory=function(){if(this.el&&this.__isInDom){this.el.parentNode.removeChild(this.el)}this.dispatchEvent("destory");this.dispose()};c.appendToDom=function(h,g){var f;if(!this._rendered){this._render()}if(h.appendChild){f=h}else{if((typeof h=="string")&&(f=d.g(h))){}else{return}}if(g){f.insertBefore(this.el,g)}else{f.appendChild(this.el)}if(!this.__isInDom){this.dispatchEvent("viewready");this.__isInDom=true}f=null;h=null};c.insertToDomBefore=function(h,f){var g;if(f.nodeType===1){g=f}else{if((typeof f=="string")&&(g=d.g(f))){}else{return}}return this.appendToDom(h,g)};c._refreshPosition=function(){this.pos=d.getPosition(this.el)};c.init=d.empty;return e});F.module("basecomponent/databind",function(j,w){var f=j("base/base"),q,x=1000000,l='<span id="#{0}">#{1}</span>',p='<div id="#{0}">#{1}</div>',u,o,t,n,v,m="_attr",g="_prop";q={cls:function(y,B,z,A){B[y]=A;z[A]=y;z.cls.push(A);z.types["cls"]++},txt:function(y,C,A,B){var z=C[y];C[y]=z=f.format(l,B,z);A[B]=y;A.txt.push(B);A.types["txt"]++},blk:function(y,C,A,B){var z=C[y];C[y]=z=f.format(p,B,z);A[B]=y;A.blk.push(B);A.types["blk"]++}};o={updateAttr:function(y,A,z){this[g][y].set.call(this,A,z);return this},getAttr:function(y){return this[g][y].get.call(this)}};u={cls:function(A,z,y){f.removeClass(A,z);f.addClass(A,y)},txt:function(A,z,y){A.innerText=y},blk:function(A,z,y){A.innerHTML=y}};t={txt:function(z,y){return t.blk(z,y,"txt")},blk:function(B,A,z){var C=B.id,y=false;z=z||"blk";if(f.array.indexOf(A[z],C)>-1){A[C+"ele"]=B;y=true}return y},cls:function(D,C){var A,B,z,y=false;if((z=c(D.className,C.cls))>-1){B=C.cls[z];C[B+"ele"]=D;y=true}return y}};n={validate:function(C,B){var z,A,y=false;for(z in t){A=t[z];y=A(C,B);if(y){break}}return y}};v={cls:function(B,C,z,A,y){f.removeClass(B,C);f.addClass(B,A)}};function d(){return"db"+x++}function h(z){var y=z.childNodes;for(i=0,len=y.length;y[i].nodeType!=1;i++){}if(i===len){return z}return y[i]}function s(z){var y=document.createElement("div");y.innerHTML=z;return h(y)}function c(C,A){var z=-1,B=C.split(/\s+/),D,y=B.length;while(y--){D=B[y];if(D!==""){z=f.array.indexOf(A,D)}if(z!=-1){break}}return z}function k(z,D){var B,C,A,y;if(z.nodeType==1){n.validate(z,D);for(A=0,y=z.childNodes.length;A<y;A++){k(z.childNodes[A],D)}}}function b(z,A,y){return{get:function(){return this[m][y]},set:function(D,B){var C=this[m][y];if(D!=C){u[z](A,C,D,B);this[m][y]=D}}}}function a(D,C,A){var E,B,y,H,z,I,G;H=A[m]=A[m]||{};prop=A[g]=A[g]||{};for(type in D.types){if(!type){continue}B=D[type];E=B.length;while(E--){z=B[E];y=D[z];I=C[y];H[y]=I;G=D[z+"ele"];if(typeof v[type]==="function"){v[type](G,z,y,I,A)}prop[y]=b(type,G,y)}}f.extend(A,o)}function r(z,B,C){var G,A=B.config,E=f.extend({},B.value),H,y,I,D={types:{cls:0,blk:0,txt:0},cls:[],blk:[],txt:[]};if(!A||!B.value){return}for(name in A){H=A[name];if(q[H]){q[H](name,E,D,d())}}y=f.format(z,E);I=s(y);k(I,D);a(D,B.value,C);for(name in D){delete D[name]}for(name in E){delete E[name]}D=null;E=null;return I}function e(y){f.extend(q,y.typesProcessor);f.extend(u,y.updatePropertyFunction);f.extend(v,y.bindObjActions);f.extend(t,y.validators);f.extend(o,y.updateMethod)}w.databind=r;w.extend=e});F.module("timeline/timelinegroup/controller",function(c,g){var h=c("base/base"),e=c("basecomponent/controller"),j,k,l={recent:"至今"},a="tlg-loading";function d(o){var p=o+"",m=p.substring(0,4),n=p.substring(4,6);return l[o]||m+"-"+n}function b(m,n){var o={tmplId:"timelinecattmpl",group:"recent",total:0};if(!m){return}h.extend(o,n);this.tmplId=o.tmplId;this.tmplHelper=m;this.leftRecordsHeight=0;this.rightRecordsHeight=0;this.leftArrPos=0;this.rightArrPos=0;this.group=o.group;this._hasData=false;this._remain=false;this._total=o.total;this._loading=false;this._fixedOri=false;this._recordCntrols=[];this.init();this._defaultOri=0;this._render({title:d(o.group),id:this.group});this.addEventListener("viewready",function(){this.__plzhld=h.q("timeline-main",this.el)[0];this._refreshPosition()})}j=h.createClass(b,{superClass:e});k=j.prototype;k.init=function(){var m=this,n;n={recordDestoried:{act:function(o){var p;p=h.array.indexOf(m._recordCntrols,o);m._recordCntrols.splice(p,1);n.relayoutGroup.act()}},relayoutGroup:{act:function(){var r=0,o=m._recordCntrols.length,q=m._recordCntrols,p;while(o--){p=q[o];if(p.el){p.el.parentNode.removeChild(p.el)}}m.leftRecordsHeight=0;m.rightRecordsHeight=0;m.leftArrPos=0;m.rightArrPos=0;for(o=q.length;r<o;r++){p=q[r];if(p.el){f(m,p)}}}}};this.eventHandlers={recordDestoried:function(){n.recordDestoried.act(this)},click:function(o){var r=h.getTarget(o),q="cat-morelink",s="cat-remain",p=h.hasClass(r,q)||h.hasClass(r,s);if(p){m._loading=true;h.addClass(m.el,a);m.dispatchEvent("loadData",{data:m.group});h.preventDefault(o)}},refreshLayout:function(o){m.dispatchEvent("refreshgroup",{data:m.group})}};this.addEventListener("viewready",function(o){this._bindInteractEvents()})};k.setDefaultOri=function(m){this._defaultOri=m=="right"?1:0;return this};k.setFixedOri=function(m){this._fixedOri=m=="left"?"left":"right";return this};function f(q,o){var p="left-col",w="right-col",s="notready",m="downoff",x,n,t,v,u,r=["left","right"];o.appendToDom(q.__plzhld);if(q._fixedOri){n=q._fixedOri}else{if(q._recordCntrols.length==0){n=r[q._defaultOri]}else{n=q.leftRecordsHeight>q.rightRecordsHeight?"right":"left"}}x=o.el.offsetHeight;o.reset();if(n=="right"){h.addClass(o.el,w);o.side="right";t=q.leftArrPos}else{h.addClass(o.el,p);o.side="left";t=q.rightArrPos}h.removeClass(o.el,s);v=q[n+"RecordsHeight"]+13;u=v-t;if(0<=u&&u<13){h.addClass(o.el,m);v+=13}q[n+"RecordsHeight"]+=x+20;q[n+"ArrPos"]=v}k.appendNewRecord=function(m){if(typeof m.appendToDom!=="function"){return}if(!this._hasData){this._hasData=true;h.removeClass(this.el,"getmore")}if(this._loading){this._loading=false;h.removeClass(this.el,a)}m.addEventListener("destory",this.eventHandlers.recordDestoried);m.addEventListener("refreshlayout",this.eventHandlers.refreshLayout);f(this,m);this._recordCntrols.push(m);if(this._recordCntrols.length<this._total){if(!this._remain){h.addClass(this.el,"remain");this._remain=true}}else{h.removeClass(this.el,"remain");this._remain=false;this.dispatchEvent("alldataloaded",{data:this.group})}};k.checkIsInView=function(){if(h.isInView(this.el)){this.setLoading(true);this.dispatchEvent("loadData",{data:this.group})}};k._bindInteractEvents=function(){h.on(this.el,"click",this.eventHandlers.click)};k.getTotalRecordsNum=function(){return this._recordCntrols.length};k.handleException=function(){this._loading=false;h.removeClass(this.el,a)};k.setLoading=function(m){if(m){h.addClass(this.el,a)}else{h.removeClass(this.el,a)}};return j});F.module("timeline/timelinerecord/model",function(b,a){var c,d=b("base/base"),e=b("basecomponent/model"),g;function f(h){var k={url:"/p/timeline/"},j=h.requestUserInfo;d.extend(k,h);this.id=k.id||"tlrecord"+d.getGuid();this.url=k.url+this.id;this.group=k.group;this.time=k.time;this.type=k.type;this.data=k.data;this.groupAlias=k.groupAlias;this.getRequestUserInfo=function(l){return j}}g=d.createClass(f,{superClass:e});c=g.prototype;c.deleteRecord=function(){this._sendRequest("delete");return this};c.updateRecord=function(h){this._sendRequest("update",h);return this};c.loadRecord=function(){this._sendRequest("read");return this};c.requestHandler=function(j){var h=JSON.parse(j);if(h.errNo){this._alarmError(h.errNo)}else{if(h.action=="delete"){this.dispatchEvent("change:deleted",{data:h});this.destory()}else{if(h.action=="update"){this.dispatchEvent("update",{data:h})}}}return this};return g});F.module("timeline/timelinerecord/controller",function(b,d){var h,e=b("base/base"),c=b("basecomponent/controller"),j=b("timeline/model"),g,k=c.prototype,f={title:'<div class="rec-title-cnt"><span class="rec-title-txt">#{title}</span><a href="#{fromUrl}" class="rec-title-from" target="_blank">#{from}</a></div>'};function a(o,l,n){var q={tmplId:"timelinerectmpl"},p=this,m;if(!o||!l){return}e.extend(q,n);this.tmplId=q.tmplId;this.model=o;this.tmplHelper=l;this.side="";this.init()}g=e.createClass(a,{superClass:c});h=g.prototype;h.init=function(){var l=this,m;m={recordInit:{act:function(){l._render({titleCnt:e.format(f.title,{title:e.trim(l.model.data.title),from:l.model.data.from,fromUrl:l.model.data.fromUrl}),time:l._getTime(),cnt:l.model.data.cnt})}},mouseover:{orientation:null,evtType:null,timer:null,tick:80,act:function(n){if(!this.orientation){this.orientation=e.hasClass(l.el,"left-col")?"left":"right"}if(n!=this.evtType){if(!this.timer){this.timer=setTimeout(m.mouseover.timeoutHandler,this.tick)}this.evtType=n}},done:function(){var n="tlr-enter-"+this.orientation;if(this.evtType=="mouseover"){e.addClass(l.el,"tlr-enter "+n)}else{e.removeClass(l.el,"tlr-enter "+n)}this.timer=null},timeoutHandler:function(){m.mouseover.done()}}};if(this.model.data){m.recordInit.act()}this.eventHandlers={mouseover:function(n){var o=n.type;m.mouseover.act(o)}};this.addEventListener("viewready",this._viewReady)};h._bindInteractEvents=function(){var l;if(e.ie6){e.on(this.el,"mouseover",this.eventHandlers.mouseover);e.on(this.el,"mouseout",this.eventHandlers.mouseover)}};h._viewReady=function(){var m,l;this._bindInteractEvents();m=e.q("pic-img",this.el);if(m.length==1){this._bindRefreshEventOnlyForXiangce(m[0])}m=null};h._bindRefreshEventOnlyForXiangce=function(m){var l=this;m.onload=function(n){this.onload=null;l.dispatchEvent("refreshlayout");l=null}};h._bindEvents=function(){};h.reset=function(){if(!this._rendered){return}if(this.side){e.removeClass(this.el,"left-col right-col downoff")}e.addClass(this.el,"notready")};h._getTime=function(){var l=this.model.time,m="";if(l){l=parseInt(l,10);if(l>10000000){l=l%10000;m=Math.round(l/100)+"-";m+=l%100;l=m}else{throw"timelinerec model time format is not valid"}}return l||null};return g});F.module("timeline/controller",function(g,t){var f,e=g("base/base"),v=g("basecomponent/controller"),q=g("timeline/model"),m=g("timeline/timelinerecord/controller"),l=g("basecomponent/broadcast"),u=g("timeline/timelinegroup/controller"),h,s=v.prototype,o='<div class="timeline-year-ind clearfix" id="#{id}">                            <div class="overlayer clearfix">                                <span class="year-label">#{yr}年</span><span class="ind-arr"></span>                            </div>                        </div>';function b(y){var A=this._availableGroup,x,w,z;for(x=y+1,w=A.length;x<w;x++){z=A[x]["group"];if(this._groupContainer[z]){break}}if(x>=w){return -1}return z}function p(w){var w,x;if(!this._fiveYearLoaded){e.addClass(this.el,"fiveyearcontent");this._fiveYearLoaded=true}}function r(w){l.emit("timelineScrollAnimationStatusUpdated",{data:w});this._scorllingAnimate=false}function d(A,y){var x=new baidu.fx.Timeline(),z,w;if(e.ie||baidu.browser.isGecko){w="documentElement"}else{w="body"}z=document[w].scrollTop;if(z==A){return}x.render=function(C){var B;if(z>A){B=z-Math.round((z-A)*C)}else{B=z+Math.round((A-z)*C)}document[w].scrollTop=B};x.transition=function(B){return B*(2-B)};x.finish=r.bind(this,y);x.launch();if(this._scrollToGroup){this._scrollToGroup=null}this._scorllingAnimate=true;l.emit("timelineScrollAnimationStatusUpdated",{data:"started"})}function a(z,y){var A=z.group.toString().substring(0,4),w=y.toString().substring(0,4),x=this._groupContainer[y].el;if(A!==w){x=x.previousSibling}z.insertToDomBefore(e.g("timelinemain"),x)}function n(H){var x=[],C=this._availableGroup,A,B,G,z,E,w,D,y;H=parseInt(H,10);for(A=0,B=C.length;A<B;A++){if(C[A]["group"]==H){if(A>0){z=C[A-1]["group"]}if(A<B-1){E=C[A+1]["group"]}break}}if(z&&!this._groupContainer[z]){x.push(z)}if(H&&!this._groupContainer[H]){x.push(H)}if(E&&!this._groupContainer[E]){x.push(E)}if(!this._fiveYearLoaded){p.call(this,C[C.length-1]["group"].toString().substring(0,4))}G=b.call(this,A);for(A=0,B=x.length;A<B;A++){w=x[A];groupContainer=new u(this.tmplHelper,{total:this._availableGroupMap[w],group:w});groupContainer.setFixedOri("right");if(w==z&&this._groupContainer[H]){a.call(this,groupContainer,H)}else{if(G!=-1){a.call(this,groupContainer,G)}else{groupContainer.appendToDom(e.g("timelinemain"))}}D=w.toString().substring(0,4);if(!this._createdYear[D]){y=e.createNode("div",{"class":"timeline-cat separate"});y.innerHTML=e.format(o,{yr:D,id:"yearind"+D});e.g("timelinemain").insertBefore(y,groupContainer.el);groupContainer._refreshPosition();this._createdYear[D]=true;y=null}this._groups++;this._groupContainer[w]=groupContainer;groupContainer.addEventListener("loadData",this.eventHandlers.clickLoadData);groupContainer.addEventListener("refreshgroup",this.eventHandlers.refreshGroupPosition)}}function c(y,w,x){var z={tmplId:"timelinetmpl",tmplsId:{cateTmpl:"timelinecattmpl"}};if(!y||!w){return}e.extend(z,x);this.tmplId=z.tmplId;this.model=y;this.tmplHelper=w;this.tmplsId=e.extend({},z.tmplsId);this._groupContainer={};this._groups=0;this._notFullyLoadedGroups;this._notFullyLoadedGroupsNum=0;this._notFullyLoadedGroupsMap={};this._asyncLoadTimes=0;this._createdYear={};this._dataInit=false;this.init()}h=e.createClass(c,{superClass:v});f=h.prototype;function j(y){var x=this._availableGroupMap[y],w=0;if(this.model.records[y]){w=this.model.records[y].length||0}if(w>=x){this._groupContainer[y].setLoading(true);return true}return false}function k(E){var C,y,w,z,B,A,D=1,x;if(this._dataInit&&!j.call(this,E)){if(!this._availableGroupMap[E]<10&&!this.model.records[E]){w=this._availableGroupMap;C=this._availableGroup;x=[E];A=w[E];for(z=0,B=C.length;z<B;z++){if(C[z]["group"]==E){z++;break}}for(;z<B;z++){y=C[z]["group"];if(this._groupContainer[y]){continue}x.push(y);A+=w[y];D++;if(A>10||D>2){break}}this.model.loadRecords(x)}else{this.model.loadRecords(E)}this._asyncLoadTimes++}}f.init=function(){var w=this,x;x={scroll:{timer:null,tick:100,loading:false,isScrollOver:false,prePosTop:0,preGroupPos:-1,act:function(y){if(!this.timer){this.timer=setTimeout(this.timeoutHandler,this.tick)}},done:function(){var H=e.g("nextnewtimelinecat"),A,C,G,z=w._notFullyLoadedGroups,y=e.getScrollTop(),E=(y-this.prePosTop>0),D=w._availableGroup,B=80;this.timer=null;if(!this.isScrollOver&&y+10>=w.pos.top){this.isScrollOver=true;w.dispatchEvent("timelineScrollOver",{data:this.isScrollOver})}else{if(this.isScrollOver&&y+10<w.pos.top){this.isScrollOver=false;w.dispatchEvent("timelineScrollOver",{data:this.isScrollOver})}}if(w._scorllingAnimate){return}if(D&&D.length){A=G=this.preGroupPos;C=D.length;if(A<0){}else{if(E){if(y<D[0]["top"]){G=0}else{while(A<C){if(!D[A]["top"]||(y>D[A]["top"]-B)){A++}else{break}}G=A-1}}else{while(A>0){if(!D[A]["top"]||y<D[A]["top"]-B){A--}else{break}}G=A}}if(G<0){G=0}if(G>C-1){G=C-1}if(G!=this.preGroupPos){w.dispatchEvent("switchgroup",{data:D[G]["group"]})}if((E&&G<C-1)||(!E&&G>0)){w.dispatchEvent("scrolling",{data:{groupPos:G,scrollDown:E}})}else{w.dispatchEvent("scrolling",{data:{group:w._availableGroup[G]["group"]}})}this.preGroupPos=G}if(w._notFullyLoadedGroupsNum>0){for(A=0,C=z.length;A<C;A++){if(z[A]){z[A].checkIsInView()}}}this.prePosTop=y},timeoutHandler:function(){x.scroll.done()}},recordDestoried:{act:function(y){}},updateLoadingState:function(){if(!w._dataReady){e.removeClass(w.el,"init-loading");w._dataReady=true}},navReady:{act:function(){var y;w.setInit();if(y=w._availableGroup[0]){k.call(w,y.group)}else{x.updateLoadingState()}}},scrolling:{curYear:"",act:function(A){var y,z;if(e.ie6){return}y=A.toString().substring(0,4);if(A===false&&this.curYear){e.removeClass(e.g("yearind"+this.curYear),"fixed");this.curYear=""}else{if(this.curYear!==y&&w._isScrollOver){if(this.curYear){e.removeClass(e.g("yearind"+this.curYear),"fixed")}z=e.g("yearind"+y);if(z){e.addClass(z,"fixed");this.curYear=y}}}}},scrollingLoading:{tried:{},act:function(A){var E=A.data.groupPos,z=A.data.scrollDown,D,B,y=w._availableGroup.length,C=1;D=w._availableGroup[E]["group"];if(z){while(E++<y-1){B=w._availableGroup[E]["group"];if(C++>3){break}if(this.tried[B]){continue}if(!w._groupContainer[B]||!w._groupContainer[B]._hasData){k.call(w,B);this.tried[B]=true;break}}}else{B=w._availableGroup[E-1]["group"];k.call(w,B);this.tried[B]=true}}}};this.eventHandlers={scroll:function(y){x.scroll.act(y)},getRest:function(z){var y=e.getTarget(z);e.preventDefault(z);e.removeClass(w.el,"showrest");w._showGetRestOnce=false;l.emit("getresttriggered");e.un(y,"click",w.eventHandlers.getRest)},navUpdated:function(D){var I=D.data,G=w._availableGroup,y=w._availableGroupMap,H,E,K,B,J,A=G.length,C,z;for(H in I){K=I[H];for(E in K){B=K[E];if(B){J=H*100+(E-0);y[J]=B;G.push({group:J,num:B})}}}G.sort(function(M,L){return L.group-M.group});z=w._groupsRenderStartFromRight;for(C=G.length;A<C;A++){if(G[A-1]["num"]==1&&G[A]["num"]==1&&e.array.indexOf(z,G[A-1]["group"])==-1){z.push(G[A]["group"])}}if(w._showGetRestOnce){e.fire(e.g("getrestyearsdata"),"click")}G.sort(function(M,L){return L.group-M.group})},updateRegDate:function(E){var B,C,z,A,D,y,G;w._regDate=E.data;B=e.g("joinbaiducnt");C=B.innerHTML;z=w._regDate.toString();A=z.toString().substring(0,4)+"年";G="注册了百度帐号";B.innerHTML=A+App.router.global.page_userInfo.sexTitle+G},dataloaded:function(I){var N=I.data,E,D,G,z,O,K,A,C,B,M,L,H=true,J=w._availableGroup,y=w._availableGroupMap;if(!N.length){return}x.updateLoadingState();if(w._noInitContent){e.removeClass(w.el,"noinitcontent")}e.addClass(w.el,"tl-appending");for(K=0,A=N.length;K<A;K++){O=N[K]["group"];if(!C){C=O;if(O==w._scrollToGroup){H=false}}D=N[K]["offset"];G=w.model.records[O].length;n.call(w,O);for(;D<G;D++){E=w.model.records[O][D];z=new m(E,w.tmplHelper);w._groupContainer[O].appendNewRecord(z)}if(w._groupContainer[O]._recordCntrols.length<y[O]){if(!w._notFullyLoadedGroups){w._notFullyLoadedGroups=[]}L=w._notFullyLoadedGroupsMap[O]||w._notFullyLoadedGroups.length;w._notFullyLoadedGroups[L]=w._groupContainer[O];w._notFullyLoadedGroupsMap[O]=L;w._groupContainer[O].addEventListener("alldataloaded",w.eventHandlers.groupAllDataLoaded);w._notFullyLoadedGroupsNum++}}for(D=0,G=J.length;D<G;D++){if(J[D]["group"].toString()==C){B=D;break}}for(;B<G;B++){O=J[B]["group"];if(w._groupContainer[O]){w._groupContainer[O]._refreshPosition();J[B].top=w._groupContainer[O].pos.top}}if(x.scroll.loading){x.scroll.loading=false}e.removeClass(w.el,"tl-appending");w.navigateTo(C,true,H)},dataloading:function(y){x.scroll.loading=true},groupAllDataLoaded:function(z){var y=z.data,A=w._notFullyLoadedGroupsMap[y];w._notFullyLoadedGroups[A]=null;w._groupContainer[y].removeEventListener("loadData",w.eventHandlers.clickLoadData);w._groupContainer[y].removeEventListener("alldataloaded",w.eventHandlers.groupAllDataLoaded);w._notFullyLoadedGroupsNum--},destory:function(y){w.destory()},handleError:function(y){},navigateTo:function(A){var y=A.data,z=y.month;if(y.month-0<10){z="0"+z}w.navigateTo(y.year+z)},navReady:function(E){var J=E.data,I,G,L,B,C=9999,H=[],y={},z=[],A,D,K,M;for(I in J){if(I<C){C=I}for(G in J[I]){if(J[I][G]){L=(I*100)+(G-0);B=J[I][G];H.push({group:L,num:B});y[L]=B}}}H.sort(function(O,N){return N.group-O.group});for(A=1,D=H.length;A<D;A++){if(H[A-1]["num"]==1&&H[A]["num"]==1&&e.array.indexOf(z,H[A-1]["group"])==-1){z.push(H[A]["group"])}}w._availableGroup=H;w._availableGroupMap=y;if(w._availableGroup.length==0){e.addClass(w.el,"noinitcontent");w._noInitContent=true;p.call(w,C)}w._groupsRenderStartFromRight=z;x.navReady.act()},recordDestoried:function(y){},clickLoadData:function(z){var y=z.data;k.call(w,y)},hideGetRestBtn:function(y){e.removeClass(w.el,"showrest");w._showGetRestOnce=false},handleException:function(z){var y=z.data;if(w._groupContainer[y]){w._groupContainer[y].handleException()}},switchGroup:function(y){},scrolling:function(y){if(y.data===false||y.data.group){x.scrolling.act(y.data.group||y.data)}else{x.scrolling.act(this._availableGroup[y.data.groupPos]["group"]);x.scrollingLoading.act(y)}},refreshGroupPosition:function(z){var B=z.data,A=0,C,y=w._availableGroup.length;while(A<y&&(w._availableGroup[A++]["group"]!==B)){}if(A==y){return}for(A=A-1;A<y;A++){C=w._availableGroup[A]["group"];if(w._groupContainer[C]){w._groupContainer[C]._refreshPosition();w._availableGroup[A].top=w._groupContainer[C].pos.top}}}};this.addEventListener("viewready",function(y){this._bindInteractEvents();this.pos=e.getPosition(this.el)});this._bindEvents();this._bindBroadcast()};f._bindInteractEvents=function(){var w=this.el;e.on(window,"scroll",this.eventHandlers.scroll)};f._bindEvents=function(){this.model.addEventListener("change:records",this.eventHandlers.dataloaded);this.model.addEventListener("loading",this.eventHandlers.dataloading);this.model.addEventListener("destory",this.eventHandlers.destory);this.model.addEventListener("error",this.eventHandlers.handleError);this.model.addEventListener("exception:records",this.eventHandlers.handleException);this.addEventListener("timelineScrollOver",function(w){var x=w.data;if(this._isScrollOver){this.eventHandlers.scrolling({data:false})}this._isScrollOver=x});this.addEventListener("timelineScrollOver",function(w){var x=w.data;l.emit("timelineScrollOver",{data:{isScrollOver:x}})});this.addEventListener("switchgroup",this.eventHandlers.switchGroup);this.addEventListener("switchgroup",function(w){l.emit("timelinepositionchanged",{data:w.data})});this.addEventListener("scrolling",this.eventHandlers.scrolling)};f._bindBroadcast=function(){l.on("doNavigate",this.eventHandlers.navigateTo);l.on("timelinenavInit",this.eventHandlers.navReady);l.on("timelinenavupdated",this.eventHandlers.navUpdated);l.on("regdateready",this.eventHandlers.updateRegDate);l.on("timelinenavloadedall",this.eventHandlers.hideGetRestBtn)};f.navigateTo=function(z,w,x){var y;if(!this._groupContainer[z]){k.call(this,z);this._scrollToGroup=z}else{this._groupContainer[z]._refreshPosition();y=this._groupContainer[z].pos.top;if(w){if(this._asyncLoadTimes>0&&!x){d.call(this,y,z)}}else{if(!x){d.call(this,y,z)}k.call(this,z)}}};f.loadMoreRecords=function(){this.model.loadRecords()};f.setInit=function(){this._dataInit=true};return h},["basecomponent/controller","timeline/model","timeline/timelinerecord/controller"]);F.module("timeline/main",function(c,b){var h=c("timeline/model"),g=c("timeline/controller"),a=c("basecomponent/template"),d=c("tracking/trackmanager"),f,e;b.init=function(k,j){if(!e){e=new h({requestUserInfo:{portrait:App.router.global.page_userInfo.portrait},url:"/p/sys/data/time/timeline"})}if(!f){f=new g(e,a)}f.appendToDom(k);if(j){e.setData(j)}d.timeline(k)};b.load=function(j){if(!j){return}if(!e){setTimeout(arguments.callee.bind(null,j),500)}else{e.setData(j);f.setInit()}}});F.module("timeline/model",function(b,a){var c,e=b("base/base"),f=b("basecomponent/model"),d=b("timeline/timelinerecord/model"),h;function g(j){var l={url:"/p/timeline/"},k;e.extend(l,j);k=l.requestUserInfo;this.url=l.url;this.dataLoaded={};this.__totalRecords=0;this.records={};this._loadingRequest={};this.getRequestUserInfo=function(){return k};this.init()}h=e.createClass(g,{superClass:f});c=h.prototype;c.loadRecords=function(m){var k,j,o,l,n;if(e.isArray(m)){o=[];for(k=0,j=m.length;k<j;k++){l=m[k];if(!this._loadingRequest[l]&&!this.dataLoaded[l]){o.push(l);this._loadingRequest[l]=1}}if(!o.length){return}n=0;m=o.join("|")}else{if(this._loadingRequest[m]){return}this._loadingRequest[m]=1;n=m?(this.dataLoaded[m]?this.dataLoaded[m]["offset"]:0):this.__totalRecords}this._sendRequest("read",m?{category:m,offset:n}:{offset:n});this.dispatchEvent("loading");return this};c.createRecord=function(j){this._sendRequest("create",j);return this};c.requestHandler=function(k){var j=JSON.parse(k);if(j.errNo){this.handleErr(j.group)}else{setTimeout((function(){this.setData(j)}).bind(this),500)}return this};c.setData=function(n){var m=this.dataLoaded,k,j,p,o=[],l={};if(!n){return}while(k=n.shift()){p=k.group;if(this._loadingRequest[p]){this._loadingRequest[p]=0}if(k.errNo){this.handleErr(p);continue}j=new d(e.extend(k,{requestUserInfo:this.getRequestUserInfo()}));if(!this.records[p]){this.records[p]=[]}this.records[p].push(j);if(!m[p]){m[p]={offset:1};o.push({group:p,offset:0});l[p]=1}else{if(!l[p]){o.push({group:p,offset:m[p].offset});l[p]=1}m[p].offset++}this.__totalRecords++}this.dispatchEvent("change:records",{data:o})};c.handleErr=function(m){var k=m.split("|"),j=k.length,l;while(j--){l=k[j];if(this._loadingRequest[l]){this._loadingRequest[l]=0}this.dispatchEvent("exception:records",{data:l})}};return h});F.module("timelinenav/model",function(c,b){var d,e=c("base/base"),f=c("basecomponent/model"),a;function g(h){var j={url:"/p/timelinenav/"};e.extend(j,h);this.url=j.url;this.navInfo;this._timeIndicator;requestUserInfo=j.requestUserInfo;this._yearsLoaded={};this._loadingYear={};this.getRequestUserInfo=function(){return requestUserInfo};this.init()}a=e.createClass(g,{superClass:f});d=a.prototype;d._updateIndicator=function(o,r){var n="year",k="months",t="month",m="num",u=this._timeIndicator,h=this._preTimeIndicator,p=o.length,j,s,q,l=this._yearsLoaded;while(p--){j=o[p][k].length;s=o[p][n];u[s]={};if(h&&!h[s]){r.push({act:"addYear",year:s})}if(j==0){l[s]=false}else{l[s]=true}while(j--){q=o[p][k][j][t];u[s][q]=o[p][k][j][m];if(h&&h[s]){if(h[s][q]===undefined){r.push({act:"addMonth",year:s,value:q})}else{if(h[s][q]!==u[s][q]){r.push({act:"updateMonth",year:s,month:q})}}}}}};d.init=function(){this._defineProp("navInfo",{set:function(l){var k,m,h=[],j;if(!this._timeIndicator&&l){h.push({act:"init"});j="change:navInfo";this._timeIndicator={};this._updateIndicator(l)}else{this._preTimeIndicator=this._timeIndicator;this._timeIndicator={};this._updateIndicator(l,h);this._timeIndicator=e.extend({},this._preTimeIndicator,this._timeIndicator);for(k in this._preTimeIndicator){if(!this._timeIndicator[k]){h.push({act:"removeYear",year:k});continue}for(m in this._preTimeIndicator[k]){if(!this._timeIndicator[k][m]){h.push({act:"removeMonth",year:k,month:m})}}}j="update:navInfo"}this["navInfo"]=l;this.dispatchEvent(j,{data:h});return this}})};d.setNavData=function(h){this.updateAttr("navInfo",h)};d.loadNavData=function(j){var h=j?{category:j}:null;this._sendRequest("read",h);if(j){this._loadingYear[j]=true}return this};d.requestHandler=function(j){var h=JSON.parse(j);if(h.errNo){this._alarmError(h.errNo)}else{if(this.navInfo){this.addNavData(h)}else{this.setNavData(h)}}return this};d.checkIsYearLoaded=function(h){return this._loadingYear[h]==true||this._yearsLoaded[h]==true};d.addNavData=function(n){var m="year",t=this._timeIndicator,l=this._yearsLoaded,o,q,h,v,s,k,p,r,j,u;for(o=0,q=n.length;o<q;o++){v=n[o];s=v[m];if(this._loadingYear[s]){this._loadingYear[s]=false}if(t[s]){continue}if(!h){h=[]}this.navInfo.push(v);h.push({act:"addYear",year:s});n[o]=null;l[s]=true;u=true}if(u){this.dispatchEvent("update:navInfo",{data:h})}n=null};return a});F.module("timelinenav/controller",function(c,f){var h=c("base/base"),d=c("basecomponent/controller"),g=c("basecomponent/broadcast"),k,m,j=2012;function b(p,n,o){var q={tmplId:"timelinenavtmpl",childTmpls:{yearTmplId:"timelinenavyear",monthPanelTmplId:"timelinenavmpanel",monthTmplId:"timelinenavmonth"}};if(!p||!n){return}h.extend(q,o);this.model=p;this.tmplHelper=n;this.tmplId=q.tmplId;this.childTmpls=h.extend({},q.childTmpls);this.__hasData=false;this._availableDataInYear={};this.init()}k=h.createClass(b,{superClass:d});m=k.prototype;function e(t,s){var v,q=this._regDate,r,n,w,p,o,u;r=this.model.navInfo[this.model.navInfo.length-1]["year"];v=q.substring(0,4)-0;n=r-v;if(t){o=t.parentNode;u=o.parentNode;u.removeChild(o);while(n--){w=v+n;p=this.tmplHelper.generateHtml(this.childTmpls.yearTmplId,{cnt:"",year:w,yearAlias:w.toString()+"年",yearCls:""});u.appendChild(p)}u=null;o=null}if(s){n=r-v;while(n--){w=v+n;this.eventHandlers._loadAndNavigate(w)}}}function l(n){var p=h.g("timelinenavpanel"),q,o;if(p){q=p.firstChild;while(q){if(q.nodeType!=1||q.nodeName.toUpperCase()!="LI"||h.getAttr(q,"data-year")!=n){q=q.nextSibling}else{break}}}return q||null}function a(p,q){var o=p.firstChild,n;while(o.nodeType!=1||o.nodeName.toUpperCase()!="UL"){o=o.nextSibling}if(!o){return null}if(q.charAt(0)=="0"){q=q.substring(1,2)}n=o.firstChild;while(n){if(n.nodeType!=1||n.nodeName.toUpperCase()!="LI"||h.getAttr(n,"data-month")!=q){n=n.nextSibling}else{break}}return n}m.init=function(){var o,n=this;o={navInfoInit:{act:function(){var w=n.model,E,A,r="",y,z,D,u,t,x,q,s,v,C,B,p;n.setLastYear(w.navInfo[w.navInfo.length-1].year.toString());for(u=0,x=w.navInfo.length;u<x;u++){D="";s=0;E=w.navInfo[u];A=encodeURI(E.year);for(t=0,q=E.months.length;t<q;t++){y=E.months[t];if(!y.num){continue}z=encodeURI(E.months[t]["month"]);D+=n.tmplHelper.generateHtmlStr(n.childTmpls.monthTmplId,{month:z,year:A,monthAlias:z+"月"});if(!n._availableDataInYear[A]){n._availableDataInYear[A]=[]}n._availableDataInYear[A].push(z);s++}D=n.tmplHelper.generateHtmlStr(n.childTmpls.monthPanelTmplId,{cnt:D});r+=n.tmplHelper.generateHtmlStr(n.childTmpls.yearTmplId,{cnt:D,year:A,yearAlias:A+"年",yearLiCls:s?"":"norecord"});if(!v&&s){v=A}if(n._availableDataInYear[A]){n._availableDataInYear[A].sort(function(H,G){return G-H})}}if(n._regDate&&n._regDate.substring(0,4)!=w.navInfo[x-1]["year"]){r+=n.tmplHelper.generateHtmlStr(n.childTmpls.yearTmplId,{cnt:"",year:"getrest",yearAlias:"2000s",yearCls:""});p=true}if(!n.el){n._render({cnt:r})}else{h.g("timelinenavpanel").innerHTML=r}if(!n.__hasData){B=h.g("timelinenavpanel")||h.q("timelinenav-panel",n.el)[0];if(v){C=B.firstChild;while(C.nodeType!==1||C.nodeName.toUpperCase()!=="LI"||h.getAttr(C,"data-year")!=v){C=C.nextSibling}h.addClass(C,"active");n.__activeEle=C}if(p){C=B.childNodes[B.childNodes.length-1];while(C.nodeType!==1||C.nodeName.toUpperCase()!=="LI"||h.getAttr(C,"data-year")!="getrest"){C=C.previousSibling}h.setAttr(C,"id","timelinenavgetrest")}C=null;B=null;n.__hasData=true}g.emit("timelinenavInit",{data:n.model._timeIndicator})}},navInfoChanged:{act:function(s){var r,q,p;for(r=0,q=s.length;r<q;r++){p=s[r];switch(p.act){case"addYear":o.addYear.act(p.year);break}}}},addYear:{act:function(x){var u="year",H="months",q="month",I="num",r=n.model.navInfo,s,B,C,E=0,w,G,v,t="",A,y={},D,z,p;x=parseInt(x,10);for(B=0,C=r.length;B<C;B++){if(r[B][u]==x){s=r[B];w=s[H];break}}if(!s){return}if(!w||w.length==0){E=0}else{for(B=0,C=w.length;B<C;B++){G=w[B][q];v=w[B][I];if(!v){continue}if(!y[x]){y[x]={}}if(!n._availableDataInYear[x]){n._availableDataInYear[x]=[]}n._availableDataInYear[x].push(G);y[x][G]=v;t+=n.tmplHelper.generateHtmlStr(n.childTmpls.monthTmplId,{month:G,year:x,monthAlias:G+"月"});E++;if(!A){A=G}}if(E!=0){t=n.tmplHelper.generateHtmlStr(n.childTmpls.monthPanelTmplId,{cnt:t})}}if(n._availableDataInYear[x]){n._availableDataInYear[x].sort(function(K,J){return J-K})}D=h.g("timelinenavpanel");z=D.firstChild;while(z){if(z.nodeName.toUpperCase()!=="LI"){z=z.nextSibling;continue}else{if((p=h.getAttr(z,"data-year"))!=x){z=z.nextSibling;continue}else{break}}}if(E){z.innerHTML+=t;setTimeout(function(){o.doNavigate.act(A,x)},0);g.emit("timelinenavupdated",{data:y})}else{h.addClass(h.q("yearlink",z)[0],"norecord")}C=j-n._regDate.substring(0,4);if(C==n.model.navInfo.length-1){g.emit("timelinenavloadedall")}}},switchYearLink:{act:function(q){var p="active";if(q!==n.__activeEle){if(n.__activeEle){baidu.removeClass(n.__activeEle,p)}baidu.addClass(q,p);n.__activeEle=q}q=null}},switchMonthLink:{highlightedEle:null,act:function(q){var p="highlight";if(q!==this.highlightedEle){if(this.highlightedEle){baidu.removeClass(this.highlightedEle,p)}baidu.addClass(q,p);this.highlightedEle=q}q=null}},doNavigate:{act:function(p,q){g.emit("doNavigate",{data:{month:p,year:q}})}},checkToLoadData:{act:function(p){if(!n.model.checkIsYearLoaded(p)){n.model.loadNavData(p)}}},highlightMonth:{links:{years:{}},act:function(q,t){var s,r,p;if(!this.links.years[q]){this.links.years[q]={yearLink:null,monthLinks:{}};s=l(q);if(s){this.links.years[q]["yearLink"]=s}}r=this.links.years[q]["yearLink"];if(!r){return}o.switchYearLink.act(r);if(!this.links.years[q]["monthLinks"][t]){p=this.links.years[q]["monthLinks"][t]=a(r,t)}p=this.links.years[q]["monthLinks"][t];if(!p){return}o.switchMonthLink.act(p)}},scroll:{top:null,timer:null,tick:300,scrolling:false,act:function(){if(!this.top){this.top=n._navPosTop}if(!this.timer){this.timer=setTimeout(this.timeoutHandler,this.tick)}if(!this.scrolling){this.scrolling=true;n.el.style.display="none"}},timeoutHandler:function(){o.scroll.done()},done:function(){var p="documentElement",q=document[p].scrollTop;if(q>this.top){n.el.style.top=q-this.top+20+"px"}n.el.style.display="block";this.scrolling=false;this.timer=null}}};this.eventHandlers={click:function(w){var x=h.getTarget(w),y="data-year",u="data-month",q="monthlink",t="norecord",r="yearlink",v=x.className,s,A,p,z;h.preventDefault(w);if(v.indexOf(t)>-1){return}else{if(v.indexOf(q)>-1){p="m"}else{if(v.indexOf(r)>-1){p="y"}else{return}}}z=x.parentNode;if(p=="m"){s=h.getAttr(z,u);A=h.getAttr(z,y);o.doNavigate.act(s,A)}else{if(p=="y"){A=h.getAttr(z,y);if(A=="getrest"){e.call(n,x)}else{o.switchYearLink.act(z);o.checkToLoadData.act(A);if(n._availableDataInYear[A]){o.doNavigate.act(n._availableDataInYear[A][0],A)}}}}},navInfoChanged:function(p){if(p.type==="change:navInfo"){o.navInfoInit.act()}else{if(p.type==="update:navInfo"){o.navInfoChanged.act(p.data)}}},timelineScrollOver:function(q){var p="fixed";if(q.data.isScrollOver){h.addClass(n.el,p);if(h.ie6){n._scrollListening=true}}else{h.removeClass(n.el,p);if(h.ie6){n._scrollListening=false;n.el.style.top="20px";o.scroll.act()}}},getRestYear:function(r){var q,p=h.g("timelinenavgetrest");if(p){q=h.q("yearlink",p)[0]}e.call(n,q,true)},_loadAndNavigate:function(p){o.checkToLoadData.act(p)},highlightMonth:function(s){var r=s.data.toString(),p=r.substring(0,4),q=r.substring(4,6);if(n._stopScrollingSwitch){return}o.highlightMonth.act(p,q)},updateScrollStatus:function(p){if(p.data=="started"){n._stopScrollingSwitch=true}else{n._stopScrollingSwitch=false;n.eventHandlers.highlightMonth(p)}},scroll:function(p){if(!n._scrollListening){return}o.scroll.act()}};this._bindEvents();this._bindBroadcast();this.addEventListener("viewready",function(){this._bindInteractEvents()});if(this.model.navInfo){o.navInfoInit.act()}};m._bindInteractEvents=function(){h.on(this.el,"click",this.eventHandlers.click);if(h.ie6){this._navPosTop=h.getPosition(this.el.parentNode).top;h.on(window,"scroll",this.eventHandlers.scroll)}};m._bindEvents=function(){this.model.addEventListener("change:navInfo",this.eventHandlers.navInfoChanged);this.model.addEventListener("update:navInfo",this.eventHandlers.navInfoChanged)};m._bindBroadcast=function(){g.on("timelineScrollOver",this.eventHandlers.timelineScrollOver);g.on("getresttriggered",this.eventHandlers.getRestYear);g.on("timelinepositionchanged",this.eventHandlers.highlightMonth);g.on("timelineScrollAnimationStatusUpdated",this.eventHandlers.updateScrollStatus)};m.setLastYear=function(n){if(this._regDate){return this}this._regDate=n;g.emit("regdateready",{data:this._regDate});return this};return k});F.module("timelinenav/main",function(d,c){var h=d("timelinenav/model"),g=d("timelinenav/controller"),b=d("basecomponent/template"),f=d("tracking/trackmanager"),e,a;c.init=function(l,j,k){if(!e){e=new h({requestUserInfo:{portrait:App.router.global.page_userInfo.portrait},url:"/p/sys/data/time/timelinenav"})}if(!a){a=new g(e,b)}a.appendToDom(l);if(k){a.setLastYear(k)}if(j){e.setNavData(j)}f.timelineNav(l);e.loadNavData()};c.load=function(j,k){if(!e){setTimeout(arguments.callee.bind(null,j),500)}else{e.setNavData(j);if(k){a.setLastYear(k)}}}});F.module("summary/main",function(b,a){var c=b("base/base");function d(e){var h=c.getTarget(e),g,f;if((g=c.getAttr(h,"data-click"))){c.preventDefault(e);f=c.g(g+"tab");c.fire(f,"click")}}a.run=d});F.module("products/main",function(a,b){var p=false,j={},d=a("base/base"),c=a("dialog/dialogmanager"),l='<div class="mod-products loading clearfix">                     <div class="loadingtpl">LOADING...</div>                     <iframe src="#{src}" class="product-page" scrolling="no" frameBorder="no"></iframe>                 </div>',k='<div class="mod-products loading clearfix">                         <div class="loadingtpl">LOADING...</div>                         <div class="privacy"><p class="privacy-msg">#{sexTitle}隐藏了在#{msg}的所有信息哦。</p></div>                     </div>';function o(r){var q=j[r],s;if(!q.ready){s=d.g(j[r]["id"]);d.removeClass(s,"loading");d.addClass(s,"product-active");q.ready=true}}function f(s,q){var r=parseInt(q,10);if(r&&r>500){d.setStyles(d.g(j[s]["id"]),{height:q})}}function e(){c.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"})}function n(){c.hide()}function m(r,q){c.alert(r,{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});setTimeout(n,q)}function g(q){if(p){return}p=true;q.products=q.products||{};q.products.ready=o;q.products.resize=f;q.products.alert=m;q.products.alertLogin=e}function h(r,q){if(!j[r]){j[r]={src:q,id:"0",ready:false}}return b}b.init=g;b.createIframe=function(r){var s,q;if(!j[r]||j[r]["id"]!=="0"){return}if(!p){g(App)}q="prod"+d.getGuid();if(j[r]["src"]){s=d.format(l,{src:j[r]["src"]})}else{s=d.format(k,{msg:r=="wenku"?"文库":r=="xiangce"?"相册":r=="baike"?"百科":"这里",sexTitle:App.router.global.page_userInfo.sexTitle})}App.onPageletArrive({viewType:"Generic",targetId:"cnthld",modelValue:{tab:r,part:"index"},viewValue:"feed_content",tplContent:s,assignedId:q});j[r]["id"]=q;if(!j[r]["src"]){App.products.ready(r)}};b.loadProductsData=h});F.module("rewardlist/main",function(require,exports){var RewardListModel=require("rewardlist/model"),RewardListController=require("rewardlist/controller"),mainController,mainModel,isInit=false;exports.init=function(ele,initData){if(!mainModel){mainModel=new RewardListModel({requestUserInfo:{portrait:App.router.global.page_userInfo.portrait},url:"/p/sys/data/RewardList"})}if(!mainController){mainController=new RewardListController(mainModel,ele)}isInit=true};exports.load=function(initData,hasCompleted){var scri,bdshare;if(!initData){return}if(!isInit){setTimeout(this.load.bind(this,initData,hasCompleted),500)}else{mainModel.setData(initData);with(document){scri=createElement("script");bdshare=createElement("script");scri.src="http://bdimg.share.baidu.com/static/js/shell_v2.js?v=76281358.js?cdnversion="+Math.ceil(new Date()/3600000);bdshare.id="bdshare_js";bdshare.setAttribute("data","type=tools&amp;mini=1&amp;uid=758423");body.appendChild(bdshare);body.appendChild(scri)}}};exports.setVisible=function(status){if(!status){mainController.showList()}else{mainController.hideList()}};exports.aimReward=function(id){if(id){mainController._aimReward(id)}}});F.module("rewardlist/model",function(b,a){var c,e=b("basecomponent/model"),d=b("base/base");function f(g){var j={url:"/p/rewardlist/"},h;d.extend(j,g);h=j.requestUserInfo;this.url=j.url;this.dataLoaded={};this.__totalRecords=0;this.records={};this._loadingRequest={};this._listData=[];this.getRequestUserInfo=function(){return h};this.init()}RewardListModel=d.createClass(f,{superClass:e});c=RewardListModel.prototype;c.requestHandler=function(h){var g=JSON.parse(h);if(g.errNo){this.handleErr(g.group)}else{setTimeout((function(){this.setData(g)}).bind(this),500)}return this};c.setData=function(g){var g=g.data;if(g){this._listData.push(g)}this.dispatchEvent("dataLoaded",{data:g})};c.handleErr=function(k){var h=k.split("|"),g=h.length,j;while(g--){j=h[g];if(this._loadingRequest[j]){this._loadingRequest[j]=0}this.dispatchEvent("exception:records",{data:j})}};return RewardListModel});F.module("rewardlist/controller",function(require,exports){var fn,P=require("base/base"),Controller=require("basecomponent/controller"),trackManager=require("tracking/trackmanager"),_super=Controller.prototype;function _constructor(model,el,options){this.model=model;this.el=el;this.init();this._visible=true}RewardListController=P.createClass(_constructor,{superClass:Controller});fn=RewardListController.prototype;fn.renderData=function(data){this.el.innerHTML=data;this.dispatchEvent("updated:dataLoaded")};fn.init=function(){var that=this;this.eventHandlers={dataLoaded:function(evt){that.renderData(evt.data)}};this.addEventListener("updated:dataLoaded",this._bindInteractEvents);this._bindEvents()};fn._bindInteractEvents=function(){var rList=baidu.dom.g("rList"),rLists=rList.children,subrList=baidu.dom.q("sub-title-1"),getachLists=baidu.dom.q("ach-get"),rewardSlideEle=baidu.dom.g("rewardSlide"),locationHash=document.location.hash,hashCon=locationHash.split("_"),hashId="",slideRewardFlag=true;if(hashCon[0]=="#r"&&!isNaN(hashCon[1])){hashId=hashCon[1]}_slidBtn=function(clickEle,centerEle,scoreEle,btnEle,couEle){if(btnEle&&baidu.dom.hasClass(btnEle,"slid-down")){if(couEle){baidu.dom.setStyle(couEle,"display","none")}if(scoreEle){baidu.dom.addClass(scoreEle,"r-center-show")}baidu.dom.removeClass(btnEle,"slid-down");baidu.dom.addClass(btnEle,"slid-up");baidu.dom.setStyle(centerEle,"height",centerEle.scrollHeight+"px")}else{if(btnEle){if(couEle){baidu.dom.setStyle(couEle,"display","block")}baidu.dom.setStyle(centerEle,"height","70px");baidu.dom.removeClass(btnEle,"slid-up");baidu.dom.addClass(btnEle,"slid-down");if(scoreEle){baidu.dom.removeClass(scoreEle,"r-center-show")}}}};_slideRewardDone=function(flag,list,text,icon){if(flag){baidu.dom.addClass(icon,"icon-hide");text.innerHTML="展开已获得成就";_slideList(flag,list);slideRewardFlag=false}else{baidu.dom.removeClass(icon,"icon-hide");text.innerHTML="收起已获得成就";_slideList(flag,list);slideRewardFlag=true}};_slideList=function(flag,list){var isDisplay,changeTime,slidelist;if(flag){slidelist=function(e){if(e<list.length){baidu.dom.setStyle(list[e],"display","none");return slidelist(e+1)}};slidelist(0)}else{slidelist=function(e){if(e>-1){baidu.dom.setStyle(list[e],"display","block");return slidelist(e-1)}};slidelist(list.length-1)}};if(rewardSlideEle){var rewardDoneList=baidu.dom.q("reward-done"),rewardSlideText=baidu.dom.g("slideText"),rewardSlideIcon=baidu.dom.g("slideIcon");baidu.event.on(rewardSlideEle,"click",function(e){_slideRewardDone(slideRewardFlag,rewardDoneList,rewardSlideText,rewardSlideIcon)})}baidu.array.each(rLists,function(item,i){var clickEle=item,eleId=item.id,eleIdNum=eleId.split("_")[2];var centerEle=baidu.dom.g("r_c_"+eleIdNum),btnEle=baidu.dom.g("r_b_"+eleIdNum),scoreEle=baidu.dom.g("r_s_"+eleIdNum),shareEle=baidu.dom.g("r_share_"+eleIdNum),subrewardEle=baidu.dom.g("r_sub_"+eleIdNum),achEle=baidu.dom.g("det_achtive_"+eleIdNum),howtouseEle=baidu.dom.g("det_howtouse_"+eleIdNum),couEle=baidu.dom.g("det_cou_"+eleIdNum),hoverCls="reward-item-hover";baidu.event.on(clickEle,"click",function(e){var getClickEle=baidu.event.getTarget(e);_slidBtn(this,centerEle,scoreEle,btnEle,couEle);if(baidu.dom.hasClass(getClickEle,"sub-title-1")){baidu.event.on(getClickEle,"click",function(){fn._aimReward(baidu.dom.getAttr(this,"data-id"))})}var PVoptions={};PVoptions.trackParams={login_portrait:App.router.global.login_userInfo.portrait,page_portrait:App.router.global.page_userInfo.portrait,baidu_id:baidu.cookie.get("BAIDUID"),url_from:baidu.url.getQueryValue(location.href,"from"),evt:"click",module:"rewardlist",cn:clickEle.className,id:clickEle.id};trackManager.sendLogRequest(PVoptions)});if(subrewardEle){baidu.event.on(subrewardEle,"click",function(e){baidu.event.stopPropagation(e)})}if(achEle){baidu.event.on(achEle,"click",function(e){baidu.event.stopPropagation(e)})}if(howtouseEle){baidu.event.on(howtouseEle,"click",function(e){baidu.event.stopPropagation(e)})}});baidu.array.each(subrList,function(item,i){var getId=baidu.dom.getAttr(item,"data-id");if(getId!=null||get!==""){baidu.event.on(item,"click",function(){fn._aimReward(getId)})}trackManager.rewardList(item)});baidu.array.each(getachLists,function(item,i){var num=item.id.split("_")[1],numEle=baidu.dom.g("right_num_"+num),numdesEle=baidu.dom.g("right_des_num_"+num),dateEle=baidu.dom.g("right_date_"+num),passwordEle=baidu.dom.g("right_password_"+num),passworddesEle=baidu.dom.g("right_des_password_"+num),datedesEle=baidu.dom.g("right_des_date_"+num),msgEle=baidu.dom.g("right_des_msg_"+num),copyEle=baidu.dom.g("right_copy_num_"+num),url=document.location.protocol+"//"+document.location.host+"/p/sys/submit/reward?rewardid="+num+"&portrait="+App.router.global.login_userInfo.portrait+"&token="+App.router.global.token;baidu.event.on(item,"click",function(e){if(!baidu.dom.hasClass(item,"ach-got")){baidu.dom.addClass(item,"ach-got");item.innerHTML="<i></i>";baidu.ajax.get(url,function(e,i){var getReward=eval("("+i+")");if(getReward.err_no==0){numEle.innerHTML=getReward.result.serial_no;dateEle.innerHTML=getReward.result.valid_date;baidu.dom.setStyle(numdesEle,"display","block");if(getReward.result.valid_date){baidu.dom.setStyle(datedesEle,"display","block")}baidu.dom.setStyle(msgEle,"display","none");if(getReward.result.password!=""&&getReward.result.password!=undefined){passwordEle.innerHTML=getReward.result.password;baidu.dom.setStyle(passworddesEle,"display","block")}item.innerHTML="已领取";if(copyEle){baidu.event.on(copyEle,"click",function(){msgEle.innerHTML="优惠券号已经复制到您的接切板！";baidu.dom.setStyle(msgEle,"display","block")})}}else{if(getReward.err_no==1){msgEle.innerHTML="来晚了，优惠券已领光";item.innerHTML="已领完";baidu.dom.setStyle(msgEle,"display","block")}else{msgEle.innerHTML=getReward.result;item.innerHTML="领取奖励";baidu.dom.setStyle(msgEle,"display","block");baidu.dom.removeClass(item,"ach-got")}}})}})});if(baidu.cookie.get("ISFIRSTLOAD")&&hashId){this._aimReward(hashId)}(function(getLoadCookie){if(baidu.dom.g("beginner_navtip")){baidu.dom.setStyle("beginner_navtip","display","none")}if(!getLoadCookie&&App.router.global.login_userInfo.portrait==App.router.global.page_userInfo.portrait){baidu.cookie.set("ISFIRSTLOAD",1,{path:"/p",expires:31558150000});var beginWrapper=baidu.dom.create("div");baidu.dom.addClass(beginWrapper,"mod-beginner");var ele_1="",ele_2=baidu.dom.g("reward_level"),ele_3=baidu.dom.g("r_list_27"),ele_4="",jumpLink="http://www.baidu.com/s?wd=22%B5%C42%B4%CE%B7%BD",jumpClass="plan-a",hrefTarget="_blank";if(baidu.dom.hasClass("r_list_11","reward-unfinished")){ele_4=baidu.dom.g("r_list_11")}else{if(baidu.dom.hasClass("r_list_34","reward-unfinished")){ele_4=baidu.dom.g("r_list_14");jumpLink="http://www.baidu.com/s?wd=%CE%D2%B5%C4%B8%E8%C9%F9%C0%EF";jumpClass="plan-b"}else{ele_4=baidu.dom.g("r_list_11");jumpLink="#reward_level";jumpClass="plan-c";hrefTarget=""}}var screenH=document.documentElement.clientHeight,screenW=document.documentElement.clientWidth,allH=document.body.scrollHeight,allW=document.body.scrollWidth,position_1={top:screenH/2-105,left:screenW/2-235},position_2=baidu.dom.getPosition(ele_2),position_3=baidu.dom.getPosition(ele_3),position_4=baidu.dom.getPosition(ele_4);var stepTpl=[['<div class="beginner-wrapper" style="height:'+allH+"px;width:"+allW+'px">',"</div>"],['<div class="beginner-step step-1" id="step_1" style="top:'+position_1.top+"px;left:"+position_1.left+'px;width:470px;height:210px;">','<div class="step-tips">','<div class="tips-con">','<div class="con-next">','<a class="next-step next-step-1" id="next_step_1"></a>',"</div>","</div>",'<div class="tips-close">','<a class="close-button" id="close_button_1"></a>',"</div>","</div>","</div>"],['<div class="beginner-step step-2" id="step_2" style="display:none;top:'+position_2.top+"px;left:"+position_2.left+'px;width:748px;height:120px;">','<div class="step-tips">','<div class="tips-con">','<div class="con-next">','<a class="next-step next-step-2" id="next_step_2"></a>',"</div>","</div>",'<div class="tips-close">','<a class="close-button" id="close_button_2"></a>',"</div>","</div>",'<div class="step-arrow">',"</div>","</div>"],['<div class="beginner-step step-3" id="step_3" style="display:none;top:'+position_3.top+"px;left:"+position_3.left+'px;width:710px;height:106px;">','<div class="step-tips">','<div class="tips-con">','<div class="con-next">','<a class="next-step next-step-3" id="next_step_3"></a>',"</div>","</div>",'<div class="tips-close">','<a class="close-button" id="close_button_3"></a>',"</div>","</div>",'<div class="step-arrow">',"</div>","</div>"],['<div class="beginner-step step-4 '+jumpClass+'" id="step_4" style="display:none;top:'+position_4.top+"px;left:"+position_4.left+'px;width:710px;height:106px;">','<div class="step-tips">','<div class="tips-con">','<div class="tips-jump">','<a class="close-button" href="'+jumpLink+'" target="'+hrefTarget+'"></a>',"</div>","</div>",'<div class="tips-close">','<a class="close-button" id="close_button_4"></a>',"</div>","</div>",'<div class="step-arrow">',"</div>","</div>"]],stepTplCon="";baidu.array.each(stepTpl,function(item,i){stepTplCon=stepTplCon+item.join("")});baidu.dom.insertHTML(beginWrapper,"beforeEnd",stepTplCon);baidu.dom.g("wrapper").appendChild(beginWrapper);baidu.event.on(beginWrapper,"click",function(e){var tarEle=baidu.event.getTarget(e);if(baidu.dom.hasClass(tarEle,"close-button")){baidu.dom.setStyle(beginWrapper,"display","none")}else{if(baidu.dom.hasClass(tarEle,"next-step")){var tarId=tarEle.id,tarNum=tarId.split("_")[2],tarEle=baidu.dom.g("step_"+tarNum),tarNextEle=baidu.dom.g("step_"+(tarNum*1+1));baidu.dom.setStyle(tarEle,"display","none");baidu.dom.setStyle(tarNextEle,"display","block");if(tarEle){var scrCur=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,scollFlag=1,curPosi=baidu.dom.getPosition(tarNextEle),curDistance=curPosi.top-300-scrCur;if(curPosi.top-300!=scrCur){var beginTimer=setInterval(function(){if(scollFlag>10){clearInterval(beginTimer)}else{window.scrollBy(0,curDistance/10);scollFlag++}},10)}}}}})}})(baidu.cookie.get("ISFIRSTLOAD"))};fn._aimReward=function(ele){var aimEle=baidu.dom.g("r_list_"+ele);if(aimEle){var startFlash=1,scrollStartTime=1,aimTop=baidu.dom.getPosition(aimEle).top,docHeight=document.body.scrollHeight,screenHeight=document.documentElement.clientHeight,safeHeight=screenHeight/2-10,localUrl=location.href.replace(/#.*/,""),scrollStart=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,topHeight;scrollJump=(aimTop-screenHeight/2+50)-scrollStart;var scrollTimer=setInterval(function(){if(scrollStartTime>10){clearInterval(scrollTimer);var flashTimer=setInterval(function(){if(startFlash>=9){clearInterval(flashTimer)}else{if(startFlash%2==1){baidu.dom.addClass(aimEle,"list-flash")}else{baidu.dom.removeClass(aimEle,"list-flash")}}startFlash++},300)}else{window.scrollBy(0,scrollJump/10);scrollStartTime++}},50)}};fn._bindEvents=function(){this.model.addEventListener("dataLoaded",this.eventHandlers.dataLoaded)};fn.showList=function(){this._setVisible(true)};fn.hideList=function(){this._setVisible(false)};fn._setVisible=function(visible){if(this._visible&&!visible){baidu.dom.setStyle("rList","display","none")}else{baidu.dom.setStyle("rList","display","block")}};return RewardListController},["basecomponent/controller"]);F.module("rewardholder/main",function(b,a){var c=b("tracking/trackmanager");a.init=function(g){var e=false,f=baidu.dom.q("cur-item-link");if(g.totalSco>0&&g.curSco>0){var d=parseInt((g.curSco/g.totalSco)*440);baidu.setStyle(baidu.q("current-score")[0],"width",d+"px")}else{baidu.dom.setStyle(baidu.q("sco-current")[0],"display","none")}_setRights=function(){if(!e){baidu.dom.setStyle("reward_rights","display","block");baidu.dom.setStyle(baidu.dom.q("leftside")[0],"height","1160px");e=true;_setList(true)}else{baidu.dom.setStyle("reward_rights","display","none");baidu.dom.setStyle(baidu.dom.q("leftside")[0],"height","auto");e=false;_setList(false)}};baidu.event.on("rights_a","click",function(h){baidu.event.preventDefault(h);_setRights()});baidu.event.on("rights_back_top","click",function(h){baidu.event.preventDefault(h);_setRights()});if(f){baidu.array.each(f,function(k,j){var h=baidu.dom.getAttr(k,"data-id");if(h!=null||h!=""){baidu.event.on(k,"click",function(){_setScroPosition(h)})}})}c.rewardHolder(baidu.dom.g("rights_a"));c.rewardHolder(baidu.dom.g("rewardCur"))};_setList=function(d){F.use("rewardlist/main",function(e){e.setVisible(d)})};_setScroPosition=function(d){F.use("rewardlist/main",function(e){e.aimReward(d)})}});F.module("main_relation_button/relation_submit",function(a,c){var b=function(g){var e=P.q("js-relationBox",g)[0],k=P.getAttr(e,"data-from"),j=P.q("relation-button",e)[0],f=P.q("show-follow",e)[0];var d=function(l){if(l=="isFollowed"){j.style.display="none";f.style.display="block"}else{if(l=="none"){j.style.display="block";f.style.display="none"}}};var h=function(l){if(!App.router.global.isLoggedIn){dialog=a("dialog/dialogmanager");dialog.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}App.router.postData("changeRelation",{postData:{from:k,action:l,portrait:App.router.global.page_userInfo.portrait},callback:function(o){if(o.errNo==-1){var n=o.errMsg||"服务器忙，请稍候再试";dialog=a("dialog/dialogmanager");dialog.alert(n,{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});return}else{if(o.errNo==-101){dialog=a("dialog/dialogmanager");dialog.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}}var m=(o.data.relation=="followed"||o.data.relation=="friend")?"isFollowed":"none";d(m)}})};P.on(P.q("add-follow",e)[0],"click",function(m){var l=a("no_username/no_username");if(l.hasUsername()){h("add")}P.preventDefault(m)});P.on(P.q("cancel",e)[0],"click",function(l){F.use("dialog/dialogmanager",function(m){m.confirm(l,"确定不再关注"+App.router.global.page_userInfo.sexTitle+"？",function(){h("remove")})});P.preventDefault(l)})};c.bind=b});F.module("space_relation/spacerelationmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;if(g&&typeof g.init=="function"){g.init.call(this)}}var b=a.prototype=P.extend(c);b.getData=function(g){var h=g.requestType,f;if(h=="spfriendlist"){if(g.data){f=g.data}this.__parent.getData({tab:"space",part:"friend",options:{type:f.type}});this.router.brocast(h,{tab:f.type});this.__parent.addEventListener("change:tab",(function(j){if(j.part=="friend"){this.dispatchEvent("update:portraitlist",{visible:false})}else{if(j.part=="index"){this.dispatchEvent("update:portraitlist",{visible:true})}}}).bind(this))}};b.doAction=function(f,g){if(f==="add"){this.router.followCurrentUser("space",g)}else{if(f==="delete"){this.router.unfollowCurrentUser("space",g)}}};return a});F.module("space_relation/spacerelationview",function(k,d){var h=k("base/view");var c={error:function(n,o){var l,m;if(n==-101){l=k("dialog/dialogmanager");l.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}else{if(n==-1){m=o.errMsg||"服务器忙，请稍候再试";l=k("dialog/dialogmanager");l.alert(m,{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});return}}}};var b=function(l){var m=this.el;P.on(this.el,"click",(function(o){var p=P.getTarget(o),q;if(P.hasClass(p,"js-friendlist")){q=P.getAttr(p,"data-part");if(q){P.preventDefault(o);a(this.el,false);this.model.getData({requestType:"spfriendlist",data:{type:q}})}}else{if(P.getAncestorByClass(p,"js-relationBox")){if(P.hasClass(p,"add-follow")){requestType="add";this.model.doAction(requestType,c)}else{if(P.hasClass(p,"cancel")){requestType="delete";dm=k("dialog/dialogmanager");dm.confirm(o,"确定不再关注"+this.model.router.global.page_userInfo.username+"？",(function(){this.model.doAction(requestType,c)}).bind(this))}}P.preventDefault(o)}}}).bind(this));var n=k("tracking/trackmanager");n.spaceRelation(this.el)};var a=function(l,n){var m="hide-porlist";if(n){P.removeClass(l,m)}else{P.addClass(l,m)}};var e=function(m){var n=P.q("rl-count-follows",this.el)[0],o=P.q("rl-count-fans",this.el)[0];if(m.data.fans!==undefined&&o){if(o.innerHTML==="0"){o.parentNode.innerHTML='<a href="#" class="relation-link yahei rl-count-fans js-friendlist" data-part="fans">'+m.data.fans+"</a>"}else{if(m.data.fans===0&&o){o.parentNode.innerHTML='<span class="yahei rl-count-fans relation-span">0</span>'}else{var l=k("number_move/number_move");l.play(o,m.data.fans)}}}if(m.data.follows!==undefined&&n){if(n.innerHTML==="0"){n.parentNode.innerHTML='<a href="#" class="relation-link yahei rl-count-follows js-friendlist" data-part="follow">'+m.data.follows+"</a>"}else{if(m.data.follows===0&&n){n.parentNode.innerHTML='<span class="yahei rl-count-follows relation-span">0</span>'}else{var l=k("number_move/number_move");l.play(n,m.data.follows)}}}};var g=function(l){var n=P.q("relation-button",this.el)[0],m=P.q("show-follow",this.el)[0];if(n&&m){if(l.data.opt==="add"){n.style.display="none";m.style.display="block"}else{if(l.data.opt==="delete"){n.style.display="block";m.style.display="none"}}}};var f=function(l,m){this.model=l;this.el=m;this.init();this.addEventListener("update:viewready",b.bind(this));this.model.addEventListener("update:portraitlist",(function(n){var o=this.el;a(o,n.visible)}).bind(this));this.model.addEventListener("change:count",e.bind(this));this.model.addEventListener("update:relationbtn",g.bind(this))};var j=f.prototype=P.extend(h);return f});F.module("zhidao_answerlist/zhidaoanslistview",function(l,c){var j=l("base/view"),m=l("util/pagebar"),d;var n="zhidao-page-bar";var a=function(q){var p=P.q(n,this.el)[0];if(p){p.innerHTML=m(q|0,this.model.__totalItems,this.model.__pageSize,4)}};var h=function(p){var r=P.getTarget(p),q=P.getAttr(r,"data-pn");if(q){P.addClass(this.el,"loading");a.call(this,q);this.model.getData(q)}P.preventDefault(p)};var o=function(){var p,r="item-over";function t(u){P.addClass(u,r)}function q(u){P.removeClass(u,r)}function s(u,v){if(u=="mouseover"){t(v)}else{if(u=="mouseout"){q(v)}}}return{handle:s}};var g=function(){var p=P.q("zhidao-ask-question",this.el)[0];p&&P.on(p,"click",function(q){F.use("ask_question/ask_question",function(r){r.ask()});P.preventDefault(q)})};var e=function(s){var r=P.getTarget(s),p=s.type,t=r.nodeName.toLowerCase(),q;if(t=="tr"&&P.hasClass(r,"anwlist-item")){q=r}else{if(t=="td"||t=="span"||t=="a"){q=P.getAncestorByClass(r,"anwlist-item")}}if(q){d.handle(p,q)}};var b=function(p){P.on(p,"mouseover",e);P.on(p,"mouseout",e)};function f(p,q){this.model=p;this.el=q;this.init();this.addEventListener("update:viewready",(function(){a.call(this,1);this.bindClick();g.call(this);if(P.ie6){b(this.el);d=o()}}).bind(this));this.model.addEventListener("change:content",(function(r){if(P.hasClass(this.el,"loading")){P.removeClass(this.el,"loading")}}).bind(this))}var k=f.prototype=P.extend(j);k.appendChildView=function(s){var p,q,r="zhidao-anwlist";if(s.el&&P.getAncestorByClass(s.el,r)){return}else{p=P.q(r,this.el)[0];if(p){p.appendChild(s.el);s.setDomReady()}}};k.setData=function(p,q){p.feedPage=q;p.appendTo(this)};k.bindClick=function(){var p=P.q(n,this.el)[0];if(p){P.on(p,"click",h.bind(this))}var q=l("tracking/trackmanager");q.zhidaoAnswerlist(this.el)};return f});F.module("zhidao_answerlist/zhidaoanslistmodel",function(e,f){var d=e("base/model");var b;function a(j,g,h){this.id=j;this.router=g;this.__currentPage=1;this.__pages={};this.__requestPage=1;if(h&&typeof h.init=="function"){h.init.call(this)}}var c=a.prototype=P.extend(d);c.getFeedContentId=function(){return P.getGuid()};c.setData=function(h,g){var k=g.pn||1,j=this;this.dispatchEvent("change:content");if(this.__pages[k]){this.__children[(this.__pages[this.__currentPage])].visible(false);this.__children[(this.__pages[k])].visible(true);this.__currentPage=k}else{if(k==this.__requestPage){if(this.__pages[this.__currentPage]){this.__children[(this.__pages[this.__currentPage])].visible(false)}h.visible(true);this.__currentPage=k}h.appendTo(j);j.__pages[k]=h.id}};c.getData=function(g){this.__requestPage=g;if(this.__pages[g]){this.setData(this,{pn:g})}else{this.requestNewContent(g)}};c.requestNewContent=function(g){this.router.getData(this,"zhidaoAnslist",{pn:g})};return a});F.module("number_move/number_move",function(b,c){var a=function(e,d){F.use("tangram_move/tangram_move",function(){var g=baidu.g(e);var o=baidu.trim(g.innerHTML);var q=o|0;if(q!=o){return}var t=d-q;var y=g.cloneNode(true);var k=q+t;var s=k+"";var l="",u="",p="";if(s.length!=o.length){u=o;p=s}else{for(var w=0,x=o.length;w<x;w++){if(o.substr(w,1)==s.substr(w,1)){l+=o.substr(w,1)}else{u=o.substr(w);p=s.substr(w);break}}}var z=g.offsetHeight;var v=g.offsetWidth;g.innerHTML=s;g.style.visibility="hidden";y.style.height=z+"px";y.style.width=(t>0?g.offsetWidth:v)+"px";y.style.overflow="hidden";y.style.position="absolute";y.style.left="0";y.style.top="0";var r=g.parentNode;r.style.position="relative";r.appendChild(y);var f="numberMovie"+ +new Date(),j,h;if(t>0){j=u;h=p}else{j=p;h=u}var A='#{same}<span style="position:relative;vertical-align: top;"><i id="#{id}" style="font-style:normal;position:absolute; line-height:#{height}px;top:0;">#{num1}<br>#{num2}</i>&nbsp;</span>';y.innerHTML=P.format(A,{same:l,num1:j,num2:h,id:f,height:z});var m=new baidu.fx.Timeline({duration:300});m.initialize=function(){if(t<0){P.g(f).style.top=-z+"px"}};m.render=function(B){var n;if(t>0){n=-B*z*t/Math.abs(t)}else{n=(1-B)*z*t/Math.abs(t)}P.g(f).style.top=n+"px"};m.finish=function(){g.style.visibility="visible";y.parentNode.removeChild(y)};m.launch()})};return{play:a}});F.module("switch_animation/switch_animation",function(a,d){var c=function(j,k,l){var j=P.g(j),e=k=="left"?-1:1,g=j.offsetWidth;var h=j.parentNode;var f=j.cloneNode(true);P.setStyles(h,{position:"relative",overflow:"hidden"});P.setStyles(f,{position:"relative"});P.setStyles(j,{position:"absolute"});h.insertBefore(f,j.nextSibling);j.style.left=g*e+"px";F.use("tangram_move/tangram_move",function(){var m=new baidu.fx.Timeline();m.render=function(o){var n=o*g*e;j.style.left=(g*e-n)+"px";f.style.left=(-n)+"px"};m.transition=function(n){return n*(2-n)};m.finish=function(){f.parentNode.removeChild(f);P.setStyles(j,{position:"relative",left:"0"});l&&l()};m.launch()})};var b=function(f,g){f=P.g(f);var e=f.cloneNode(true);P.setStyles(e,P.extend({position:"absolute","z-index":100,width:f.offsetWidth+"px"},P.getPosition(f)));document.body.appendChild(e);F.use("tangram_move/tangram_move",function(){var h=new baidu.fx.Timeline();h.render=function(j){e.style.opacity=1-j;e.style.filter="Alpha(opacity='"+((1-j)*100)+"')"};h.transition=function(j){return j*(2-j)};h.finish=function(){e.parentNode.removeChild(e);g&&g()};h.launch()})};d.switchNode=c;d.fadeSwitch=b});F.module("dialog/commonConfirm",function(f,h){var c=f("dialog/dialog"),e,b=P.createClass(function(){var j=d(this);g.call(this,this.context,j);this.addEventListener("hidden",function(){if(this.bgObj){this.bgObj.hide()}this.dispose()})},{superClass:c});e=b.prototype;function a(j,k){this.config={};this.bgObj=j.bgObj;this.config.okStatus=j.okStatus;this.config.cancelStatus=j.cancelStatus;if(typeof k=="function"){this._callback=k}else{this._callback=null}if(typeof j.oncancel=="function"){this._cancelCallback=j.oncancel}else{this._cancelCallback=null}if(this.bgObj){this.bgObj.show()}return this.show(j)}function g(k,o){var n,m,l,j;if(k.nodeType==1){if(k.attributes.getNamedItem("data-click")){P.on(k,"click",o)}for(m=0,l=k.childNodes,j=l.length;m<j;m++){g.call(this,l[m],o)}}}function d(j){return function(k){var l=P.getTarget(k).getAttribute("data-click");var m=false;if(l==j.config.okStatus){if(j._callback){m=j._callback()}}else{if(l==j.config.cancelStatus){j._cancelCallback&&j._cancelCallback()}}if(!m){j.hide()}}}e.confirm=a;return b},["dialog/dialog"]);F.module("dialog/alert",function(f,h){var a=f("dialog/dialog"),e,d=P.createClass(function(){var j=b(this);g.call(this,this.context,j);this.addEventListener("hidden",function(){if(this.bgObj){this.bgObj.hide()}})},{superClass:a});e=d.prototype;function c(j,k){this.bgObj=j.bgObj;this.config={};this.config.okStatus=j.okStatus;if(k&&(typeof k=="function")){this._callback=k}else{this._callback=null}if(this.bgObj){this.bgObj.show()}return this.show(j)}function g(j,k){P.on(j,"click",k)}function b(j){return function(k){var l=P.getTarget(k).getAttribute("data-click");if(l){if(l==j.config.okStatus){if(j._callback){j._callback()}}j.hide()}}}e.alert=c;return d},["dialog/dialog"]);F.module("dialog/overlayer",function(b,d){var c=P.q("mod-dialog-bg")[0],e,a;e=function(){if(!c){c=document.createElement("div");c.className="mod-overlayer";document.body.appendChild(c)}c.style.width=P.getWidth(document.body)+"px";c.style.height=P.getHeight(document.body)+"px";c.style.display="block"};a=function(){if(c){c.style.display="none"}};return{show:e,hide:a}});F.module("dialog/dialogmanager",function(a,k){var h=a("dialog/dialog"),v=a("dialog/confirm"),g=a("dialog/commonConfirm"),n=a("dialog/alert"),d,o,j,t,r,q,m,w=['<div class="dialog-main #{txtClass}">','<div class="dialog-content">','<div class="dialog-txt" data-bind="text:innerHTML">',"#{txt}","</div>","</div>",'<div class="dialog-console">#{btnConfirm}#{btnCancel}</div>'].join("");function l(){if(o&&d){o.addEventListener("preshow",function(){d.hide()});d.addEventListener("preshow",function(){o.hide()});d.addEventListener("preshow",function(){m.hide()})}}function f(x,A){var y,z;if(!A){A=x;if(!A){return}}if(!d){y=document.createElement("div");y.innerHTML=P.format(w,{txtClass:"dialog-normal",txt:A});y.className="mod-dialog dialog-floating";document.body.appendChild(y);d=new h(y);l()}z=A;return d.show(z)}function c(A,y){var D,E,C,x,B,G,z;if(y){D=y.text;z=y.hide||false}if(!D||!A){return}if(!d){G=document.createElement("div");G.innerHTML=P.format(w,{txtClass:"dialog-tick",txt:D});G.className="mod-dialog dialog-tip";document.body.appendChild(G);d=new h(G);l()}B=P.getPosition(A);C=B.top-55;x=B.left-36;E={text:D,top:C,left:x,hide:z};d.show(E)}function s(x,C,E){var z,A,D,B,y;if(!o){z=document.createElement("div");z.innerHTML=P.format(w,{txtClass:"dialog-confirm",txt:C,btnConfirm:'<a href="#" onclick="return false;" class="dialog-ok" data-click="ok">确定</a>',btnCancel:'<a href="#" onclick="return false;" class="dialog-cancel" data-click="cancel">取消</a>'});z.className="mod-dialog dialog-floating";document.body.appendChild(z);o=new v(z);l()}A={};A.text=C;D=P.getPosition(P.getTarget(x));if(D.top-P.getScrollTop()>118){A.top=D.top-118}else{if(P.getTarget(x).offsetHeight){B=P.getTarget(x).offsetHeight}A.top=D.top+B}y=P.getTarget(x).offsetWidth||0;A.left=D.left-87+y/2;A.okStatus="ok";o.confirm(A,E)}function e(E,z){var G,B,D,y,A;var x=a("dialog/overlayer"),C=['<div class="dialog-topbar">','<div class="dialog-title">#{title}</div>','<a class="close" href="#" onclick="return false;" data-click="cancel"></a>',"</div>",'<div class="dialog-main #{txtClass}">','<div class="dialog-content #{cntClass} #{cntAlignClass}">','<div class="dialog-txt" data-bind="text:innerHTML">',"#{txt}","</div>","</div>",'<div class="dialog-console #{cnsClass}">#{btnConfirm}#{btnCancel}</div>',"</div>"].join("");G=document.createElement("div");G.innerHTML=P.format(C,P.extend({txtClass:"dialog-confirm",txt:E,btnConfirm:'<a href="#" onclick="return false;" class="dialog-ok" data-click="ok">确定</a>',btnCancel:'<a href="#" onclick="return false;" class="dialog-cancel" data-click="cancel">取消</a>',cntClass:"cnt-normal",cnsClass:"cns-one",cntAlignClass:"cnt-left",title:"提示"},z));G.className="mod-dialog dialog-popup "+(z.mainClassName||"");document.body.appendChild(G);m=new g(G);l();B={};B.text=E;B.bgObj=x;B.okStatus="ok";B.cancelStatus="cancel";B.oncancel=z.oncancel;return m.confirm(B,z.callback)}function u(x,y,z){}function b(){if(d&&d.isShow){d.hide()}if(o&&o.isShow){o.hide()}if(j&&j.isShow){j.hide()}if(m&&m.isShow){m.hide()}}function p(L,A){var J,K,H,y,E,x,z,N,S,U,B,D=A&&A.callback,G=a("dialog/overlayer"),O=['<div class="dialog-topbar">','<div class="dialog-title">#{title}</div>','<a class="close" href="#" onclick="return false;" data-click="close"></a>',"</div>",'<div class="dialog-main #{txtClass}">','<div class="dialog-content #{cntClass} #{cntAlignClass}">','<div class="dialog-txt" data-bind="text:innerHTML">',"#{txt}","</div>","</div>",'<div class="dialog-console #{cnsClass}">#{btnConfirm}#{btnCancel}</div>',"</div>"].join(""),C="#{btnConfirm}#{btnCancel}",Q,M,R,I={txtClass:"dialog-alert",cntClass:"cnt-normal",cnsClass:"cns-one",cntAlignClass:"cnt-left",txt:L,btnConfirm:'<a href="#" onclick="return false;" class="dialog-ok" data-click="ok">确定</a>',title:"提示"};if(!j){J=document.createElement("div");J.innerHTML=baidu.string.format(O,P.extend(I,A));J.className=A&&A.nousername?"mod-dialog dialog-popup dialog-nousername":"mod-dialog dialog-popup";document.body.appendChild(J);j=new n(J)}if(A){z=A.cntClass;N=A.cntAlignClass;U=A.cnsClass;Q=A.btnConfirm;M=A.btnCancel;B=A.txtClass;mainClassName=A.mainClassName}if(z||N){x=P.q("dialog-content",J)[0];if(z&&t&&z!=t){P.addClass(x,z);P.removeClass(x,t);t=z}else{if(z){t=z}}if(N&&r&&N!=r){P.addClass(x,N);P.removeClass(x,r);r=N}else{if(N){r=N}}}if(U){S=P.q("dialog-console",J)[0];if(q&&q!=U){P.addClass(S,U);P.removeClass(S,q);q=U}else{q=U}if(Q||M){R=P.format(C,{btnConfirm:Q,btnCancel:M});S.innerHTML=R;R=null}}txtEle=P.q("dialog-main")[0];txtEle.className="dialog-main";P.addClass(txtEle,B?B:"dialog-alert");t=t||"cnt-normal";r=r||"cnt-left";q=q||"cns-one";K={};K.text=L;K.okStatus="ok";K.bgObj=G;return j.alert(K,D)}return{show:f,showAt:c,confirm:s,alert:p,hide:b,commConfirm:e}});F.module("dialog/confirm",function(f,h){var c=f("dialog/dialog"),e,b=P.createClass(function(){var j=d(this);g.call(this,this.context,j);this.addEventListener("hidden",function(){if(this.bgObj){this.bgObj.hide()}})},{superClass:c});e=b.prototype;function a(j,k){this.config={};this.bgObj=j.bgObj;this.config.okStatus=j.okStatus;this.config.cancelStatus=j.cancelStatus;if(typeof k=="function"){this._callback=k}else{this._callback=null}if(typeof j.oncancel=="function"){this._cancelCallback=j.oncancel}else{this._cancelCallback=null}if(this.bgObj){this.bgObj.show()}return this.show(j)}function g(k,o){var n,m,l,j;if(k.nodeType==1){if(k.attributes.getNamedItem("data-click")){P.on(k,"click",o)}for(m=0,l=k.childNodes,j=l.length;m<j;m++){g.call(this,l[m],o)}}}function d(j){return function(k){var l=P.getTarget(k).getAttribute("data-click");var m=false;if(l==j.config.okStatus){if(j._callback){m=j._callback()}}else{if(l==j.config.cancelStatus){j._cancelCallback&&j._cancelCallback()}}if(!m){j.hide()}}}e.confirm=a;return b},["dialog/dialog"]);F.module("dialog/dialog",function(e,g){var d,b=P.createClass(function(j){var k=e("util/binding");if(j&&j.nodeType!=1){throw"cannot create Dialog, the constructor must has element node"}this.context=j;k.setBinding(this,this.context)});d=b.prototype;function h(k,j,m,l){this.context.style.display="block";if(k=="center"||j=="center"){k=(P.getViewHeight()-this.context.offsetHeight)/2+P.getScrollTop();j=(P.getViewWidth()-this.context.offsetWidth)/2+P.getScrollLeft()}if(this.isShow){if((this.context.style.top==k+"px")&&(this.context.style.left==j+"px")){return}}this.dispatchEvent("preshow");this.text(m);this.context.style.top=k+"px";this.context.style.left=j+"px";this.isShow=true;this.dispatchEvent("showed");if(this._hideTimer){clearTimeout(this._hideTimer)}if(l){this._hideTimer=setTimeout(this.hide.bind(this),1000)}}function a(j){var m="center",l="center",o,k,n=false;k=P.getType(j);if(k=="[object string]"){o=j}else{if(k=="[object object]"&&j.text){m=j.top||"center";l=j.left||"center";o=j.text;n=j.hide||false}else{return}}h.call(this,m,l,o,n);return this.context}function c(){this.context.style.display="none";this.isShow=false;this.dispatchEvent("hidden");if(this._hideTimer){clearTimeout(this._hideTimer)}}function f(){this.context.parentNode.removeChild(this.context);this.isShow=false;this.dispatchEvent("disposed")}d.show=a;d.hide=c;d.dispose=f;return b});F.module("no_username/no_username",function(a,d){var c=function(){if(App.router.global.isLoginUserNoName){b();return false}else{return true}};var b=function(){var g=a("dialog/dialogmanager");var f='<div><p class="nousername-tips">没有用户名，无法使用“我的主页”，先给自己起个名字吧!</p><div id="nousername"></div></div>';var h=function(){};var e={btnConfirm:'<a href="/p/sys/redirect?nousername=1" class="dialog-ok" data-click="cancel">马上填写</a>',txtClass:"mod-nousername",cntClass:"cnt-long",cntAlignClass:"cnt-left",cnsClass:"dialog-console-none",nousername:true};g.alert(f,e);bdPass.api.fillinusername.init({outerDomId:"nousername",staticpage:"http://www.baidu.com/p/sys/fillusername/jump",u:window.location.href})};d.hasUsername=c});F.module("space_userlist/spacefriendlistview",function(k,e){var h=k("base/view"),m=k("util/pagebar");var n="space-page-bar";var b=function(r){var p=P.q(n,this.el)[0];if(p){var q=this.model.__totalItems>500?500:this.model.__totalItems;p.innerHTML=m(r|0,q,this.model.__pageSize,4)}};var d=function(y){var u=P.getTarget(y),p=P.getAncestorByClass(u,"user-console"),s,x,v,q,r,w,t="changeRelation";if(p&&(s=P.getAttr(u,"data-click"))&&(x=P.getAttr(p,"data-from"))&&(w=P.getAttr(p,"data-portrait"))){q=k("no_username/no_username");if(s!="add"&&s!="remove"){P.preventDefault(y);return}if(!this.model.router.global.isLoggedIn){v=k("dialog/dialogmanager");v.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});P.preventDefault(y);return}else{if(!q.hasUsername()){P.preventDefault(y);return}}r={actionObj:{postData:{portrait:w,from:x,action:s},callback:function(D){var B=D.relation,A,z=P.getAttr(u,"class"),C;if(D.errNo==-1){v=k("dialog/dialogmanager");v.alert(D.errMsg||"<b>服务器忙，请稍候再试</b>",{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});return}else{if(D.errNo==-101){v=k("dialog/dialogmanager");v.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}}if(B=="followed"){A="btn-follow";C=true}else{if(B=="friend"){A="friend";C=true}}if(C){v=k("dialog/dialogmanager");P.removeClass(u,z);P.addClass(u,A);v.showAt(u,{text:"关注成功！",hide:true});P.setAttr(u,"data-click","done")}P.removeClass(u,z);P.addClass(u,A);P.setAttr(u,"data-click","done")}},postType:t};this.model.doPost(r);P.preventDefault(y)}};var o=function(p,q){P.on(p,"click",d.bind(q));P.on(p,"mouseover",a);P.on(p,"mouseout",a)};var a=function(q){var s=P.getTarget(q),r=s.className,p;if(r==="btn-message"&&(p=P.getAncestorByClass(s,"btn-area"))){if(q.type=="mouseover"){P.addClass(p,"message")}else{if(q.type=="mouseout"){P.removeClass(p,"message")}}}if(P.ie6){f(r,s,q.type)}};var f=function(s,u,q){var p,r="btn-area btn-add btn-message picicon user-offline user-online image user-portrait un user-name relation more-info user-console user-info",t="p b";if(s==="user-item"){p=u}else{if(s&&r.indexOf(s)>-1){p=P.getAncestorByClass(u,"user-item")}else{if(t.indexOf(u.nodeName.toLowerCase())>-1){p=P.getAncestorByClass(u,"user-item")}}}if(p){if(q==="mouseover"){c.mouseEnter(p)}else{c.mouseLeave(p)}}};var c={hoverClassName:"over",hoveringEle:null,leavingEle:null,mouseEnter:function(p){if(this.hoveringEle!==p){P.addClass(p,this.hoverClassName);this.hoveringEle=p;if(this.leavingEle){P.removeClass(this.leavingEle,this.hoverClassName);this.leavingEle=null}}},mouseLeave:function(p){if(this.leavingEle!==p){this.leavingEle=p}}};var g=function(p){var r=P.getTarget(p),q=P.getAttr(r,"data-pn");if(q){P.addClass(this.el,"loading");b.call(this,q);this.model.getData(q)}P.preventDefault(p)};function l(p,q){this.model=p;this.el=q;this.init();this.addEventListener("update:viewready",(function(){b.call(this,1);this.bindClick()}).bind(this));o(this.el,this);this.model.addEventListener("change:content",(function(r){if(P.hasClass(this.el,"loading")){P.removeClass(this.el,"loading")}}).bind(this))}var j=l.prototype=P.extend(h);j.appendChildView=function(s){var p,q,r="space-userlist";if(s.el&&P.getAncestorByClass(s.el,r)){return}else{p=P.q(r,this.el)[0];if(p){p.appendChild(s.el);s.setDomReady()}}};j.setData=function(p,q){p.feedPage=q;p.appendTo(this)};j.bindClick=function(){var p=P.q(n,this.el)[0];if(p){P.on(p,"click",g.bind(this))}var q=k("tracking/trackmanager");q.spaceFriend(this.el)};return l});F.module("space_userlist/spacefriendholderview",function(e,h){var d=e("base/view");var b;var g=function(){var k=P.q("relation-title",this.el)[0];P.on(k,"click",(function(l){var r=P.getTarget(l),q=P.getAttr(r,"data-tab"),n,m,p;if(q==="back"){this.model.__parent.getData({tab:"space",part:"index"});P.preventDefault(l)}if(q=="follow"){p="follows"}else{if(q=="fans"){p="fans"}}if(p&&this.model.router.currentUser.relation.space["count"][p]===0){if(!this.model.__viewparts["nonesp"+q]){var o=['<div class="mod-blank-message userlist clearfix" style="display: block; ">','<span class="blank-content"> <span class="blank-title">#{1}#{0}</span> <br/>'].join("");App.onPageletArrive({targetId:this.model.id,viewType:"Generic",modelValue:{tab:"nonesp"+q,part:"index"},tplContent:P.format(o,q=="follow"?"有点害羞，在空间还没有关注任何人哦。":"有点低调，在空间还没有任何粉丝哦。",this.model.router.global.page_userInfo.sexTitle),sexTitle:this.model.router.global.page_userInfo.sexTitle})}this.model.getData({tab:"nonesp"+q});P.preventDefault(l);return}if(q){this.model.getData({tab:"sp"+q});P.preventDefault(l)}}).bind(this));var j=e("tracking/trackmanager");j.spaceFriend(k)};var a=function(s){var j=s.tab,n=P.q("tab-switch",this.el),r=P.q("userlist-tab",this.el)[0],p="active-tab",l="inactive-tab",k,m,o,q,t=["follows","fans"];if(P.hasClass(this.el,"loading")){P.removeClass(this.el,"loading")}if(r){if(j.indexOf("follow")>-1){P.addClass(r,t[0]);P.removeClass(r,t[1])}else{if(j.indexOf("fans")>-1){P.addClass(r,t[1]);P.removeClass(r,t[0])}}}for(k=0,m=n.length;k<m;k++){q=n[k];o="sp"+P.getAttr(q,"data-tab");if(o==j||"none"+o==j){P.removeClass(q,l);P.addClass(q,p)}else{P.removeClass(q,p);P.addClass(q,l)}}};function f(k,l,j){this.el=l;this.model=k;this.init();if(j&&typeof j.init=="function"){j.init.call(this)}this.addEventListener("update:viewready",g.bind(this));this.model.addEventListener("change:tab",a.bind(this));this.model.addEventListener("change:getdata",(function(){P.addClass(this.el,"loading")}).bind(this))}var c=f.prototype=P.extend(d);c.setData=function(j,k){j.holderTab=k||"plzhld";j.appendTo(this)};c.appendChildView=function(k){var o=P.q("plzhld",this.el),l,j,m=k.holderTab,n;for(l=0,j=o.length;l<j;l++){n=o[l];if(m==P.getAttr(n,"data-fill")||m=="plzhld"){n.appendChild(k.el);break}}};return f});F.module("space_userlist/spacefriendlistmodel",function(d,e){var c=d("base/model");function a(h,f,g){this.id=h;this.router=f;this.__currentPage=1;this.__pages={};this.__requestPage=1;if(g&&typeof g.init=="function"){g.init.call(this)}}var b=a.prototype=P.extend(c);b.getFeedContentId=function(){return P.getGuid()};b.setData=function(g,f){var h=f.pn||1;this.dispatchEvent("change:content");if(this.__pages[h]){this.__children[(this.__pages[this.__currentPage])].visible(false);this.__children[(this.__pages[h])].visible(true);this.__currentPage=h}else{if(h==this.__requestPage){if(this.__pages[this.__currentPage]){this.__children[(this.__pages[this.__currentPage])].visible(false)}g.visible(true);this.__currentPage=h}g.appendTo(this);this.__pages[h]=g.id}};b.getData=function(f){this.__requestPage=f;if(this.__pages[f]){this.setData(this,{pn:f})}else{this.requestNewContent(f)}};b.requestNewContent=function(f){this.router.getData(this,"spaceFriendList",{pn:f,async:"1",part:this.__part})};b.doPost=function(f){this.router.postData(f.postType,f.actionObj)};return a});F.module("space_userlist/spacefriendholder",function(c,d){var b=['<div class="mod-space-friend loading">','<div class="relation-title">','<ul class="userlist-tab clearfix #{2}">','<li class="tab-item tab-follows first-tab-item"><a href="#" class="link #{0} tab-switch" data-tab="follow">关注的人</a></li>','<li class="split"></li>','<li class="tab-item tab-fans"><a href="#" class="link #{1} tab-switch" data-tab="fans">粉丝</a></li>','<li class="slide"><div class="icon"></div></li>','<li class="hover"></li>',"</ul>","</div>",'<div class="loadingtpl">LOADING...</div>','<div class="plzhld"></div>',"</div>"].join("");function a(e,g){var f=e||"follow";App.onPageletArrive({targetId:"cnthld",viewValue:"feed_content",viewType:"SpaceFriendHolder",modelValue:{tab:"space",part:"friend"},tplContent:P.format(b,f=="follow"?"active-tab":"inactive-tab",f=="follow"?"inactive-tab":"active-tab",f=="follow"?"follows":"fans"),options:{init:function(){this.getData({part:"index",tab:"sp"+f});this.router.addEventListener("brocast:spfriendlist",(function(h){this.getData({part:"index",tab:"sp"+h.tab})}).bind(this))}}})}return{createHolder:a}});F.module("tieba_userlist/tiebafriendlistview",function(l,e){var j=l("base/view"),m=l("util/pagebar");var n="tieba-page-bar";var b=function(r){var p=P.q(n,this.el)[0];if(p){var q=this.model.__totalItems>500?500:this.model.__totalItems;p.innerHTML=m(r|0,q,this.model.__pageSize,4)}};var d=function(y){var u=P.getTarget(y),p=P.getAncestorByClass(u,"user-console"),s,x,v,q,r,w,t="changeRelation";if(p&&(s=P.getAttr(u,"data-click"))&&(x=P.getAttr(p,"data-from"))&&(w=P.getAttr(p,"data-portrait"))){q=l("no_username/no_username");if(s!="add"&&s!="remove"){P.preventDefault(y);return}if(!this.model.router.global.isLoggedIn){v=l("dialog/dialogmanager");v.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});P.preventDefault(y);return}else{if(!q.hasUsername()){P.preventDefault(y);return}}r={actionObj:{postData:{portrait:w,from:x,action:s},callback:function(E){var C=E.relation,B,z=P.getAttr(u,"class"),A,D;if(E.errNo==-1){A=l("dialog/dialogmanager");A.alert(E.errMsg||"<b>服务器忙，请稍候再试</b>",{cnsClass:"cns-non",cntClass:"cnt-short",cntAlignClass:"cnt-center"});return}else{if(E.errNo==-101){A=l("dialog/dialogmanager");A.alert("<p>你还没有登录哦！</p><p><b>登录百度，享受更多精彩功能！</b></p>",{btnConfirm:'<a class="dialog-ok" href="/p/sys/redirect?login=1&uname='+App.router.global.page_userInfo.username+'">马上登录</a>',cntClass:"cnt-short",cnsClass:"cns-one-long",cntAlignClass:"cnt-left"});return}}if(C=="followed"){B="btn-follow";D=true}else{if(C=="friend"){B="friend";D=true}}if(D){A=l("dialog/dialogmanager");P.removeClass(u,z);P.addClass(u,B);A.showAt(u,{text:"关注成功！",hide:true});P.setAttr(u,"data-click","done")}}},postType:t};this.model.doPost(r);P.preventDefault(y)}};var o=function(p,q){P.on(p,"click",d.bind(q));P.on(p,"mouseover",a);P.on(p,"mouseout",a)};var a=function(q){var s=P.getTarget(q),r=s.className,p;if(r==="btn-message"&&(p=P.getAncestorByClass(s,"btn-area"))){if(q.type=="mouseover"){P.addClass(p,"message")}else{if(q.type=="mouseout"){P.removeClass(p,"message")}}}if(P.ie6){g(r,s,q.type)}};var g=function(s,u,q){var p,r="btn-area btn-add btn-message picicon user-offline user-online image user-portrait un user-name relation tieba-info more-info user-console user-info",t="p b";if(s==="user-item"){p=u}else{if(s&&r.indexOf(s)>-1){p=P.getAncestorByClass(u,"user-item")}else{if(t.indexOf(u.nodeName.toLowerCase())>-1){p=P.getAncestorByClass(u,"user-item")}}}if(p){if(q==="mouseover"){c.mouseEnter(p)}else{c.mouseLeave(p)}}};var c={hoverClassName:"over",hoveringEle:null,leavingEle:null,mouseEnter:function(p){if(this.hoveringEle!==p){P.addClass(p,this.hoverClassName);this.hoveringEle=p;if(this.leavingEle){P.removeClass(this.leavingEle,this.hoverClassName);this.leavingEle=null}}},mouseLeave:function(p){if(this.leavingEle!==p){this.leavingEle=p}}};var h=function(p){var r=P.getTarget(p),q=P.getAttr(r,"data-pn");if(q){P.addClass(this.el,"loading");b.call(this,q);this.model.getData(q)}P.preventDefault(p)};function f(p,q){this.model=p;this.el=q;this.init();this.addEventListener("update:viewready",(function(){b.call(this,1);this.bindClick()}).bind(this));o(this.el,this);this.model.addEventListener("change:content",(function(r){if(P.hasClass(this.el,"loading")){P.removeClass(this.el,"loading")}}).bind(this))}var k=f.prototype=P.extend(j);k.appendChildView=function(s){var p,q,r="tieba-userlist";if(s.el&&P.getAncestorByClass(s.el,r)){return}else{p=P.q(r,this.el)[0];if(p){p.appendChild(s.el);s.setDomReady()}}};k.setData=function(p,q){p.feedPage=q;p.appendTo(this)};k.bindClick=function(){var q=l("tracking/trackmanager");q.tiebaFriend(this.el);var p=P.q(n,this.el)[0];if(p){P.on(p,"click",h.bind(this))}};return f});F.module("tieba_userlist/tiebafriendholderview",function(e,h){var d=e("base/view");var b;var f=function(){var k=P.q("relation-title",this.el)[0];P.on(k,"click",(function(l){var r=P.getTarget(l),q=P.getAttr(r,"data-tab"),n,m,p;if(q==="back"){this.model.__parent.getData({tab:"tieba",part:"index"});P.preventDefault(l)}if(q=="follow"){p="follows"}else{if(q=="fans"){p="fans"}}if(p&&this.model.router.currentUser.relation.tieba["count"][p]===0){if(!this.model.__viewparts["nonetb"+q]){var o=['<div class="mod-blank-message userlist clearfix" style="display: block; ">','<span class="blank-content"> <span class="blank-title">#{1}#{0}</span> <br/>'].join("");o+=["</span></div>"].join("");App.onPageletArrive({targetId:this.model.id,viewType:"Generic",modelValue:{tab:"nonetb"+q,part:"index"},tplContent:P.format(o,q=="follow"?"有点害羞，在贴吧还没有关注任何人哦。":"有点低调，在贴吧还没有任何粉丝哦。",this.model.router.global.page_userInfo.sexTitle),sexTitle:this.model.router.global.page_userInfo.sexTitle})}this.model.getData({tab:"nonetb"+q});P.preventDefault(l);return}if(q){this.model.getData({tab:"tb"+q});P.preventDefault(l)}}).bind(this));var j=e("tracking/trackmanager");j.tiebaFriend(k)};var a=function(s){var j=s.tab,n=P.q("tab-switch",this.el),r=P.q("userlist-tab",this.el)[0],p="active-tab",l="inactive-tab",k,m,o,q,t=["follows","fans"];if(P.hasClass(this.el,"loading")){P.removeClass(this.el,"loading")}if(r){if(j.indexOf("follow")>-1){P.addClass(r,t[0]);P.removeClass(r,t[1])}else{if(j.indexOf("fans")>-1){P.addClass(r,t[1]);P.removeClass(r,t[0])}}}for(k=0,m=n.length;k<m;k++){q=n[k];o="tb"+P.getAttr(q,"data-tab");if(o==j||"none"+o==j){P.removeClass(q,l);P.addClass(q,p)}else{P.removeClass(q,p);P.addClass(q,l)}}};function g(k,l,j){this.el=l;this.model=k;this.init();if(j&&typeof j.init=="function"){j.init.call(this)}this.addEventListener("update:viewready",f.bind(this));this.model.addEventListener("change:tab",a.bind(this));this.model.addEventListener("change:getdata",(function(){P.addClass(this.el,"loading")}).bind(this))}var c=g.prototype=P.extend(d);c.setData=function(j,k){j.holderTab=k||"plzhld";j.appendTo(this)};c.appendChildView=function(k){var o=P.q("plzhld",this.el),l,j,m=k.holderTab,n;for(l=0,j=o.length;l<j;l++){n=o[l];if(m==P.getAttr(n,"data-fill")||m=="plzhld"){n.appendChild(k.el);break}}};return g});F.module("tieba_userlist/tiebafriendlistmodel",function(d,e){var b=d("base/model");function c(h,f,g){this.id=h;this.router=f;this.__currentPage=1;this.__pages={};this.__requestPage=1;if(g&&typeof g.init=="function"){g.init.call(this)}}var a=c.prototype=P.extend(b);a.getFeedContentId=function(){return P.getGuid()};a.setData=function(g,f){var h=f.pn||1;this.dispatchEvent("change:content");if(this.__pages[h]){this.__children[(this.__pages[this.__currentPage])].visible(false);this.__children[(this.__pages[h])].visible(true);this.__currentPage=h}else{if(h==this.__requestPage){if(this.__pages[this.__currentPage]){this.__children[(this.__pages[this.__currentPage])].visible(false)}g.visible(true);this.__currentPage=h}g.appendTo(this);this.__pages[h]=g.id}};a.getData=function(f){this.__requestPage=f;if(this.__pages[f]){this.setData(this,{pn:f})}else{this.requestNewContent(f)}};a.requestNewContent=function(f){this.router.getData(this,"tiebaFriendList",{pn:f,async:"1",part:this.__part})};a.doPost=function(f){this.router.postData(f.postType,f.actionObj)};return c});F.module("tieba_userlist/tiebafriendholder",function(c,d){var b=['<div class="mod-tieba-friend loading">','<div class="relation-title">','<ul class="userlist-tab clearfix #{2}">','<li class="tab-item tab-follows first-tab-item"><a href="#" class="link #{0} tab-switch" data-tab="follow">关注的人</a></li>','<li class="split"></li>','<li class="tab-item tab-fans"><a href="#" class="link #{1} tab-switch" data-tab="fans">粉丝</a></li>','<li class="slide"><div class="icon"></div></li>','<li class="hover"></li>',"</ul>","</div>",'<div class="loadingtpl">LOADING...</div>','<div class="plzhld"></div>',"</div>"].join("");function a(e,g){var f=e||"follow";App.onPageletArrive({targetId:"cnthld",viewValue:"feed_content",viewType:"TiebaFriendHolder",modelValue:{tab:"tieba",part:"friend"},tplContent:P.format(b,f=="follow"?"active-tab":"inactive-tab",f=="follow"?"inactive-tab":"active-tab",f=="follow"?"follows":"fans"),options:{init:function(){this.getData({part:"index",tab:"tb"+f});this.router.addEventListener("brocast:tbfriendlist",(function(h){this.getData({part:"index",tab:"tb"+h.tab})}).bind(this))}}})}return{createHolder:a}});F.module("namespace/namespace",function(b,c){var a=window.App={};a.View=b("base/view");a.Model=b("base/model");a.GenericView=b("base/genericview");a.GenericModel=b("base/genericmodel");a.HolderView=b("content_holder/holderview");a.HolderModel=b("content_holder/holdermodel");a.UserPanelView=b("userpanel/userpanelview");a.TiebaHonorView=b("tieba_honor/tiebahonorview");a.TiebaFeedHolderView=b("tieba_feed/tiebafeedholderview");a.TiebaFeedView=b("tieba_feed/tiebafeedview");a.TiebaFeedModel=b("tieba_feed/tiebafeedmodel");a.TiebaFeedContentModel=b("tieba_feed/tiebafeedcontentmodel");a.TiebaRelationView=b("tieba_relation/tiebarelationview");a.ZhidaoHonorView=b("zhidao_profile/zhidaohonorview");a.SpaceAlbumView=b("space_album/spacealbumview");a.SpaceArticleView=b("space_article/spacearticleview");a.SpaceArticleModel=b("space_article/spacearticlemodel");a.SpaceRelationView=b("space_relation/spacerelationview");a.SpaceRelationModel=b("space_relation/spacerelationmodel");a.SpaceFriendHolder=b("space_userlist/spacefriendholder");a.SpaceFriendHolderView=b("space_userlist/spacefriendholderview");a.SpaceFriendListModel=b("space_userlist/spacefriendlistmodel");a.SpaceFriendListView=b("space_userlist/spacefriendlistview");a.TiebaRelationView=b("tieba_relation/tiebarelationview");a.TiebaRelationModel=b("tieba_relation/tiebarelationmodel");a.TiebaFriendHolder=b("tieba_userlist/tiebafriendholder");a.TiebaFriendHolderView=b("tieba_userlist/tiebafriendholderview");a.TiebaFriendListModel=b("tieba_userlist/tiebafriendlistmodel");a.TiebaFriendListView=b("tieba_userlist/tiebafriendlistview");a.ZhidaoAnslistView=b("zhidao_answerlist/zhidaoanslistview");a.ZhidaoAnslistModel=b("zhidao_answerlist/zhidaoanslistmodel");a.ZhidaoProfileView=b("zhidao_profile/zhidaoprofileview");a.onPageletArrive=b("bigpipe/bigpipe");a.RightNavView=b("right_nav/right_nav");a.SettingTiebaView=b("setting_tieba/setting_tieba");a.SettingTiebaModel=b("setting_tieba/settingtiebamodel");return a});F.module("router/router",function(b,d){var a=b("namespace/namespace"),c=b("products/main");(function(p){var k=p,m={model:p.GenericModel,view:p.GenericView},e={model:p.GenericModel,view:p.UserPanelView},s={model:p.GenericModel,view:p.SpaceAlbumView},f={model:p.SpaceArticleModel,view:p.SpaceArticleView},h={model:p.GenericModel,view:p.GenericView},o={model:p.SpaceRelationModel,view:p.SpaceRelationView},r={model:p.HolderModel,view:p.SpaceFriendHolderView},n={model:p.SpaceFriendListModel,view:p.SpaceFriendListView},j={model:p.GenericModel,view:p.GenericView},q={model:p.GenericModel,view:p.TiebaHonorView},g={model:p.TiebaFeedModel,view:p.TiebaFeedView},l={model:p.HolderModel,view:p.TiebaFeedHolderView};TiebaFeedContent={model:p.GenericModel,view:p.GenericView},TiebaRelation={model:p.TiebaRelationModel,view:p.TiebaRelationView},TiebaFriendHolder={model:p.HolderModel,view:p.TiebaFriendHolderView},TiebaFriendList={model:p.TiebaFriendListModel,view:p.TiebaFriendListView},TiebaFriendListContent={model:p.GenericModel,view:p.GenericView},ZhidaoHonor={model:p.GenericModel,view:p.ZhidaoHonorView},ZhidaoProfile={model:p.GenericModel,view:p.ZhidaoProfileView},ZhidaoAnslist={model:p.ZhidaoAnslistModel,view:p.ZhidaoAnslistView},ZhidaoAnslistContent={model:p.GenericModel,view:p.GenericView},RightNav={model:p.GenericModel,view:p.RightNavView},router={views:{},models:{},onLoadingList:{},addModel:function(u,t){if(t){u.appendTo(t)}this.models[u.id]=u},addView:function(t){this.views[t.model.id]=t},types:{Generic:m,Userpanel:e,TiebaHonor:q,ZhidaoHonor:ZhidaoHonor,TiebaFeed:g,TiebaFeedHolder:l,TiebaFeedContent:TiebaFeedContent,SpaceAlbum:s,SpaceArticle:f,SpaceArticleContent:h,SpaceRelation:o,TiebaRelation:TiebaRelation,ZhidaoAnslist:ZhidaoAnslist,ZhidaoAnslistContent:ZhidaoAnslistContent,SpaceFriendHolder:r,SpaceFriendList:n,SpaceFriendListContent:j,TiebaFriendHolder:TiebaFriendHolder,TiebaFriendList:TiebaFriendList,TiebaFriendListContent:TiebaFriendListContent,ZhidaoProfile:ZhidaoProfile,RightNav:RightNav},analyzeModuleType:function(u,t){var v={SpaceArticle:"article-list",TiebaFeed:"feed-list",ZhidaoAnslist:"zhidao-anwlist-body",SpaceFriendList:"userlist",TiebaFriendList:"userlist"},w=P.q(v[t],u)[0];return{FeedContainer:u,FeedContent:w}},postData:function(A,u){var w=this.global.token,z=[],x=[],y=u.callback;switch(A){case"changeRelation":z.push("/p/sys/submit/relation");x.push(P.extend({token:w},u.postData));break}for(var v=0,t=z.length;v<t;v++){P.ajax.post(z[v],P.jsonToQuery(x[v]),y)}},getData:function(w,A,H){if(!this.global.page_userInfo){setTimeout(this.getData.bind(this,w,A,H),500);return}function x(){}function B(I,K){var J=document.getElementsByTagName("head")[0];if(K){I.onload=K}I.onerror=x;J.appendChild(I)}var E=this.global.page_userInfo.portrait,u=[],C=[],v,z,D;var G=function(){};switch(A){case"zhidao-index":u.push("/p/sys/data/zhidao/anslist?");C.push({portrait:E});u.push("/p/sys/data/zhidao/profile?");C.push({portrait:E});break;case"space-index":u.push("/p/sys/data/space/article?");C.push({portrait:E});u.push("/p/sys/data/space/relation?");C.push({portrait:E});break;case"tieba-index":u.push("/p/sys/data/tieba/honor?");C.push({portrait:E});u.push("/p/sys/data/tieba/feed?");C.push({portrait:E});u.push("/p/sys/data/tieba/relation?");C.push({portrait:E});break;case"spaceArticle":u.push("/p/sys/data/space/article?");C.push(P.extend({rec:w.id,portrait:E},H));break;case"reply-index":case"zhuti-index":case"itie-index":case"zhuantie-index":case"tiebaFeed":u.push("/p/sys/data/tieba/feed?");C.push(P.extend({rec:w.id,portrait:E},H));break;case"zhidaoAnslist":u.push("/p/sys/data/zhidao/anslist?");C.push(P.extend({rec:w.id,portrait:E},H));break;case"spfollow-index":u.push("/p/sys/data/space/userlist?");C.push({rec:w.id,portrait:E,part:"follow"});break;case"spfans-index":u.push("/p/sys/data/space/userlist?");C.push({rec:w.id,portrait:E,part:"fans"});break;case"tbfollow-index":u.push("/p/sys/data/tieba/userlist?");C.push({rec:w.id,portrait:E,part:"follow"});break;case"tbfans-index":u.push("/p/sys/data/tieba/userlist?");C.push({rec:w.id,portrait:E,part:"fans"});break;case"space-friend":p.SpaceFriendHolder.createHolder(H.type,this.global.page_userInfo.sexTitle);break;case"tieba-friend":p.TiebaFriendHolder.createHolder(H.type,this.global.page_userInfo.sexTitle);break;case"spaceFriendList":u.push("/p/sys/data/space/userlist?");C.push(P.extend({rec:w.id,portrait:E},H));break;case"tiebaFriendList":u.push("/p/sys/data/tieba/userlist?");C.push(P.extend({rec:w.id,portrait:E},H));break;case"baidu-index":u.push("/p/sys/data/time/timelinetab?");C.push(P.extend({rec:w.id,portrait:E}),H);break;case"xiangce-index":c.createIframe("xiangce");break;case"wenku-index":c.createIframe("wenku");break;case"baike-index":c.createIframe("baike");break;case"reward-index":c.createIframe("reward");break}for(v=0,z=u.length;v<z;v++){var t=u[v]+P.jsonToQuery(C[v]);if(t in this.onLoadingList){return}else{D=document.createElement("script");D.src=t+"&t="+new Date()*1;var y=this;y.onLoadingList[t]=1;(function(I){B(D,function(){delete y.onLoadingList[I]})})(t)}}},global:{},updateGlobal:function(t){this.global=P.extend({},t,this.global);this.dispatchEvent("update:global",{global:this.global})},brocast:function(u,t){this.dispatchEvent("brocast:"+u,t)},createModule:function(C,z,u,G,J,t){var H=true,w,D,v,E,G=G||"all",B,y,I,x;try{if(C=="TiebaFeed"||C=="SpaceArticle"||C=="ZhidaoAnslist"||C=="SpaceFriendList"||C=="TiebaFriendList"){I=this.analyzeModuleType(z,C);y=I.FeedContainer;B=I.FeedContent;v=new this.types[C]["model"](u,this,J);E=new this.types[C]["view"](v,y,G);this.models[u]=v;this.views[u]=E;this.addModel(v);this.addView(E);x=v.getFeedContentId();w=new this.types[C+"Content"]["model"](x,this);D=new this.types[C+"Content"]["view"](w,B,G);E.setData(D,"feed");v.setData(w,"1");this.models[x]=w;this.views[x]=D;this.addModel(w);this.addView(D)}else{w=new this.types[C]["model"](u,this,J);D=new this.types[C]["view"](w,z,G);if(t){D.addEventListener("update:viewready",t)}this.models[u]=w;this.views[u]=D;this.addModel(w);this.addView(D)}}catch(A){throw A;H=false}return H},pageLetArrive:function(D,w,B,A,x,y,E,v){var C,z,u=this.models[D],t=this.views[D];if(this.createModule(B,A,x,y,E,v)){z=this.models[x];C=this.views[x];t.setData(C,w);u.setData(z,y)}}};P.event(router);k.router=router;k.pageLetArrive=router.pageLetArrive.bind(router);if(c.init){c.init(k)}})(a);return a.router});F.use(["router/router","namespace/namespace"],function(a,b){(function(e,h){var j=function(){this.count={fans:0,follows:0};this.friendList={followsMap:[],fansMap:[],follows:{},fans:{}}};var d={portrait:"",username:"",gender:"",token:"",isLoggedIn:"",isLoginUserNoName:""};var c={};P.event(c);var g=function(k){this.router=k;this.relation={};this.userInfo=P.extend(d);this.__unsavedChanges={}},f=P.extend(g.prototype,c);f.save=function(k,m){var n,l,o=this.__unsavedChanges;if(!this.userInfo.token){return}for(n in o){for(l in o[n]){this.__saveToServer(n,l,o[n][l],k,m)}delete o[n]}};f.__saveToServer=function(v,m,k,q,r){var s=[],p,t,o,w,l;var u=function(z,x,y,B,A){return function(){if(x=="add"){z.__addNewFriendObjects(y,B.listType,B)}else{if(x=="delete"){z.__deleteFriendObjects(y,B.listType,B)}}delete B.listType;A.call()}};var n=function(y,x){return function(z){if(!z.errNo){x.call(null)}else{y.call(null,z.errNo,z)}}};for(p=0,t=k.length;p<t;p++){for(o=0,w=k[p].length;o<w;o++){s.push(k[p][o])}}for(p=0,t=s.length;p<t;p++){l={portrait:s[p].portrait,from:v};switch(m){case"add":l.action="add";this.router.postData("changeRelation",{postData:l,callback:n(q,u(this,m,v,s[p],r))});break;case"delete":l.action="remove";this.router.postData("changeRelation",{postData:l,callback:n(q,u(this,m,v,s[p],r))});break}}};f.addNewFriend=function(m,l,n){var k="add";if(!this.__unsavedChanges[m]){this.__unsavedChanges[m]={}}if(!this.__unsavedChanges[m][k]){this.__unsavedChanges[m][k]=[]}n.listType=l;this.__unsavedChanges[m][k].push([n])};f.deleteFriend=function(m,l,n){var k="delete";if(!this.__unsavedChanges[m]){this.__unsavedChanges[m]={}}if(!this.__unsavedChanges[m][k]){this.__unsavedChanges[m][k]=[]}n.listType=l;this.__unsavedChanges[m][k].push([n])};f.load=function(k){};f.getUserInfo=function(k){if(k){return this.userInfo[k]}else{return this.userInfo}};f.setUserInfo=function(l){var k=this.userInfo;this.userInfo=k?P.extend(k,l):P.extend(l);this.dispatchEvent("change:userInfo",{data:l})};f.getCount=function(l,k){if(P.isString(l)){if(!this.relation[l]){this.__createNewRelation(l)}if(k){return this.relation[l]["count"][k]}else{return this.relation[l]["count"]}}else{throw"first argument must be passed in!"}};f.setCount=function(l,m){var k;if(l){if(!this.relation[l]){this.__createNewRelation(l)}k=this.relation[l].count;this.relation[l].count=k?P.extend(k,m):P.extend(m);this.dispatchEvent("change:count",{channel:l,data:m})}};f.__createNewRelation=function(k){this.relation[k]=new j()};f.__updateFriendList=function(r,l,s,o){var p,q,u,w,n,t,m,k,v;if(P.isArray(o)){u=o}else{if(P.isObject(o)){u=[o]}else{throw"update friend list ERROR, third argument must be an array or an object"}}m=this.relation[r]["friendList"][s];k=this.relation[r]["friendList"][s+"Map"];w=[];v={};v[s]=this.getCount(r,s);for(p=0,q=u.length;p<q;p++){n=u[p];t=n.portrait;switch(l){case"add":case"load":if(m[t]){continue}else{m[t]=n;w.push(n);if(l=="load"){k.push(n)}else{this.relation[r]["friendList"][s+"Map"]=P.arrayPrepend(k,n);k=this.relation[r]["friendList"][s+"Map"];v[s]++}}break;case"delete":delete m[t];w.push(n);v[s]--;break}}if(w.length){if(l=="add"||l=="delete"){this.setCount(r,v)}this.dispatchEvent("update:friendlist",{channel:r,opt:l,data:{type:s,list:w}})}};f.__addNewFriendObjects=function(l,k,m){if(P.isString(l)){if(!this.relation[l]){this.__createNewRelation(l)}}else{throw"add new friend object ERROR, first argument must be passed in!"}this.__updateFriendList(l,"add",k,m)};f.__deleteFriendObjects=function(l,k,m){if(P.isString(l)){}else{throw"add new friend object ERROR, first argument must be passed in!"}this.__updateFriendList(l,"delete",k,m)};f.loadFriendObjects=function(l,k,m){if(P.isString(l)){if(!this.relation[l]){this.__createNewRelation(l)}}else{throw"add new friend object ERROR, first argument must be passed in!"}this.__updateFriendList(l,"load",k,m)};h.UserModel=g})(a,b);(function(s,d){var j=new d.UserModel(s);var e=new d.UserModel(s);var s=s;var h=P.g("cnthld"),p=P.g("banhld"),o=P.g("headhld"),g=P.g("navhld"),n=P.g("stthld"),q,l,r,t,m,c,f,k;if(h){q=new d.HolderModel("cnthld",s,{init:function(){var v,w=this;this.gender=function(x){if(x){this.dispatchEvent("change:gender",{gender:x});return this}else{return v}};this.doAction=function(x,y,z){if(x==="add"){this.router.followCurrentUser(y,z)}};function u(x){var y;if(x.global.page_userInfo){y=x.global.page_userInfo.sexTitle}if(y){w.gender(y);w.router.removeEventListener("update:global",u)}}this.router.addEventListener("update:global",u)}});m=new d.HolderView(q,h,{init:function(){var x=this,v="TA";var z=function(C){var D=x.model.tab(),B="baidu zhidao space tieba";P.setAttr(x.el,"class","");P.addClass(x.el,"loading");if(B.indexOf(C)==-1){P.addClass(x.el,"other-products")}P.addClass(x.el,C);F.use("dialog/dialogmanager",function(E){E.hide()})};var A=function(C){var B=P.getAttr(this,"data-click");z(B);x.model.getData({tab:B,part:"index"});P.preventDefault(C)};var y=function(){if(this.el===null){return}var D=P.q("tabbtn",this.el),C,B;for(B=D.length;C=D[B-1];B--){P.on(C,"click",A)}};var w=function(){if(P.hasClass(x.el,"loading")){P.removeClass(x.el,"loading")}};y.call(this);F.use("tracking/trackmanager",function(C){var B=P.q("content-tab",x.el)[0];C.contentHolder(B)});var u=function(C){var G=P.q("tabbtn",x.el),E,B,D=C.gender;for(B=G.length;E=G[B-1];B--){E.innerHTML=E.innerHTML.replace(v,D)}v=D};this.model.addEventListener("change:gender",u);this.model.addEventListener("change:tab",w)}});s.addModel(q);s.addView(m)}if(p){l=new d.HolderModel("banhld",s);c=new d.HolderView(l,p);s.addModel(l);s.addView(c)}if(n){sttholder=new d.HolderModel("stthld",s);sttholderView=new d.HolderView(sttholder,n);s.addModel(sttholder);s.addView(sttholderView)}if(g){t=new d.HolderModel("navhld",s);k=new d.HolderView(t,g);s.addModel(t);s.addView(k)}if(o){r=new d.HolderModel("headhld",s);f=new d.HolderView(r,o);s.addModel(r);s.addView(f);F.use("tracking/trackmanager",function(u){u.basicInfo(o)})}s.updateCurrentUserData=function(u){if(u.userInfo){j.setUserInfo(u.userInfo)}if(u.relation&&u.relation.count){j.setCount(u.channel,u.relation.count)}};s.updateLoginUserData=function(u){if(u.userInfo){e.setUserInfo(u.userInfo)}if(u.relation&&u.relation.count){}};s.bindLoginUserEvent=function(w,v){var u;for(u in v.events){if(P.isFunction(v.events[u])){e.addEventListener(u,v.events[u])}}};s.bindCurrentUserEvent=function(w,v){var u;for(u in v.events){if(P.isFunction(v.events[u])){j.addEventListener(u,v.events[u])}}};s.followCurrentUser=function(y,x){var w=false,u,v;if(x){u=P.isFunction(x.success)?x.success:function(){};v=P.isFunction(x.error)?x.error:function(){}}if(e.userInfo.isLoggedIn){F.use("no_username/no_username",function(z){w=z.hasUsername()});if(w){e.addNewFriend(y,"follows",{portrait:j.userInfo.portrait});e.save(v,function(){j.__addNewFriendObjects(y,"fans",{portrait:e.userInfo.portrait});u.call(null)})}}else{if(v){v.call(null,-101)}}};s.unfollowCurrentUser=function(x,w){var u,v;if(w){u=P.isFunction(w.success)?w.success:function(){};v=P.isFunction(w.error)?w.error:function(){}}if(e.userInfo.isLoggedIn){e.deleteFriend(x,"follows",{portrait:j.userInfo.portrait});e.save(v,function(){j.__deleteFriendObjects(x,"fans",{portrait:e.userInfo.portrait});u.call(null)})}else{if(v){v.call(null,-101)}}};s.addEventListener("update:global",function(w){var u=P.g("tiebaredirectlink"),x=P.g("navTiebaredirectlink"),v="http://tieba.baidu.com/i/";if(w.global&&w.global.tiebaOuterId){v=v+encodeURIComponent(w.global.tiebaOuterId)+"/others?from=princess";if(u){u.href=v}if(x){x.href=v}}});s.loginUser=e;s.currentUser=j})(a,b)});F.module("skinchange/skinchange",function(c,l){var d=0,k=0,I=1,u=false,t=false,J=[{id:14,src:"/static/princess/img/skin14/thumbnail_287b5b29.png",name:"祈福雅安"},{id:13,src:"/static/princess/img/skin13/thumbnail_826b394a.png",name:"金蛇献瑞"},{id:1,src:"/static/princess/img/skin01/thumbnail_3156fbaa.png",name:"小清新"},{id:2,src:"/static/princess/img/skin02/thumbnail_c1013525.png",name:"Happy Girl"},{id:3,src:"/static/princess/img/skin03/thumbnail_9b17b165.png",name:"清凉夏日"},{id:4,src:"/static/princess/img/skin04/thumbnail_86600321.png",name:"炎夏花语"},{id:9,src:"/static/princess/img/skin09/thumbnail_33a8e7a3.png",name:"金属韵律"},{id:10,src:"/static/princess/img/skin10/thumbnail_fb028307.png",name:"篮球皇帝"},{id:11,src:"/static/princess/img/skin11/thumbnail_aa66bb5e.png",name:"海边夕阳"},{id:12,src:"/static/princess/img/skin12/thumbnail_30ec8ba5.png",name:"行摄人生"},{id:5,src:"/static/princess/img/skin05/thumbnail_27229487.png",name:"垂钓小Q"},{id:6,src:"/static/princess/img/skin06/thumbnail_2c492edb.png",name:"音乐心情"},{id:7,src:"/static/princess/img/skin07/thumbnail_f3fa964c.png",name:"仲夏午后"},{id:8,src:"/static/princess/img/skin08/thumbnail_697f1906.png",name:"思念飞翔"}];var g,r;var h=8;var E=c("dialog/dialogmanager");var j=function(){if(J){A(1);C()}else{var K="/p/sys/data/skinlist";j()}};var A=function(L){if(L<1){L=1}var N=[],R=(L-1)*h;I=L;for(var M=0;M<h;M++){var Q=J[R+M];if(Q){N+=z(Q)}}var O=P.q("skin-list",r)[0];O.innerHTML=N;var K=P.q("skin-pagebar",r)[0];K.innerHTML=H()};var H=function(){var N=J.length,M=Math.ceil(N/h),L="";if(M!=I){L+="<a href='#' class='skin-pagebar-last' onclick='return false;' data-page='"+M+"'></a>"}for(var K=M;K>0;K--){if(K==I){L+="<span class='skin-pagebar-curr'>"+K+"</span>"}else{L+="<a href='#' class='skin-pagebar-num' onclick='return false' data-page='"+K+"'>"+K+"</a>"}}if(I!=1){L+="<a href='#' class='skin-pagebar-first' onclick='return false' data-page='1'></a>"}return L};var C=function(){var K=P.q("dialog-txt",r)[0];P.on(K,"click",function(O){var M=P.getTarget(O);if(M.tagName.toLowerCase()!="a"){if(M.parentNode.tagName.toLowerCase()=="a"){M=M.parentNode}else{return}}var Q=P.getAttr(M,"data-skin-id"),L=P.getAttr(M,"data-page");if(Q){q(Q);B(M);y({skinId:Q,action:"preview"})}else{if(L){if(u){return}u=true;var M=P.q("skin-list")[0];var N=c("switch_animation/switch_animation");N.switchNode(M,L<I?"left":"right",function(){u=false});A(L|0)}}})};var B=function(K){P.each(P.q("active",r),function(L){P.removeClass(L,"active")});P.addClass(K,"active")};var z=function(L){var K=["<a class='skin-item #{class}' href='#' onclick='return false' data-skin-id='#{id}' hidefocus>","<img src='#{src}' class='skin-image'/>","<span class='skin-title-bg'></span>","<span class='skin-title'>#{name}</span>","</a>"].join("");return P.format(K,{id:L.id,src:App.router.global.domain["static"]+L.src,name:L.name,"class":L.id==k?"active":""})};var a=function(){if(d!=k){v(k);P.ajax.post("/p/sys/submit/skin",{skinid:k,portrait:App.router.global.login_userInfo.portrait,token:App.router.global.token},function(L){var K=L.errNo||0;if(K==0){var M=E.show("<div class='skin-dialog-success'>保存成功！</div>");P.addClass(M,"mod-skin-change-success");M.style.top="200px";setTimeout(function(){E.hide()},1000)}else{if(K==-101){E.alert("登录超时，请重新登录。",{callback:function(){location.href="/p/sys/redirect?login=1&uname="+App.router.global.login_userInfo.uname}})}else{E.alert("服务器出错，提交失败。")}}})}P.un(document.body,"keydown",p);y({skinId:k,action:"save"});return false};var n=function(){r=E.commConfirm("<div class='skin-list clearfix'></div><div class='skin-pagebar clearfix'></div>",{title:"封面设置",mainClassName:"mod-skin-dialog",btnConfirm:'<a href="#" onclick="return false;" class="dialog-ok skin-dialog-btn" data-click="ok">保存</a>',btnCancel:'<a href="#" onclick="return false;" class="dialog-cancel skin-dialog-btn" data-click="cancel">取消</a>',cnsClass:"clearfix",cntClass:"clearfix",txtClass:" ",callback:a,oncancel:o});P.on(document.body,"keydown",p);j()};var y=function(L){var K=c("tracking/track"),M={pid:"320",type:"2011",evt:"click",module:"skinchange"};K.sendRequest({trackParams:P.extend(M,L)})};var p=function(K){if(P.getKeyCode(K)==27){o();E.hide()}};var o=function(){v(d);P.un(document.body,"keydown",p);y({action:"cancel"})};var x=function(K){P.preventDefault(K);n()};var s=function(){g=P.createNode("a",{className:"mod-change-skin",href:"#",title:"皮肤设置"});g.innerHTML="<i class='log-rainbow'></i>";P.on(g,"click",x);document.body.appendChild(g);var K=c("tracking/trackmanager");K.skinChange(g)};var b=function(K){if(!K){return}K.parentNode.style.display="block";P.on(K,"click",f)};var f=function(L){var K;P.preventDefault(L);P.un(this,"click",f);P.setCookie("prinSkinClose","2",{expires:1000*60*60*24*365});K=P.g("skin-tips");K.parentNode.removeChild(K)};var q=function(N,M){var L=P.g("wrapper");if(!M){var K=c("switch_animation/switch_animation");K.fadeSwitch(L)}L.className="skin"+D(N,2);k=N};var D=function(N,M){var O="",L=(N<0),K=String(Math.abs(N));if(K.length<M){O=(new Array(M-K.length+1)).join("0")}return(L?"-":"")+O+K};var G=function(){if(!App.router.global.isLoggedIn||App.router.global.login_userInfo.portrait!=App.router.global.page_userInfo.portrait){return false}if(P.getCookie("prinSkinClose")=="2"){return false}else{return true}};var w=function(){P.g("userpanelChangeSkin")&&P.on("userpanelChangeSkin","click",function(K){if(App.router.global.isLoginUserNoName){F.use("no_username/no_username",function(L){L.hasUsername()});P.preventDefault(K)}else{if(t){n();P.preventDefault(K)}}})};var e=function(){if(G()){b(P.g("skin-tips-close"))}};var m=function(){t=App.router.global.login_userInfo.portrait==App.router.global.page_userInfo.portrait;e();if(location.hash=="#changeSkin"&&t){n();location.hash=""}w()};var v=function(K){q(K,true);d=K};l.init=m;l.setSkin=v});